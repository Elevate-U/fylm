import{b as p,$ as g,s as o,u as e}from"./index-DJKKYvGv.js";import{d,y as b}from"./react-vendor-BYlzYzcd.js";const k=()=>{const{user:s}=p(),[i,n]=d(!1),[c,t]=d(""),[x,m]=d(null);b(()=>{if(!s){g("/login",!0);return}u()},[s]);const u=async()=>{try{n(!0);const{data:r,error:a}=await o.from("profiles").select("*").eq("id",s.id).single();if(a&&a.code!=="PGRST116"){console.error("Error checking user status:",a),t(`Error: ${a.message}`);return}m(r),t(r?`User found: ${r.email} - Admin: ${r.is_admin?"Yes":"No"}`:"User profile not found in database")}catch(r){console.error("Error:",r),t(`Error: ${r.message}`)}finally{n(!1)}},h=async()=>{try{n(!0);const r={id:s.id,email:s.email,is_admin:!0,updated_at:new Date().toISOString()},{data:a,error:l}=await o.from("profiles").upsert(r).select().single();if(l){console.error("Error making user admin:",l),t(`Error: ${l.message}`);return}m(a),t("Successfully set user as admin!")}catch(r){console.error("Error:",r),t(`Error: ${r.message}`)}finally{n(!1)}},f=async()=>{await o.auth.signOut(),g("/login",!0)};return s?e("div",{className:"min-h-screen bg-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:e("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-md p-6",children:[e("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Admin Setup"}),e("div",{className:"space-y-4",children:[e("div",{children:[e("h2",{className:"text-lg font-semibold text-gray-700",children:"Current User"}),e("p",{className:"text-gray-600",children:["Email: ",s.email]}),e("p",{className:"text-gray-600",children:["ID: ",s.id]})]}),e("div",{children:[e("h2",{className:"text-lg font-semibold text-gray-700",children:"Status"}),e("p",{className:`text-sm ${c.includes("Error")?"text-red-600":"text-green-600"}`,children:c||"Checking..."})]}),e("div",{className:"space-y-2",children:[e("button",{onClick:u,disabled:i,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50",children:i?"Checking...":"Check User Status"}),e("button",{onClick:h,disabled:i,className:"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 disabled:opacity-50",children:i?"Processing...":"Make User Admin"}),e("button",{onClick:f,className:"w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700",children:"Sign Out"})]}),e("div",{className:"mt-6 p-4 bg-gray-50 rounded-md",children:[e("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Instructions:"}),e("ol",{className:"text-xs text-gray-600 space-y-1",children:[e("li",{children:"1. Check your current user status"}),e("li",{children:`2. If you're not an admin, click "Make User Admin"`}),e("li",{children:["3. Go to ",e("a",{href:"/blog-admin",className:"text-blue-600 hover:underline",children:"/blog-admin"})," to manage posts"]})]})]})]})]})}):e("div",{children:"Please log in first."})};export{k as default};
//# sourceMappingURL=AdminSetup-BPz0AnVV.js.map
