import{b as U,u as n,A as t,$ as R}from"./index-DJKKYvGv.js";import{d as m,y as p,k as j}from"./react-vendor-BYlzYzcd.js";import{M as D}from"./MovieCard-BNWtjiUN.js";import{A as H}from"./AnimeCard-DiEp6bkk.js";import{S as Y}from"./SkeletonCard-HUJuCd8-.js";/* empty css                  */const y=({type:i,category:s,filter:v})=>{const[w,g]=m([]),[b,u]=m(!0),[C,k]=m(null),[M,$]=m(1),[S,A]=m(!0),[O,W]=m([]),[h,G]=m(s==="genres"&&v?v:s==="genres"?"28":""),[c,x]=m(s==="streaming"&&v?v:"netflix"),[o,E]=m(i||"movie"),{user:q}=U(),L={trending:"Trending Now",popular:"Popular","top-rated":"Top Rated",upcoming:"Upcoming","now-playing":"Now Playing","on-the-air":"On The Air",seasonal:"This Season","continue-watching":"Continue Watching",genres:"Browse by Genre",streaming:"Browse by Streaming Service"},T=[{id:"netflix",name:"Netflix",tmdbId:8},{id:"prime",name:"Prime Video",tmdbId:119},{id:"hbo",name:"Max",tmdbId:384},{id:"disney",name:"Disney+",tmdbId:337},{id:"apple",name:"Apple TV+",tmdbId:350},{id:"paramount",name:"Paramount+",tmdbId:531}],_=async()=>{try{const r=await fetch(`${t}/tmdb/genre/${i==="anime"?i:o}/list`);if(r.ok){const a=await r.json();W(a.genres||[])}}catch(e){console.error("Error fetching genres:",e)}},l=async(e=1,r=!1)=>{try{u(!0);let a;const d=i==="anime"?i:o;if(s==="genres"&&h)a=`${t}/tmdb/discover/${d}?with_genres=${h}&page=${e}`;else if(s==="genres"&&!h){u(!1);return}else if(s==="streaming"&&c){const f=T.find(F=>F.id===c);console.log(`[BROWSE] Streaming category - selectedStreamingService: ${c}`),console.log("[BROWSE] Found service:",f),f?(a=`${t}/tmdb/discover/${d}?with_watch_providers=${f.tmdbId}&watch_region=US&page=${e}`,console.log(`[BROWSE] Fetching ${d} content for ${f.name} (ID: ${f.tmdbId}):`,a)):(console.log("[BROWSE] Service not found, using fallback"),a=`${t}/tmdb/${d}/popular?page=${e}`)}else if(s==="streaming"&&!c){console.log("[BROWSE] No streaming service selected"),u(!1);return}else if(i==="anime")switch(s){case"trending":a=`${t}/anime/anilist/trending?page=${e}&perPage=20`;break;case"popular":a=`${t}/anime/anilist/popular?page=${e}&perPage=20`;break;case"top-rated":a=`${t}/anime/anilist/top-rated?page=${e}&perPage=20`;break;case"seasonal":a=`${t}/anime/anilist/seasonal?page=${e}&perPage=20`;break;default:throw new Error("Invalid anime category")}else switch(s){case"trending":a=`${t}/tmdb/trending/${i}/week?page=${e}`;break;case"popular":a=`${t}/tmdb/${i}/popular?page=${e}`;break;case"top-rated":a=`${t}/tmdb/${i}/top_rated?page=${e}`;break;case"upcoming":a=`${t}/tmdb/${i}/upcoming?page=${e}`;break;case"now-playing":a=`${t}/tmdb/${i}/now_playing?page=${e}`;break;case"on-the-air":a=`${t}/tmdb/${i}/on_the_air?page=${e}`;break;case"airing-today":a=`${t}/tmdb/${i}/airing_today?page=${e}`;break;default:throw new Error("Invalid category")}const P=await fetch(a);if(!P.ok)throw new Error(`Failed to fetch ${s} ${i}`);const N=await P.json(),I=N.results||N.data||[];g(r?f=>[...f,...I]:I),A(I.length===20&&e<(N.total_pages||50))}catch(a){console.error("Error fetching items:",a),k(a.message)}finally{u(!1)}};p(()=>{i&&s&&(g([]),$(1),k(null),s==="genres"?_():l(1,!1))},[i,s]),p(()=>{s==="genres"&&h&&(g([]),$(1),l(1,!1))},[h]),p(()=>{console.log(`[BROWSE] Streaming service changed to: ${c}`),s==="streaming"&&(console.log(`[BROWSE] Resetting items and fetching for streaming service: ${c}`),g([]),$(1),l(1,!1))},[c]),p(()=>{console.log(`[BROWSE] Media type changed to: ${o}`),s!=="anime"&&(console.log(`[BROWSE] Resetting items and fetching for media type: ${o}`),g([]),$(1),(s==="genres"&&h||s==="streaming"&&c||s!=="genres")&&l(1,!1))},[o]),p(()=>{i!=="anime"&&(g([]),$(1),k(null),s==="genres"?(_(),h&&l(1,!1)):l(1,!1))},[o]);const V=()=>{if(!b&&S){const e=M+1;$(e),l(e,!0)}},B=e=>{if(i==="anime"){let r,a,d;e.source==="tmdb"?(r=e.media_type||"tv",a=e.tmdb_id||e.id,d=`/watch/${r}/${a}`,r==="tv"&&(d+="/season/1/episode/1")):(r="anime",a=e.anilist_id||e.id,d=`/watch/anime/${a}/season/1/episode/1`),R(d)}else{const r=e.id;let a=`/watch/${i}/${r}`;i==="tv"&&(a+="/season/1/episode/1"),R(a)}};return C?n("div",{className:"browse-page",children:[n("div",{className:"browse-header",children:[n("button",{className:"back-button",onClick:()=>window.history.back(),children:[n("i",{className:"fas fa-arrow-left"})," Back"]}),n("h1",{children:"Error"})]}),n("div",{className:"error-message",children:[n("p",{children:C}),n("button",{onClick:()=>l(1,!1),children:"Try Again"})]})]}):n("div",{className:"browse-page",children:[n("div",{className:"browse-header",children:[n("button",{className:"back-button",onClick:()=>window.history.back(),children:[n("i",{className:"fas fa-arrow-left"})," Back"]}),n("h1",{className:"page-title",children:[L[s]||s,i!=="anime"&&n("span",{className:"media-type-indicator",children:[" - ",o==="movie"?"Movies":"TV Shows"]})]})]}),i!=="anime"&&n("div",{className:"filter-section",children:[n("h3",{children:"Content Type:"}),n("div",{className:"media-type-switcher",children:[n("button",{className:`media-type-btn ${o==="movie"?"active":""}`,onClick:()=>E("movie"),children:"Movies"}),n("button",{className:`media-type-btn ${o==="tv"?"active":""}`,onClick:()=>E("tv"),children:"TV Shows"})]})]}),s==="genres"&&n("div",{className:"filter-section",children:[n("h3",{children:"Select Genre:"}),n("div",{className:"genre-selector",children:n("select",{value:h,onChange:e=>G(e.target.value),className:"genre-select",children:[n("option",{value:"",children:"Choose a genre..."}),O.map(e=>n("option",{value:e.id,children:e.name},e.id))]})})]}),s==="streaming"&&n("div",{className:"filter-section",children:[n("h3",{children:"Select Streaming Service:"}),n("div",{className:"streaming-selector",children:T.map(e=>n("button",{className:`streaming-service-btn ${c===e.id?"active":""}`,onClick:()=>x(e.id),children:e.name},e.id))})]}),n("div",{className:"browse-content",children:[b&&w.length===0?n("div",{className:"items-grid",children:Array.from({length:20}).map((e,r)=>n(Y,{},`skeleton-${r}`))}):n(j,{children:[n("div",{className:"items-grid",children:w.map((e,r)=>i==="anime"?n(H,{item:e,onClick:()=>B(e)},`${e.id}-${r}`):n(D,{item:e,type:i==="anime"?i:o,onClick:()=>B(e)},`${e.id}-${r}`))}),S&&n("div",{className:"load-more-container",children:n("button",{className:"load-more-button",onClick:V,disabled:b,children:b?"Loading...":"Load More"})}),!S&&w.length>0&&n("div",{className:"end-message",children:n("p",{children:"You've reached the end!"})})]}),!b&&w.length===0&&n("div",{className:"no-content",children:[n("h3",{children:"No content available"}),n("p",{children:"Please try again later."})]})]})]})};export{y as default};
//# sourceMappingURL=Browse-DTcb_t5F.js.map
