import{u as e,E as oe,b as re,a as Re,A as p,L as ae,$ as N}from"./index-DJKKYvGv.js";import{d as y,y as _,k as Ve}from"./react-vendor-BYlzYzcd.js";import{M as C}from"./MovieCard-BNWtjiUN.js";import{S as Ae}from"./SkeletonCard-HUJuCd8-.js";/* empty css             *//* empty css                  */const Le=()=>e("div",{class:"features-showcase",children:[e("div",{class:"features-hero",children:e("div",{class:"features-hero-content",children:[e("h2",{class:"features-title",children:e("span",{class:"gradient-text",children:"Sign in for the full experience"})}),e("p",{class:"features-subtitle",children:"Get personalized recommendations, track your progress, and never lose your place"})]})}),e("div",{class:"features-grid",children:[{icon:"⏯️",title:"Continue Watching",description:"Pick up exactly where you left off across all your devices. Never lose your place again.",highlight:!0},{icon:"❤️",title:"Favorites Collection",description:"Save your favorite movies and TV shows in one place for quick access anytime.",highlight:!1},{icon:"📚",title:"Watch History",description:"Keep track of everything you've watched and easily find content you enjoyed.",highlight:!1},{icon:"🎯",title:"Personal Progress",description:"Sync your watch progress across devices and resume on any screen seamlessly.",highlight:!1},{icon:"🔍",title:"Smart Recommendations",description:"Get personalized suggestions based on your viewing history and preferences.",highlight:!1},{icon:"⚡",title:"Enhanced Experience",description:"Unlock the full potential of Fylm with user-specific features and settings.",highlight:!1}].map((v,M)=>e("div",{class:`feature-card ${v.highlight?"featured":""}`,children:[e("div",{class:"feature-icon",children:v.icon}),e("h3",{class:"feature-title",children:v.title}),e("p",{class:"feature-description",children:v.description})]},M))}),e("div",{class:"features-footer",children:[e("div",{class:"features-stats",children:[e("div",{class:"stat",children:[e("span",{class:"stat-number",children:"10K+"}),e("span",{class:"stat-label",children:"Movies & Shows"})]}),e("div",{class:"stat",children:[e("span",{class:"stat-number",children:"4K"}),e("span",{class:"stat-label",children:"Ultra HD Quality"})]}),e("div",{class:"stat",children:[e("span",{class:"stat-number",children:"∞"}),e("span",{class:"stat-label",children:"Unlimited Access"})]})]}),e("p",{class:"features-note",children:[e(oe,{href:"/login",class:"subtle-link",children:"Sign in"})," or ",e(oe,{href:"/signup",class:"subtle-link",children:"create an account"})," to unlock these features"]})]})]}),Ne=()=>{const{user:m,profile:v}=re();if(!m)return null;const M=()=>{const w=new Date().getHours();return w<12?"Good morning":w<17?"Good afternoon":"Good evening"},R=()=>{const w=v?.full_name||m.user_metadata?.full_name;return w?w.split(" ")[0]:m.email.split("@")[0]};return e("div",{class:"welcome-message",children:[e("div",{class:"welcome-content",children:[e("h2",{class:"welcome-title",children:[M(),", ",e("span",{class:"user-name",children:R()}),"!"]}),e("p",{class:"welcome-subtitle",children:"What would you like to watch today?"})]}),e("div",{class:"welcome-stats",children:[e("div",{class:"stat-item",children:[e("span",{class:"stat-icon",children:"🎬"}),e("span",{class:"stat-text",children:"Unlimited Movies"})]}),e("div",{class:"stat-item",children:[e("span",{class:"stat-icon",children:"📺"}),e("span",{class:"stat-text",children:"TV Shows"})]}),e("div",{class:"stat-item",children:[e("span",{class:"stat-icon",children:"⚡"}),e("span",{class:"stat-text",children:"HD Streaming"})]})]})]})},Ee=m=>{const{trending:v,popularMovies:M,popularTv:R,topRatedMovies:w,topRatedTv:ce,upcomingMovies:le,nowPlayingMovies:de,airingTodayTv:he,fetchTrending:U,fetchPopularMovies:D,fetchPopularTv:G,fetchTopRatedMovies:F,fetchTopRatedTv:j,fetchUpcomingMovies:I,fetchNowPlayingMovies:z,fetchAiringTodayTv:E,continueWatching:W,continueWatchingFetched:V,fetchContinueWatching:B,fetchFavorites:K,favoritesFetched:H,isFavorited:Ue,trendingLoading:pe,popularMoviesLoading:ge,popularTvLoading:me,topRatedMoviesLoading:ve,topRatedTvLoading:ue,upcomingMoviesLoading:fe,nowPlayingMoviesLoading:ye,airingTodayTvLoading:we}=Re(),{user:S}=re(),[n,A]=y("all"),[$,$e]=y("netflix"),[q,O]=y({}),[Q,J]=y(!1),[b,X]=y("28"),[Y,Z]=y({}),[be,ee]=y(!1),[te,ne]=y([]);_(()=>{m.path==="/movies"?A("movie"):m.path==="/tv"?A("tv"):A("all")},[m.path]),_(()=>{Se()},[n]),_(()=>{b&&Te(b)},[b,n]),_(()=>{$&&Me($)},[$,n]),_(()=>{U(),D(),G(),F(),j(),I(),z(),E()},[U,D,G,F,j,I,z,E]),_(()=>{S&&!V&&B()},[S,V,B]),_(()=>{S&&!H&&K()},[S,H,K]);const _e=t=>({"Trending This Week":"trending","Trending Movies":"trending","Popular Movies":"popular","Top Rated Movies":"top-rated","Upcoming Movies":"upcoming","Now Playing Movies":"now-playing","Trending TV Shows":"trending","Popular TV Shows":"popular","Top Rated TV Shows":"top-rated","Airing Today":"airing-today","On The Air":"on-the-air"})[t]||"popular",se=(t,o)=>{const s=_e(t);N(`/browse/${o||(n==="all"?"movie":n)}/${s}`)},u=(t,o,s,i)=>{if(i)return e("section",{class:"home-section",children:[e("div",{class:"section-header",children:[e("h2",{children:t}),e("button",{class:"view-all-btn",disabled:!0,children:["View All ",e("i",{class:"fas fa-arrow-right"})]})]}),e("div",{class:"scrolling-row",children:Array.from({length:10}).map((d,r)=>e(Ae,{},`skeleton-${t}-${r}`))})]});if(!o||o.length===0)return null;const h=o.filter((d,r,c)=>r===c.findIndex(l=>l.id===d.id));return e("section",{class:"home-section",children:[e("div",{class:"section-header clickable-header",onClick:()=>se(t,s),children:[e("h2",{children:t}),e("button",{class:"view-all-btn",onClick:d=>{d.stopPropagation(),se(t,s)},children:["View All ",e("i",{class:"fas fa-arrow-right"})]})]}),e("div",{class:"scrolling-row",children:h.map(d=>e(C,{item:d,type:s||d.media_type},`${t}-${d.id}`))})]})},P=t=>({netflix:"Netflix",prime:"Prime Video",hbo:"Max",disney:"Disney+",apple:"Apple TV+",paramount:"Paramount+"})[t]||t,Se=async()=>{try{const s=await(await fetch(`${p}/tmdb/genre/${n==="all"?"movie":n}/list`)).json();ne(s.genres||[]),s.genres&&s.genres.length>0&&!b&&X(s.genres[0].id.toString())}catch(t){console.error("Error fetching genres:",t),ne([])}},Te=async t=>{const o=`${n}-${t}`;if(!Y[o]){ee(!0);try{let s=[];if(n==="all"){const[i,h]=await Promise.all([fetch(`${p}/tmdb/discover/movie?with_genres=${t}&sort_by=popularity.desc&page=1`),fetch(`${p}/tmdb/discover/tv?with_genres=${t}&sort_by=popularity.desc&page=1`)]),d=await i.json(),r=await h.json(),c=(d.results||[]).map(a=>({...a,media_type:"movie"})),l=(r.results||[]).map(a=>({...a,media_type:"tv"}));s=[...c,...l].sort((a,f)=>(f.popularity||0)-(a.popularity||0)).slice(0,20)}else s=((await(await fetch(`${p}/tmdb/discover/${n}?with_genres=${t}&sort_by=popularity.desc&page=1`)).json()).results||[]).map(d=>({...d,media_type:n}));Z(i=>({...i,[o]:s}))}catch(s){console.error("Error fetching content by genre:",s),Z(i=>({...i,[o]:[]}))}finally{ee(!1)}}},Me=async t=>{const o=`${n}-${t}`;if(!q[o]){J(!0);try{const s={netflix:"8",prime:"119",hbo:"384",disney:"337",apple:"350",paramount:"531"},i=async(r,c)=>{try{const l=`${p}/tmdb/watch/providers/${c}?watch_region=US`,a=await fetch(l);if(!a.ok)return null;const L=(await a.json()).results||[],g={netflix:["Netflix"],prime:["Prime Video","Amazon Prime Video"],hbo:["Max","HBO Max"],disney:["Disney+","Disney Plus"],apple:["Apple TV+","Apple TV Plus"],paramount:["Paramount+","Paramount Plus"]}[r]||[r],T=L.find(k=>g.some(x=>(k.provider_name||"").toLowerCase()===x.toLowerCase()));return T?String(T.provider_id):null}catch{return null}},h=s[t];if(!h)throw new Error(`Unknown streaming service: ${t}`);let d=[];if(n==="all")try{console.log(`Fetching content for ${t} (${h}) - both movies and TV`);const r=encodeURIComponent("flatrate|ads|free");let[c,l]=await Promise.all([fetch(`${p}/tmdb/discover/movie?with_watch_providers=${h}&with_watch_monetization_types=${r}&watch_region=US&sort_by=popularity.desc&page=1`),fetch(`${p}/tmdb/discover/tv?with_watch_providers=${h}&with_watch_monetization_types=${r}&watch_region=US&sort_by=popularity.desc&page=1`)]);if(console.log(`Movie response status: ${c.status}, TV response status: ${l.status}`),!c.ok||!l.ok)throw new Error(`Failed to fetch content from TMDB - Movie: ${c.status}, TV: ${l.status}`);const a=await c.json(),f=await l.json();if((!a.results||a.results.length===0)&&(!f.results||f.results.length===0)){const g=await i(t,"movie"),T=await i(t,"tv"),k=g||h,x=T||h;console.log(`Retrying with resolved provider IDs movie=${k}, tv=${x}`),[c,l]=await Promise.all([fetch(`${p}/tmdb/discover/movie?with_watch_providers=${k}&with_watch_monetization_types=${r}&watch_region=US&sort_by=popularity.desc&page=1`),fetch(`${p}/tmdb/discover/tv?with_watch_providers=${x}&with_watch_monetization_types=${r}&watch_region=US&sort_by=popularity.desc&page=1`)]);const[xe,Ce]=await Promise.all([c.json(),l.json()]);a.results=xe.results||[],f.results=Ce.results||[]}console.log(`Found ${a.results?.length||0} movies and ${f.results?.length||0} TV shows for ${t}`);const L=(a.results||[]).map(g=>({...g,media_type:"movie"})),ie=(f.results||[]).map(g=>({...g,media_type:"tv"}));d=[...L,...ie].sort((g,T)=>(T.popularity||0)-(g.popularity||0)).slice(0,20)}catch(r){console.error("Error fetching combined content:",r),d=[]}else{console.log(`Fetching ${n} content for ${t} (${h})`);const r=encodeURIComponent("flatrate|ads|free");let c=await fetch(`${p}/tmdb/discover/${n}?with_watch_providers=${h}&with_watch_monetization_types=${r}&watch_region=US&sort_by=popularity.desc&page=1`);if(console.log(`${n} response status: ${c.status}`),!c.ok)throw new Error(`Failed to fetch ${n} content from TMDB - Status: ${c.status}`);let l=await c.json();if(!l.results||l.results.length===0){const a=await i(t,n);a&&a!==h&&(console.log(`Retrying ${n} with resolved provider ID ${a}`),c=await fetch(`${p}/tmdb/discover/${n}?with_watch_providers=${a}&with_watch_monetization_types=${r}&watch_region=US&sort_by=popularity.desc&page=1`),c.ok&&(l=await c.json()))}console.log(`Found ${l.results?.length||0} ${n} items for ${t}`),d=(l.results||[]).map(a=>({...a,media_type:n}))}console.log(`Setting streaming content for ${o}:`,d),O(r=>({...r,[o]:d}))}catch(s){console.error("Error fetching content by streaming service:",s),O(i=>({...i,[o]:[]}))}finally{J(!1)}}},Pe=t=>{const o=`${n}-${t}`,s=q[o]||[];return console.log(`Rendering streaming content for ${o}:`,s.length,"items"),Q?e("div",{className:"loading-spinner",children:e("div",{className:"spinner"})}):!s||s.length===0?e("div",{className:"no-content",children:e("p",{children:["No content available for ",P(t)]})}):s.map(i=>e(C,{item:i,type:n==="all"?i.media_type:n},`${t}-${i.id}`))},ke=t=>{const o=`${n}-${t}`,s=Y[o]||[];return be?e("div",{className:"loading-spinner",children:e("div",{className:"spinner"})}):!s||s.length===0?e("div",{className:"no-content",children:e("p",{children:"No content available for this genre"})}):s.map(i=>e(C,{item:i,type:n==="all"?i.media_type||"movie":n},`genre-${t}-${i.id}`))};return e("div",{class:"container home-page",children:[e("h1",{class:"main-title",children:[n==="movie"&&"Movies",n==="tv"&&"TV Shows",n==="all"&&"Discover"]}),!S&&n==="all"&&e(Ve,{children:[e("div",{class:"guest-info-banner",style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"16px",marginBottom:"24px",textAlign:"center"},children:[e("h3",{style:{margin:"0 0 8px 0",color:"var(--text-primary)"},children:"🎬 Start Streaming Instantly"}),e("p",{style:{margin:"0",color:"var(--text-secondary)"},children:["No account required! Click any movie or TV show to start watching immediately.",e("a",{href:"/login",style:{color:"var(--accent-color)",textDecoration:"none",marginLeft:"4px"},children:"Sign up"})," to save favorites, track progress, and continue watching across devices."]})]}),e(Le,{})]}),S&&n==="all"&&e(Ne,{}),V?W.length>0&&e("section",{class:"home-section",children:[e("h2",{children:"Continue Watching"}),e("div",{class:"scrolling-row scrolling-row--compact",children:W.map(t=>e(C,{item:t,type:t.type,progress:t.progress_seconds,duration:t.duration_seconds},`continue-watching-${t.type}-${t.id}`))})]}):e(ae,{text:"Loading your continue watching..."}),n==="all"&&e("section",{class:"home-section streaming-services-section",children:[e("div",{class:"streaming-services-header",children:[e("h2",{children:["Series on ",e("span",{class:"streaming-service-name",children:P($)})]}),e("button",{class:"view-all-btn",onClick:t=>{t.stopPropagation(),N("/browse/tv/streaming")},children:["View All ",e("i",{class:"fas fa-arrow-right"})]})]}),e("div",{class:"streaming-services-tabs",children:["netflix","prime","hbo","disney","apple","paramount"].map(t=>e("button",{class:`streaming-tab ${$===t?"active":""}`,onClick:()=>$e(t),children:P(t)},t))}),e("div",{class:"streaming-content",children:Q?e(ae,{text:`Loading ${P($)} content...`}):e("div",{class:"scrolling-row",children:Pe($)})})]}),e("section",{class:"home-section genres-section",children:[e("div",{class:"section-header",children:[e("h2",{children:"Browse by Genre"}),e("span",{class:"genre-name",children:te.find(t=>t.id.toString()===b)?.name||"Loading..."}),e("button",{class:"view-all-btn",onClick:t=>{t.stopPropagation(),N("/browse/movie/genres")},children:["View All ",e("i",{class:"fas fa-arrow-right"})]})]}),e("div",{class:"genre-tabs-container",children:e("div",{class:"genre-tabs",children:te.slice(0,8).map(t=>e("button",{class:`genre-tab ${b===t.id.toString()?"active":""}`,onClick:()=>X(t.id.toString()),children:t.name},t.id))})}),e("div",{class:"genre-content",children:e("div",{class:"scrolling-row",children:ke(b)})})]}),n==="all"&&u("Trending This Week",v,void 0,pe),n!=="tv"&&u("Popular Movies",M,"movie",ge),n!=="tv"&&u("Now Playing Movies",de,"movie",ye),n!=="movie"&&u("Popular TV Shows",R,"tv",me),(n==="all"||n==="movie")&&u("Top Rated Movies",w,"movie",ve),(n==="all"||n==="movie")&&u("Upcoming Movies",le,"movie",fe),(n==="all"||n==="tv")&&u("Top Rated TV Shows",ce,"tv",ue),(n==="all"||n==="tv")&&u("Airing Today",he,"tv",we)]})};export{Ee as default};
//# sourceMappingURL=Home-DBy9DE4u.js.map
