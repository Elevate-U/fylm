import{b as q,a as J,u as s,$ as Q,g as u}from"./index-Db6xGWP3.js";import{d as X,A as Z,y as ee}from"./react-vendor-BYlzYzcd.js";const fe=({item:n,progress:b,duration:h,showDeleteButton:T,onDelete:v,onClick:N})=>{const[D,L]=X(!1),r=Z(null);ee(()=>{const e=new IntersectionObserver(([t])=>{L(t.isIntersecting)},{rootMargin:"50px",threshold:.1});return r.current&&e.observe(r.current),()=>{r.current&&e.unobserve(r.current)}},[]);const{id:ne,title:m,poster_path:U,overview:se,vote_average:k,first_air_date:_,status:f,episodes:$,format:te,nextAiringEpisode:p,studios:c,genres:o,season:ie,seasonYear:F,source:ae,meanScore:P,favourites:S,tags:re,trailer:oe,isAdult:le,duration:ce,season_number:A,episode_number:x,episode_name:I}=n,E=m?.english||m?.romaji||m||n.name||"Unknown Anime",w=b&&h>0?b/h*100:0,y=_?new Date(_).getFullYear():F,{user:d}=q(),{addFavorite:G,removeFavorite:B,isShowFavorited:z,favoritesFetched:H}=J(),g=z(n.id||n.anilist_id,"anime",n.season_number,n.episode_number),Y=e=>{e.preventDefault(),e.stopPropagation(),d&&(g?B(d.id,n.id||n.anilist_id,"anime",n.season_number,n.episode_number):G(d.id,{...n,type:"anime"}))},C=e=>{if(e.preventDefault(),e.stopPropagation(),console.log("AnimeCard clicked:",n),N)N(n);else{let t;if(n.source==="tmdb"){const i=n.media_type||"tv",a=n.tmdb_id||n.id;t=`/watch/${i}/${a}`,i==="tv"&&(n.season_number&&n.episode_number?t+=`/season/${n.season_number}/episode/${n.episode_number}`:t+="/season/1/episode/1")}else t=`/watch/anime/${n.anilist_id||n.id}`,n.season_number&&n.episode_number?t+=`/season/${n.season_number}/episode/${n.episode_number}`:t+="/season/1/episode/1";if(n.source!=="tmdb"||n.media_type==="tv"){const i=localStorage.getItem("anime-audio-preference")||"subbed",a=new URLSearchParams;i==="dubbed"&&a.set("dub","true"),a.toString()&&(t+=`?${a.toString()}`)}console.log("Routing to:",t),Q(t)}},M=(()=>{if(A&&x)return`S${A} E${x}${I?`: ${I}`:""}`;const e=[];return y&&e.push(y.toString()),$&&e.push(`${$} episodes`),e.length>0?e.join(" • "):null})(),j=()=>{if(!f)return null;const t={RELEASING:{text:"Airing",class:"airing"},FINISHED:{text:"Completed",class:"completed"},NOT_YET_RELEASED:{text:"Upcoming",class:"upcoming"},CANCELLED:{text:"Cancelled",class:"cancelled"},HIATUS:{text:"Hiatus",class:"hiatus"}}[f];return t?s("div",{className:`anime-status-badge ${t.class}`,children:t.text}):null},O=()=>{if(!p||f!=="RELEASING")return null;const e=p.timeUntilAiring;if(e<=0)return null;const t=Math.floor(e/(24*60*60)),i=Math.floor(e%(24*60*60)/(60*60)),a=Math.floor(e%(60*60)/60);let l="";return t>0?l=`${t}d ${i}h`:i>0?l=`${i}h ${a}m`:a>0?l=`${a}m`:l="Soon",s("div",{className:"next-episode-info",children:[s("span",{className:"next-ep-label",children:["Ep ",p.episode]}),s("span",{className:"next-ep-time",children:["in ",l]})]})},R=()=>{if(!c||c.length===0)return null;const e=c.find(t=>t.isMain)||c[0];return e?.name||e},V=()=>!o||o.length===0?null:o.slice(0,2).map(e=>s("span",{className:"genre-tag",children:e},e)),W=e=>e?e.includes("anilist.co")||e.includes("anili.st")||e.includes("anilistcdn")?u(e):e.startsWith("http")?u(e):e.startsWith("/")?u(`${`https://image.tmdb.org/t/p/${D?"w500":"w200"}`}${e}`):u(e):"https://via.placeholder.com/500x750/1a1a1a/ffffff?text=No+Image",K=()=>{const e=P||k;return e?(e>10?e/10:e).toFixed(1):"N/A"};return s("div",{className:"anime-card-container",ref:r,children:s("div",{className:"anime-card",onClick:C,style:{cursor:"pointer"},role:"button",tabIndex:0,onKeyDown:e=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),C(e))},children:s("div",{className:"anime-poster-wrapper",children:[s("img",{src:W(U),alt:E,loading:"lazy",width:"500",height:"750"}),s("div",{className:"anime-scrim"}),j(),w>.01&&s("div",{className:"anime-progress-container",children:s("div",{className:"anime-progress-bar",style:{width:`${Math.min(w,100)}%`}})}),s("div",{className:"streaming-indicator",children:s("span",{className:`source-badge ${(n.source||"tmdb")==="anilist"?"anilist":"tmdb"}`,children:(n.source||"tmdb")==="anilist"?"AniList":"TMDB"})}),s("div",{className:"anime-card-info",children:[s("div",{className:"anime-title-row",children:[s("h3",{className:"anime-card-title",children:E}),d&&s("button",{className:`anime-favorite-btn ${g?"favorited":""}`,onClick:Y,"aria-label":g?"Remove from favorites":"Add to favorites",disabled:!H,children:"♥︎"})]}),M&&s("p",{className:"anime-card-subtitle",children:M}),O(),R()&&s("p",{className:"anime-studio-info",children:R()}),o&&o.length>0&&s("div",{className:"anime-genre-tags",children:V()}),s("div",{className:"anime-rating-row",children:[s("span",{className:"anime-rating",children:["★ ",K()]}),S&&s("span",{className:"anime-favorites",children:["♥ ",S.toLocaleString()]})]})]}),T&&s("button",{className:"anime-delete-btn",onClick:e=>{e.preventDefault(),e.stopPropagation(),v&&v(n)},"aria-label":"Remove from continue watching",children:"×"})]})})})};export{fe as A};
//# sourceMappingURL=AnimeCard-rRT1xk6E.js.map
