const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DJKKYvGv.js","assets/react-vendor-BYlzYzcd.js","assets/index-BoWFqI32.css"])))=>i.map(i=>d[i]);
import{b as Fe,s as ce,B as A,u as e,H as ee,n as Me,_ as Be}from"./index-DJKKYvGv.js";import{d as o,y as U,k as te}from"./react-vendor-BYlzYzcd.js";import{u as Re,a as Ue}from"./seoUtils-Dl604mDg.js";const We=()=>{const{user:s,session:v,loading:w,authReady:_}=Fe(),[D,r]=o([]),[k,x]=o([]),[C,d]=o(!0),[g,c]=o(null),[E,P]=o(!1),[F,N]=o(null),[m,$]=o(null),[l,i]=o(1),[y,n]=o(1),[p,b]=o(""),[h,S]=o(""),[T,M]=o("created_at"),[j,de]=o("desc"),[I,he]=o(!1),[ue,Z]=o(!0),[Q,me]=o(!1),[L,O]=o([]),[ge,H]=o(!1),[K,ae]=o(!1),[W,pe]=o(!1),[be,fe]=o(new Date),[z,ve]=o({}),[G,le]=o(!1),[ne,se]=o(!1),Ne=new Me,ye=async()=>{if(Q)return I;try{console.log("Checking admin status..."),Z(!0);const t=await A.isAdmin();return console.log("Admin status result:",t),he(t),me(!0),t?(console.log("User is admin, loading data..."),await V()):(console.log("User is not admin"),c("Access denied. Admin privileges required.")),t}catch(t){return console.error("Error checking admin status:",t),c("Failed to verify admin access: "+t.message),!1}finally{Z(!1)}};U(()=>{Re("Blog Admin - Manage Posts"),Ue("Admin panel for managing blog posts, categories, and content.")},[]),U(()=>{if(!_||w){console.log("Auth not ready yet, waiting...",{authReady:_,authLoading:w});return}if(!s||!v){console.log("No user or session, redirecting to login"),c("Please log in to access the admin panel."),Z(!1);return}(async()=>{console.log("Auth ready, initializing admin with user:",s?.email),await ye()&&await R()})();const u=new URLSearchParams(window.location.hash.split("?")[1]).get("edit");u&&Ce(u)},[_,w,s,v]),U(()=>{I&&Q&&R()},[l,p,h,T,j]),U(()=>{Q&&I&&R()},[I,Q]);const V=async()=>{if(I)try{const[t,a]=await Promise.all([A.getCategories(),A.getBlogStats()]);x(t),$(a)}catch(t){console.error("Error loading initial data:",t),c("Failed to load admin data")}},R=async()=>{if(console.log("loadPosts called, isAdmin:",I),!I||!Q){console.log("User is not admin or admin status not checked, skipping loadPosts");return}try{d(!0),c(null),console.log("Loading posts...");const t=h?k.find(B=>B.id===h)?.slug:null,{data:a,error:u}=await ce.rpc("get_all_blog_posts_admin",{limit_count:10,offset_count:(l-1)*10,filter_status:null,filter_category_slug:t});if(console.log("Supabase response:",{data:a,error:u}),u)throw u;let f=a||[];if(p){const B=p.toLowerCase();f=f.filter(q=>q.title.toLowerCase().includes(B)||q.excerpt?.toLowerCase().includes(B)||q.category_name?.toLowerCase().includes(B))}f.sort((B,q)=>{let Y,J;switch(T){case"title":Y=B.title.toLowerCase(),J=q.title.toLowerCase();break;case"updated_at":Y=new Date(B.updated_at),J=new Date(q.updated_at);break;case"created_at":default:Y=new Date(B.created_at),J=new Date(q.created_at);break}return j==="asc"?Y>J?1:-1:Y<J?1:-1}),r(f),n(Math.ceil(f.length/10))}catch(t){console.error("Error loading posts:",t),c("Failed to load posts: "+t.message)}finally{d(!1)}},we=()=>{N(null),P(!0)},ke=async t=>{try{d(!0);const a=await A.getPostById(t.id);a?(N(a),P(!0)):c("Post not found")}catch(a){console.error("Error loading post for editing:",a),c("Failed to load post for editing")}finally{d(!1)}},Ce=async t=>{try{d(!0);const a=await A.getPostById(t);a?(N(a),P(!0)):c("Post not found")}catch(a){console.error("Error loading post for editing:",a),c("Failed to load post for editing")}finally{d(!1)}},Pe=async t=>{if(confirm("Are you sure you want to delete this post? This action cannot be undone."))try{d(!0),await A.deletePost(t),await R(),await V(),O(a=>a.filter(u=>u!==t))}catch(a){console.error("Error deleting post:",a),c("Failed to delete post: "+a.message)}finally{d(!1)}},Se=t=>{O(a=>{if(a.includes(t)){const u=a.filter(f=>f!==t);return H(u.length>0),u}else{const u=[...a,t];return H(!0),u}})},_e=()=>{if(L.length===D.length)O([]),H(!1);else{const t=D.map(a=>a.id);O(t),H(!0)}},xe=async()=>{if(L.length!==0&&confirm(`Are you sure you want to delete ${L.length} posts? This action cannot be undone.`))try{d(!0),c(null),await A.bulkDeletePosts(L),r(t=>t.filter(a=>!L.includes(a.id))),O([]),H(!1)}catch(t){console.error("Error bulk deleting posts:",t),c("Failed to delete selected posts")}finally{d(!1)}},ie=async t=>{if(L.length!==0)try{d(!0),c(null),await A.bulkUpdateStatus(L,t),r(a=>a.map(u=>L.includes(u.id)?{...u,status:t}:u)),O([]),H(!1)}catch(a){console.error("Error updating posts:",a),c("Failed to update selected posts")}finally{d(!1)}},re=async()=>{ae(!0);try{await Promise.all([R(),V()]),fe(new Date)}catch(t){console.error("Error refreshing data:",t),c("Failed to refresh data")}finally{ae(!1)}};U(()=>{if(!W||!I)return;const t=setInterval(()=>{re()},3e4);return()=>clearInterval(t)},[W,I]);const Ee=async t=>{try{const a=await A.getPostAnalytics(t);ve(u=>({...u,[t]:a}))}catch(a){console.error("Error loading post analytics:",a)}},Ae=()=>{se(!0)},$e=async t=>{try{d(!0);const a={...t,title:`${t.title} (Copy)`,slug:`${t.slug}-copy-${Date.now()}`,status:"draft",created_at:void 0,updated_at:void 0,id:void 0};await A.createPost(a),await R(),await V()}catch(a){console.error("Error duplicating post:",a),c("Failed to duplicate post")}finally{d(!1)}},Te=async t=>{try{d(!0);const a=t.status==="published"?"draft":"published";await A.updatePost(t.id,{status:a}),r(u=>u.map(f=>f.id===t.id?{...f,status:a,updated_at:new Date().toISOString()}:f)),await V()}catch(a){console.error("Error updating post status:",a),c("Failed to update post status")}finally{d(!1)}},De=()=>{P(!1),N(null),R(),V()},Le=t=>{t.preventDefault(),i(1),R()},X=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Ie=t=>new Date(t).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),oe=t=>{const a=new Date,u=new Date(t),f=Math.floor((a-u)/1e3);return f<60?"Just now":f<3600?`${Math.floor(f/60)}m ago`:f<86400?`${Math.floor(f/3600)}h ago`:f<604800?`${Math.floor(f/86400)}d ago`:X(t)};return ue||w||!_?e(te,{children:[e(ee,{}),e("main",{className:"blog-admin",children:e("div",{className:"loading-spinner",children:[e("div",{className:"spinner"}),e("p",{children:w||!_?"Loading authentication...":"Checking admin access..."})]})})]}):I?E?e(je,{post:F,categories:k,onClose:De,blogAPI:A,imageProcessor:Ne}):e(te,{children:[e(ee,{}),e("main",{className:"blog-admin",children:[e("div",{className:"admin-header",children:[e("h1",{children:"Blog Admin"}),e("div",{className:"header-actions",children:[e("button",{className:"refresh-btn",onClick:re,disabled:K,title:"Refresh Data",children:[e("span",{className:`icon ${K?"spinning":""}`,children:"🔄"}),K?"Refreshing...":"Refresh"]}),e("button",{className:`auto-refresh-btn ${W?"active":""}`,onClick:()=>pe(!W),title:"Toggle Auto-refresh (30s)",children:[e("span",{className:"icon",children:W?"⏸️":"▶️"}),"Auto"]}),e("button",{className:"analytics-btn",onClick:()=>le(!G),title:"Toggle Analytics View",children:[e("span",{className:"icon",children:"📊"}),"Analytics"]}),e("button",{className:"export-btn",onClick:Ae,title:"Export Posts",children:[e("span",{className:"icon",children:"📥"}),"Export"]}),e("button",{className:"create-post-btn",onClick:we,children:[e("span",{className:"icon",children:"+"}),"Create New Post"]}),e("span",{className:"last-refresh",children:["Last updated: ",oe(be)]})]})]}),m&&e("div",{className:"stats-dashboard",children:[e("div",{className:"stat-card",children:[e("h3",{children:"Total Posts"}),e("p",{className:"stat-number",children:m.totalPosts})]}),e("div",{className:"stat-card",children:[e("h3",{children:"Published"}),e("p",{className:"stat-number",children:m.publishedPosts})]}),e("div",{className:"stat-card",children:[e("h3",{children:"Drafts"}),e("p",{className:"stat-number",children:m.draftPosts})]}),e("div",{className:"stat-card",children:[e("h3",{children:"Categories"}),e("p",{className:"stat-number",children:k.length})]})]}),e("div",{className:"admin-controls",children:[e("form",{className:"search-form",onSubmit:Le,children:[e("input",{type:"text",placeholder:"Search posts...",value:p,onChange:t=>b(t.target.value),className:"search-input"}),e("button",{type:"submit",className:"search-btn",children:"Search"})]}),e("div",{className:"filters",children:[e("select",{value:h,onChange:t=>{S(t.target.value),i(1)},className:"filter-select",children:[e("option",{value:"",children:"All Categories"}),k.map(t=>e("option",{value:t.id,children:t.name},t.id))]}),e("select",{value:`${T}-${j}`,onChange:t=>{const[a,u]=t.target.value.split("-");M(a),de(u),i(1)},className:"filter-select",children:[e("option",{value:"created_at-desc",children:"Newest First"}),e("option",{value:"created_at-asc",children:"Oldest First"}),e("option",{value:"title-asc",children:"Title A-Z"}),e("option",{value:"title-desc",children:"Title Z-A"}),e("option",{value:"updated_at-desc",children:"Recently Updated"})]})]})]}),ge&&e("div",{className:"bulk-actions-toolbar",children:[e("div",{className:"bulk-info",children:e("span",{children:[L.length," post",L.length!==1?"s":""," selected"]})}),e("div",{className:"bulk-actions",children:[e("button",{className:"bulk-btn publish-btn",onClick:()=>ie("published"),disabled:C,children:"📢 Publish Selected"}),e("button",{className:"bulk-btn draft-btn",onClick:()=>ie("draft"),disabled:C,children:"📝 Move to Draft"}),e("button",{className:"bulk-btn delete-btn",onClick:xe,disabled:C,children:"🗑️ Delete Selected"}),e("button",{className:"bulk-btn cancel-btn",onClick:()=>{O([]),H(!1)},children:"✕ Cancel"})]})]}),g&&e("div",{className:"error-message",children:[e("p",{children:g}),e("button",{onClick:()=>c(null),className:"dismiss-error",children:"✕"})]}),C?e("div",{className:"loading-spinner",children:[e("div",{className:"spinner"}),e("p",{children:"Loading posts..."})]}):e("div",{className:"posts-table-container",children:[e("table",{className:"posts-table",children:[e("thead",{children:e("tr",{children:[e("th",{className:"checkbox-cell",children:e("input",{type:"checkbox",checked:D.length>0&&L.length===D.length,onChange:_e,title:"Select All"})}),e("th",{children:"Title"}),e("th",{children:"Category"}),e("th",{children:"Status"}),e("th",{children:"Created"}),e("th",{children:"Updated"}),e("th",{children:"Views"}),e("th",{children:"Actions"})]})}),e("tbody",{children:D.map(t=>e("tr",{className:`${t.status==="published"?"published":"draft"} ${L.includes(t.id)?"selected":""}`,children:[e("td",{className:"checkbox-cell",children:e("input",{type:"checkbox",checked:L.includes(t.id),onChange:()=>Se(t.id)})}),e("td",{className:"post-title-cell",children:e("div",{className:"post-title-info",children:[e("h4",{children:t.title}),e("p",{className:"post-excerpt",children:t.excerpt})]})}),e("td",{children:e("span",{className:"category-badge enhanced",style:{backgroundColor:(t.category_color||"#6366f1")+"15",borderColor:(t.category_color||"#6366f1")+"40",color:t.category_color||"#6366f1"},children:[e("div",{className:"category-dot",style:{backgroundColor:t.category_color||"#6366f1"}}),t.category_name||"Uncategorized"]})}),e("td",{children:e("button",{className:`status-toggle enhanced ${t.status==="published"?"published":"draft"}`,onClick:()=>Te(t),disabled:C,children:[e("div",{className:`status-dot ${t.status==="published"?"published":"draft"}`}),t.status==="published"?"Published":"Draft"]})}),e("td",{className:"date-cell",children:e("div",{className:"date-info",children:[e("span",{className:"date",children:X(t.created_at)}),e("span",{className:"time",children:Ie(t.created_at)})]})}),e("td",{className:"date-cell",children:e("div",{className:"date-info",children:[e("span",{className:"date",children:X(t.updated_at)}),e("span",{className:"time relative",children:oe(t.updated_at)})]})}),e("td",{className:"views-cell",children:e("div",{className:"view-count",children:[e("span",{className:"count",children:t.view_count||0}),e("span",{className:"label",children:"views"}),e("svg",{className:"view-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),G&&z[t.id]&&e("div",{className:"analytics-tooltip",children:e("small",{children:"Analytics loaded"})})]})}),e("td",{className:"actions-cell",children:e("div",{className:"post-actions",children:[e("button",{className:"action-btn edit",onClick:()=>ke(t),title:"Edit Post",children:[e("span",{children:"✏️"}),e("span",{children:"Edit"})]}),t.status==="published"&&e("a",{href:`/#/blog/${t.slug}`,target:"_blank",className:"action-btn view",title:"View Post",children:[e("span",{children:"👁️"}),e("span",{children:"View"})]}),e("button",{className:"action-btn duplicate",onClick:()=>$e(t),title:"Duplicate Post",disabled:C,children:[e("span",{children:"📋"}),e("span",{children:"Copy"})]}),G&&e("button",{className:"action-btn analytics",onClick:()=>Ee(t.id),title:"Load Analytics",children:[e("span",{children:"📊"}),e("span",{children:"Stats"})]}),e("button",{className:"action-btn delete",onClick:()=>Pe(t.id),title:"Delete Post",children:[e("span",{children:"🗑️"}),e("span",{children:"Delete"})]})]})})]},t.id))})]}),D.length===0&&e("div",{className:"no-posts",children:e("p",{children:"No posts found. Create your first post to get started!"})})]}),G&&e("div",{className:"analytics-section",children:[e("div",{className:"analytics-header",children:[e("h3",{children:"Post Analytics Overview"}),e("button",{onClick:()=>le(!1),className:"btn btn-secondary",children:"Hide Analytics"})]}),e("div",{className:"analytics-grid",children:[e("div",{className:"analytics-card",children:[e("h4",{children:"Total Posts with Analytics"}),e("div",{className:"analytics-value",children:Object.keys(z).length})]}),e("div",{className:"analytics-card",children:[e("h4",{children:"Average Views"}),e("div",{className:"analytics-value",children:Object.keys(z).length>0?Math.round(Object.values(z).reduce((t,a)=>t+(a.views||0),0)/Object.keys(z).length):0})]}),e("div",{className:"analytics-card",children:[e("h4",{children:"Total Engagement"}),e("div",{className:"analytics-value",children:Object.values(z).reduce((t,a)=>t+(a.engagement||0),0)})]}),e("div",{className:"analytics-card",children:[e("h4",{children:"Analytics Last Updated"}),e("div",{className:"analytics-value",children:new Date().toLocaleTimeString()})]})]})]}),y>1&&e("div",{className:"pagination",children:[e("button",{className:"page-btn",onClick:()=>i(t=>Math.max(1,t-1)),disabled:l===1,children:"Previous"}),e("div",{className:"page-numbers",children:Array.from({length:y},(t,a)=>a+1).map(t=>e("button",{className:`page-btn ${t===l?"active":""}`,onClick:()=>i(t),children:t},t))}),e("button",{className:"page-btn",onClick:()=>i(t=>Math.min(y,t+1)),disabled:l===y,children:"Next"})]}),ne&&e(qe,{isOpen:ne,posts:D,onClose:()=>se(!1)})]})]}):e(te,{children:[e(ee,{}),e("main",{className:"blog-admin",children:e("div",{className:"access-denied",children:[e("h1",{children:"Access Denied"}),e("p",{children:"You need administrator privileges to access the blog admin panel."}),e("p",{children:"If you believe you should have access, please contact the site administrator."}),e("a",{href:"/blog",className:"back-to-blog-btn",children:"← Back to Blog"})]})})]})},je=({post:s,categories:v,onClose:w,blogAPI:_,imageProcessor:D})=>{const[r,k]=o({title:"",slug:"",excerpt:"",content:"",category_id:v[0]?.id||"",featured_image:"",tags:"",status:"draft",meta_title:"",meta_description:""}),[x,C]=o(!1),[d,g]=o(!1),[c,E]=o(!1),[P,F]=o(!1);U(()=>{s?(console.log("Loading post data for editing:",s),console.log("Post meta_title:",s.meta_title),console.log("Post meta_description:",s.meta_description),F(!0),k({title:s.title||"",slug:s.slug||"",excerpt:s.excerpt||"",content:s.content||"",category_id:s.category_id||v[0]?.id||"",featured_image:s.featured_image_url||"",tags:Array.isArray(s.tags)?s.tags.join(", "):s.tags||"",status:s.status||"draft",meta_title:s.meta_title||"",meta_description:s.meta_description||""}),E(!!s.slug),F(!1)):(k({title:"",slug:"",excerpt:"",content:"",category_id:v[0]?.id||"",featured_image:"",tags:"",status:"draft",meta_title:"",meta_description:""}),E(!1))},[s,v]),U(()=>{if(!c&&r.title){const l=r.title.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim();k(i=>({...i,slug:l}))}},[r.title,c]);const N=(l,i)=>{k(y=>({...y,[l]:i})),l==="slug"&&E(!0)},m=async l=>{const i=document.getElementById("content-editor"),y=i?i.selectionStart:0;k(n=>({...n,content:l})),g(!0);try{const n=await D.processContentImages(l);n!==l&&(k(p=>({...p,content:n})),setTimeout(()=>{i&&(i.focus(),i.setSelectionRange(y,y))},0))}catch(n){console.error("Error processing images:",n)}finally{g(!1)}},$=async(l=!1)=>{if(!r.title.trim()){alert("Please enter a title");return}if(!r.content.trim()){alert("Please enter some content");return}if(x){console.log("Save already in progress, ignoring duplicate request");return}C(!0),console.log(`Starting ${l?"publish":"save"} operation...`);try{const{data:{user:i},error:y}=await ce.auth.getUser();if(y||!i)throw new Error("Authentication required. Please sign in again.");if(!await A.isAdmin())throw new Error("Admin privileges required to save posts.");const p=r.content.replace(/\n{3,}/g,`

`).trim(),b={...r,content:p,featured_image_url:r.featured_image,tags:r.tags.split(",").map(M=>M.trim()).filter(Boolean),status:l?"published":r.status||"draft",meta_title:r.meta_title||r.title,meta_description:r.meta_description||r.excerpt};delete b.featured_image,console.log("Saving post data:",{...b,content:"[content truncated]"});let h;const S=Date.now();s?(console.log("Updating existing post:",s.id),h=await Promise.race([A.updatePost(s.id,b),new Promise((M,j)=>setTimeout(()=>j(new Error("Save operation timed out")),3e4))])):(console.log("Creating new post"),h=await Promise.race([A.createPost(b),new Promise((M,j)=>setTimeout(()=>j(new Error("Save operation timed out")),3e4))]));const T=Date.now()-S;if(console.log(`Save operation completed in ${T}ms`),!h)throw new Error("No response received from server");if(h.error)throw new Error(h.error.message||"Failed to save post");console.log("Post saved successfully:",h.id),alert(l?"Post published successfully!":"Post saved as draft!"),w()}catch(i){console.error("Error saving post:",i);let y=i.message;i.message.includes("timeout")?y="The save operation timed out. Please check your connection and try again.":i.message.includes("Authentication")?y="Please sign in again to continue.":i.message.includes("Admin privileges")&&(y="You need admin privileges to save posts."),alert(`Failed to ${l?"publish":"save"} post: ${y}`)}finally{C(!1),console.log("Save operation finished, saving state reset")}};return P?e("div",{className:"editor-modal",children:e("div",{className:"editor-container",children:e("div",{className:"loading-container",children:[e("div",{className:"loading-spinner"}),e("p",{children:"Loading post data..."})]})})}):e("div",{className:"editor-modal",children:e("div",{className:"editor-container",children:[e("div",{className:"editor-header",children:[e("h2",{children:s?"Edit Post":"Create New Post"}),e("button",{className:"close-btn",onClick:w,disabled:x,children:"×"})]}),e("div",{className:"editor-form",children:[e("div",{className:"form-grid",children:[e("div",{className:"form-group",children:[e("label",{htmlFor:"title",children:"Title *"}),e("input",{id:"title",type:"text",value:r.title,onChange:l=>N("title",l.target.value),placeholder:"Enter post title...",className:"form-input"})]}),e("div",{className:"form-group",children:[e("label",{htmlFor:"slug",children:"URL Slug"}),e("input",{id:"slug",type:"text",value:r.slug,onChange:l=>N("slug",l.target.value),placeholder:"url-friendly-slug",className:"form-input"})]}),e("div",{className:"form-group",children:[e("label",{htmlFor:"category",children:"Category"}),e("select",{id:"category",value:r.category_id,onChange:l=>N("category_id",l.target.value),className:"form-select",children:v.map(l=>e("option",{value:l.id,children:l.name},l.id))})]}),e("div",{className:"form-group",children:[e("label",{htmlFor:"status",children:"Status"}),e("select",{id:"status",value:r.status,onChange:l=>N("status",l.target.value),className:"form-select status-select",children:[e("option",{value:"draft",children:"Draft"}),e("option",{value:"published",children:"Published"})]})]}),e("div",{className:"form-group full-width",children:[e("label",{htmlFor:"excerpt",children:"Excerpt"}),e("textarea",{id:"excerpt",value:r.excerpt,onChange:l=>N("excerpt",l.target.value),placeholder:"Brief description of the post...",className:"form-textarea",rows:"3"})]}),e("div",{className:"form-group full-width",children:[e("label",{htmlFor:"featured-image",children:"Featured Image URL"}),e("input",{id:"featured-image",type:"url",value:r.featured_image,onChange:l=>N("featured_image",l.target.value),placeholder:"https://example.com/image.jpg",className:"form-input"}),r.featured_image&&e("div",{className:"image-preview",style:{marginTop:"0.5rem"},children:e("img",{src:r.featured_image,alt:"Featured image preview",style:{maxWidth:"200px",maxHeight:"120px",borderRadius:"8px",objectFit:"cover"}})})]}),e("div",{className:"form-group",children:[e("label",{htmlFor:"tags",children:"Tags"}),e("input",{id:"tags",type:"text",value:r.tags,onChange:l=>N("tags",l.target.value),placeholder:"tag1, tag2, tag3",className:"form-input"}),e("small",{style:{color:"var(--text-secondary)",fontSize:"0.8rem"},children:"Separate tags with commas"})]}),e("div",{className:"form-group",children:[e("label",{htmlFor:"meta-title",children:"SEO Title"}),e("input",{id:"meta-title",type:"text",value:r.meta_title,onChange:l=>N("meta_title",l.target.value),placeholder:"SEO optimized title...",className:"form-input"})]}),e("div",{className:"form-group full-width",children:[e("label",{htmlFor:"meta-description",children:"SEO Description"}),e("textarea",{id:"meta-description",value:r.meta_description,onChange:l=>N("meta_description",l.target.value),placeholder:"SEO meta description...",className:"form-textarea",rows:"2"})]}),e("div",{className:"form-group full-width",children:[e("label",{htmlFor:"content",children:"Content *"}),d&&e("div",{style:{padding:"0.5rem",background:"var(--bg-tertiary)",borderRadius:"8px",marginBottom:"0.5rem",color:"var(--text-secondary)"},children:"Processing images... Please wait."}),e(Oe,{value:r.content,onChange:m,disabled:d}),e(He,{})]})]}),e("div",{className:"form-actions",children:[e("button",{className:"form-btn secondary",onClick:w,disabled:x,children:"Cancel"}),e("button",{className:"form-btn secondary",onClick:()=>$(!1),disabled:x||d,children:x?"Saving...":"Save Draft"}),e("button",{className:"form-btn primary",onClick:()=>$(!0),disabled:x||d,children:x?"Publishing...":"Publish"})]})]})]})})},Oe=({value:s,onChange:v,disabled:w})=>{const[_,D]=o(!1),[r,k]=o(!1),[x,C]=o(!1),[d,g]=o(""),[c,E]=o([]),[P,F]=o(!1),N=n=>{w||v(n.target.value)},m=(n,p="")=>{const b=document.getElementById("content-editor");if(!b)return;const h=b.selectionStart,S=b.selectionEnd,T=s.substring(h,S),M=s.substring(0,h)+n+T+p+s.substring(S);v(M),setTimeout(()=>{b.focus(),b.setSelectionRange(h+n.length,S+n.length)},0)},$=n=>{const p={table:`| Header 1 | Header 2 | Header 3 |
|----------|----------|----------|
| Cell 1   | Cell 2   | Cell 3   |
| Cell 4   | Cell 5   | Cell 6   |`,codeblock:'```javascript\n// Your code here\nconsole.log("Hello World!");\n```',quote:`> This is a blockquote
> It can span multiple lines`,list:`- Item 1
- Item 2
- Item 3`,numberedList:`1. First item
2. Second item
3. Third item`},b=document.getElementById("content-editor");if(!b)return;const h=b.selectionStart,S=s.substring(0,h)+p[n]+s.substring(h);v(S),setTimeout(()=>{b.focus(),b.setSelectionRange(h+p[n].length,h+p[n].length)},0)},l=async n=>{if(n.trim()){F(!0);try{const{API_BASE_URL:p}=await Be(async()=>{const{API_BASE_URL:S}=await import("./index-DJKKYvGv.js").then(T=>T.v);return{API_BASE_URL:S}},__vite__mapDeps([0,1,2])),h=await(await fetch(`${p}/tmdb/search/movie?query=${encodeURIComponent(n)}&language=en-US`)).json();E(h.results||[])}catch(p){console.error("Movie search error:",p),E([])}finally{F(!1)}}},i=n=>{const p=n.title||n.name,b=`/movie/${n.id}`,h=`[${p}](${b})`,S=document.getElementById("content-editor");if(!S)return;const T=S.selectionStart,M=s.substring(0,T)+h+s.substring(T);v(M),C(!1),g(""),E([]),setTimeout(()=>{S.focus(),S.setSelectionRange(T+h.length,T+h.length)},0)};return e("div",{className:`content-editor ${r?"fullscreen":""}`,children:[e("div",{className:"editor-toolbar",children:[e("div",{className:"toolbar-group",children:[e("button",{type:"button",className:"toolbar-btn",onClick:()=>m("**","**"),title:"Bold",children:e("span",{children:"𝐁"})}),e("button",{type:"button",className:"toolbar-btn",onClick:()=>m("*","*"),title:"Italic",children:e("span",{children:"𝐼"})}),e("button",{type:"button",className:"toolbar-btn",onClick:()=>m("`","`"),title:"Inline Code",children:e("span",{children:"</>"})})]}),e("div",{className:"toolbar-divider"}),e("div",{className:"toolbar-group",children:[e("button",{type:"button",className:"toolbar-btn",onClick:()=>m("# "),title:"Heading 1",children:e("span",{children:"H1"})}),e("button",{type:"button",className:"toolbar-btn",onClick:()=>m("## "),title:"Heading 2",children:e("span",{children:"H2"})}),e("button",{type:"button",className:"toolbar-btn",onClick:()=>m("### "),title:"Heading 3",children:e("span",{children:"H3"})})]}),e("div",{className:"toolbar-divider"}),e("div",{className:"toolbar-group",children:[e("button",{type:"button",className:"toolbar-btn",onClick:()=>m("[","](url)"),title:"Link",children:e("span",{children:"🔗"})}),e("button",{type:"button",className:"toolbar-btn",onClick:()=>C(!0),title:"Add Movie Link",children:e("span",{children:"🎬"})}),e("button",{type:"button",className:"toolbar-btn",onClick:()=>m("![alt](",")"),title:"Image",children:e("span",{children:"🖼️"})}),e("button",{type:"button",className:"toolbar-btn",onClick:()=>$("quote"),title:"Quote",children:e("span",{children:"❝"})})]}),e("div",{className:"toolbar-divider"}),e("div",{className:"toolbar-group",children:[e("button",{type:"button",className:"toolbar-btn",onClick:()=>$("list"),title:"Bullet List",children:e("span",{children:"•"})}),e("button",{type:"button",className:"toolbar-btn",onClick:()=>$("numberedList"),title:"Numbered List",children:e("span",{children:"1."})}),e("button",{type:"button",className:"toolbar-btn",onClick:()=>$("table"),title:"Table",children:e("span",{children:"⊞"})}),e("button",{type:"button",className:"toolbar-btn",onClick:()=>$("codeblock"),title:"Code Block",children:e("span",{})})]}),e("div",{className:"toolbar-divider"}),e("div",{className:"toolbar-group",children:e("button",{type:"button",className:"toolbar-btn",onClick:()=>k(!r),title:"Toggle Fullscreen",children:e("span",{children:r?"⤓":"⤢"})})}),e("div",{className:"toolbar-divider"}),e("button",{type:"button",className:`toolbar-btn ${_?"active":""}`,onClick:()=>D(!_),title:"Toggle Preview",children:[e("span",{children:_?"✏️":"👁️"}),e("span",{children:_?"Edit":"Preview"})]})]}),e("div",{className:"editor-content",children:_?e("div",{className:"editor-preview",dangerouslySetInnerHTML:{__html:(n=>n?n.replace(/```([\s\S]*?)```/g,"<pre><code>$1</code></pre>").replace(/`([^`]+)`/g,"<code>$1</code>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/^#### (.*$)/gim,"<h4>$1</h4>").replace(/^### (.*$)/gim,"<h3>$1</h3>").replace(/^## (.*$)/gim,"<h2>$1</h2>").replace(/^# (.*$)/gim,"<h1>$1</h1>").replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>').replace(/!\[([^\]]*)\]\(([^)]+)\)/g,'<img src="$2" alt="$1" style="max-width: 100%; height: auto;" />').replace(/^> (.*$)/gim,"<blockquote>$1</blockquote>").replace(/^- (.*$)/gim,"<li>$1</li>").replace(/(<li>.*<\/li>)/s,"<ul>$1</ul>").replace(/^\d+\. (.*$)/gim,"<li>$1</li>").replace(/^---$/gim,"<hr>").replace(/\n/g,"<br>"):"")(s)}}):e("textarea",{id:"content-editor",className:"editor-textarea",value:s,onChange:N,disabled:w,placeholder:"Write your blog post content in Markdown...\\n\\n# Example Heading\\n\\nThis is a paragraph with **bold** and *italic* text.\\n\\n- Bullet point 1\\n- Bullet point 2\\n\\n```javascript\\nconst example = 'code block';\\n```\\n\\n> This is a blockquote"})}),x&&e("div",{className:"movie-search-modal",children:e("div",{className:"movie-search-content",children:[e("div",{className:"movie-search-header",children:[e("h3",{children:"🎬 Search Movies"}),e("button",{className:"close-btn",onClick:()=>{C(!1),g(""),E([])},children:"×"})]}),e("div",{className:"movie-search-form",children:[e("input",{type:"text",placeholder:"Search for a movie...",value:d,onChange:n=>g(n.target.value),onKeyPress:n=>{n.key==="Enter"&&l(d)},autoFocus:!0}),e("button",{onClick:()=>l(d),disabled:P||!d.trim(),children:P?"Searching...":"Search"})]}),e("div",{className:"movie-search-results",children:[P&&e("div",{className:"loading-message",children:"Searching movies..."}),c.length>0&&e("div",{className:"movie-results-list",children:c.map(n=>e("div",{className:"movie-result-item",onClick:()=>i(n),children:[e("div",{className:"movie-poster",children:n.poster_path?e("img",{src:`https://image.tmdb.org/t/p/w92${n.poster_path}`,alt:n.title}):e("div",{className:"no-poster",children:"🎬"})}),e("div",{className:"movie-info",children:[e("h4",{children:n.title}),e("p",{className:"movie-year",children:n.release_date?new Date(n.release_date).getFullYear():"Unknown"}),e("p",{className:"movie-overview",children:n.overview?n.overview.substring(0,150)+"...":"No description available"})]})]},n.id))}),!P&&d&&c.length===0&&e("div",{className:"no-results",children:"No movies found. Try a different search term."})]})]})})]})},He=()=>{const[s,v]=o(!1);return e("div",{className:"markdown-guide",children:[e("button",{type:"button",className:"guide-toggle",onClick:()=>v(!s),children:"📖 Markdown Guide"}),s&&e("div",{className:"guide-content",children:[e("h3",{children:"Markdown Quick Reference"}),e("div",{className:"guide-grid",children:[e("div",{className:"guide-item",children:[e("strong",{children:"Headers:"}),e("code",{children:"# H1 ## H2 ### H3"})]}),e("div",{className:"guide-item",children:[e("strong",{children:"Emphasis:"}),e("code",{children:"**bold** *italic*"})]}),e("div",{className:"guide-item",children:[e("strong",{children:"Links:"}),e("code",{children:"[text](url)"})]}),e("div",{className:"guide-item",children:[e("strong",{children:"Images:"}),e("code",{children:"![alt](url)"})]}),e("div",{className:"guide-item",children:[e("strong",{children:"Code:"}),e("code",{children:"`inline` ```block```"})]}),e("div",{className:"guide-item",children:[e("strong",{children:"Lists:"}),e("code",{children:"- item or 1. item"})]}),e("div",{className:"guide-item",children:[e("strong",{children:"Quote:"}),e("code",{children:"> blockquote"})]}),e("div",{className:"guide-item",children:[e("strong",{children:"Table:"}),e("code",{children:"| col1 | col2 |"})]})]})]})]})},qe=({isOpen:s,onClose:v,posts:w})=>{const[_,D]=o("json"),[r,k]=o([]),[x,C]=o(!1);U(()=>{s&&(k([]),C(!1))},[s]);const d=async()=>{C(!0);try{const g=r.length>0?w.filter($=>r.includes($.id)):w;let c,E,P;switch(_){case"json":c=JSON.stringify(g,null,2),E=`blog-posts-${new Date().toISOString().split("T")[0]}.json`,P="application/json";break;case"csv":const $=["Title","Slug","Status","Category","Created","Updated"],l=g.map(i=>[i.title||"",i.slug||"",i.status||"",i.category_name||"Uncategorized",i.created_at||"",i.updated_at||""]);c=[$,...l].map(i=>i.map(y=>`"${String(y).replace(/"/g,'""')}"`).join(",")).join(`
`),E=`blog-posts-${new Date().toISOString().split("T")[0]}.csv`,P="text/csv";break;case"markdown":c=g.map(i=>`# ${i.title||"Untitled"}

**Status:** ${i.status||"draft"}
**Created:** ${i.created_at||"Unknown"}
**Category:** ${i.category_name||"Uncategorized"}

${i.excerpt?`**Excerpt:** ${i.excerpt}

`:""}${i.content||"No content"}

---

`).join(""),E=`blog-posts-${new Date().toISOString().split("T")[0]}.md`,P="text/markdown";break}const F=new Blob([c],{type:P}),N=URL.createObjectURL(F),m=document.createElement("a");m.href=N,m.download=E,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(N),v()}catch(g){console.error("Export failed:",g),alert("Export failed: "+g.message)}finally{C(!1)}};return s?e("div",{className:"export-modal",children:e("div",{className:"export-content",children:[e("div",{className:"export-header",children:[e("h3",{children:"Export Blog Posts"}),e("button",{className:"close-btn",onClick:v,children:"×"})]}),e("div",{className:"export-form",children:[e("div",{className:"form-group",children:[e("label",{children:"Export Format:"}),e("select",{value:_,onChange:g=>D(g.target.value),className:"form-select",children:[e("option",{value:"json",children:"JSON"}),e("option",{value:"csv",children:"CSV"}),e("option",{value:"markdown",children:"Markdown"})]})]}),e("div",{className:"form-group",children:[e("label",{children:"Posts to Export:"}),e("div",{className:"export-options",children:[e("label",{className:"checkbox-label",children:[e("input",{type:"radio",name:"exportSelection",checked:r.length===0,onChange:()=>k([])}),"All Posts (",w.length,")"]}),e("label",{className:"checkbox-label",children:[e("input",{type:"radio",name:"exportSelection",checked:r.length>0,onChange:()=>k(w.map(g=>g.id))}),"Selected Posts"]})]})]}),e("div",{className:"export-actions",children:[e("button",{className:"form-btn secondary",onClick:v,disabled:x,children:"Cancel"}),e("button",{className:"form-btn primary",onClick:d,disabled:x,children:x?"Exporting...":"Export"})]})]})]})}):null};export{We as default};
//# sourceMappingURL=BlogAdmin-RNCIa1Mu.js.map
