{"version":3,"file":"AdminSetup-CKKOh8qi.js","sources":["../../src/pages/AdminSetup.jsx"],"sourcesContent":["import { useState, useEffect } from 'preact/hooks';\nimport { route } from 'preact-router';\nimport { supabase } from '../supabase';\nimport { useAuth } from '../context/Auth';\n\nconst AdminSetup = () => {\n  const { user } = useAuth();\n  const [loading, setLoading] = useState(false);\n  const [status, setStatus] = useState('');\n  const [userProfile, setUserProfile] = useState(null);\n\n  useEffect(() => {\n    if (!user) {\n      route('/login', true);\n      return;\n    }\n    checkUserStatus();\n  }, [user]);\n\n  const checkUserStatus = async () => {\n    try {\n      setLoading(true);\n      const { data, error } = await supabase\n        .from('profiles')\n        .select('*')\n        .eq('id', user.id)\n        .single();\n\n      if (error && error.code !== 'PGRST116') {\n        console.error('Error checking user status:', error);\n        setStatus(`Error: ${error.message}`);\n        return;\n      }\n\n      setUserProfile(data);\n      if (data) {\n        setStatus(`User found: ${data.email} - Admin: ${data.is_admin ? 'Yes' : 'No'}`);\n      } else {\n        setStatus('User profile not found in database');\n      }\n    } catch (error) {\n      console.error('Error:', error);\n      setStatus(`Error: ${error.message}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const makeUserAdmin = async () => {\n    try {\n      setLoading(true);\n      \n      const profileData = {\n        id: user.id,\n        email: user.email,\n        is_admin: true,\n        updated_at: new Date().toISOString()\n      };\n\n      const { data, error } = await supabase\n        .from('profiles')\n        .upsert(profileData)\n        .select()\n        .single();\n\n      if (error) {\n        console.error('Error making user admin:', error);\n        setStatus(`Error: ${error.message}`);\n        return;\n      }\n\n      setUserProfile(data);\n      setStatus('Successfully set user as admin!');\n    } catch (error) {\n      console.error('Error:', error);\n      setStatus(`Error: ${error.message}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const signOut = async () => {\n    await supabase.auth.signOut();\n    route('/login', true);\n  };\n\n  if (!user) {\n    return <div>Please log in first.</div>;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-md mx-auto bg-white rounded-lg shadow-md p-6\">\n        <h1 className=\"text-2xl font-bold text-gray-900 mb-6\">Admin Setup</h1>\n        \n        <div className=\"space-y-4\">\n          <div>\n            <h2 className=\"text-lg font-semibold text-gray-700\">Current User</h2>\n            <p className=\"text-gray-600\">Email: {user.email}</p>\n            <p className=\"text-gray-600\">ID: {user.id}</p>\n          </div>\n\n          <div>\n            <h2 className=\"text-lg font-semibold text-gray-700\">Status</h2>\n            <p className={`text-sm ${status.includes('Error') ? 'text-red-600' : 'text-green-600'}`}>\n              {status || 'Checking...'}\n            </p>\n          </div>\n\n          <div className=\"space-y-2\">\n            <button\n              onClick={checkUserStatus}\n              disabled={loading}\n              className=\"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50\"\n            >\n              {loading ? 'Checking...' : 'Check User Status'}\n            </button>\n\n            <button\n              onClick={makeUserAdmin}\n              disabled={loading}\n              className=\"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 disabled:opacity-50\"\n            >\n              {loading ? 'Processing...' : 'Make User Admin'}\n            </button>\n\n            <button\n              onClick={signOut}\n              className=\"w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700\"\n            >\n              Sign Out\n            </button>\n          </div>\n\n          <div className=\"mt-6 p-4 bg-gray-50 rounded-md\">\n            <h3 className=\"text-sm font-semibold text-gray-700 mb-2\">Instructions:</h3>\n            <ol className=\"text-xs text-gray-600 space-y-1\">\n              <li>1. Check your current user status</li>\n              <li>2. If you're not an admin, click \"Make User Admin\"</li>\n              <li>3. Go to <a href=\"/blog-admin\" className=\"text-blue-600 hover:underline\">/blog-admin</a> to manage posts</li>\n            </ol>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AdminSetup;"],"names":["AdminSetup","user","useAuth","loading","setLoading","useState","status","setStatus","userProfile","setUserProfile","useEffect","route","checkUserStatus","data","error","supabase","makeUserAdmin","profileData","signOut","jsxs","jsx"],"mappings":"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"}