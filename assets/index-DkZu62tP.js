(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();var Bt,x,Ui,Di,Ge,ss,Ni,Li,Mi,$n,sn,on,Fi,Ut={},Bi=[],Wa=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Ht=Array.isArray;function Ae(r,e){for(var t in e)r[t]=e[t];return r}function kn(r){r&&r.parentNode&&r.parentNode.removeChild(r)}function V(r,e,t){var n,s,i,o={};for(i in e)i=="key"?n=e[i]:i=="ref"?s=e[i]:o[i]=e[i];if(arguments.length>2&&(o.children=arguments.length>3?Bt.call(arguments,2):t),typeof r=="function"&&r.defaultProps!=null)for(i in r.defaultProps)o[i]===void 0&&(o[i]=r.defaultProps[i]);return Pt(r,o,n,s,null)}function Pt(r,e,t,n,s){var i={type:r,props:e,key:t,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++Ui,__i:-1,__u:0};return s==null&&x.vnode!=null&&x.vnode(i),i}function Pn(){return{current:null}}function de(r){return r.children}function pe(r,e){this.props=r,this.context=e}function ht(r,e){if(e==null)return r.__?ht(r.__,r.__i+1):null;for(var t;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null)return t.__e;return typeof r.type=="function"?ht(r):null}function Hi(r){var e,t;if((r=r.__)!=null&&r.__c!=null){for(r.__e=r.__c.base=null,e=0;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null){r.__e=r.__c.base=t.__e;break}return Hi(r)}}function an(r){(!r.__d&&(r.__d=!0)&&Ge.push(r)&&!gr.__r++||ss!=x.debounceRendering)&&((ss=x.debounceRendering)||Ni)(gr)}function gr(){for(var r,e,t,n,s,i,o,a=1;Ge.length;)Ge.length>a&&Ge.sort(Li),r=Ge.shift(),a=Ge.length,r.__d&&(t=void 0,s=(n=(e=r).__v).__e,i=[],o=[],e.__P&&((t=Ae({},n)).__v=n.__v+1,x.vnode&&x.vnode(t),An(e.__P,t,n,e.__n,e.__P.namespaceURI,32&n.__u?[s]:null,i,s??ht(n),!!(32&n.__u),o),t.__v=n.__v,t.__.__k[t.__i]=t,Gi(i,t,o),t.__e!=s&&Hi(t)));gr.__r=0}function qi(r,e,t,n,s,i,o,a,l,u,d){var c,f,h,v,m,_,b=n&&n.__k||Bi,y=e.length;for(l=Ga(t,e,b,l,y),c=0;c<y;c++)(h=t.__k[c])!=null&&(f=h.__i==-1?Ut:b[h.__i]||Ut,h.__i=c,_=An(r,h,f,s,i,o,a,l,u,d),v=h.__e,h.ref&&f.ref!=h.ref&&(f.ref&&On(f.ref,null,h),d.push(h.ref,h.__c||v,h)),m==null&&v!=null&&(m=v),4&h.__u||f.__k===h.__k?l=Wi(h,l,r):typeof h.type=="function"&&_!==void 0?l=_:v&&(l=v.nextSibling),h.__u&=-7);return t.__e=m,l}function Ga(r,e,t,n,s){var i,o,a,l,u,d=t.length,c=d,f=0;for(r.__k=new Array(s),i=0;i<s;i++)(o=e[i])!=null&&typeof o!="boolean"&&typeof o!="function"?(l=i+f,(o=r.__k[i]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?Pt(null,o,null,null,null):Ht(o)?Pt(de,{children:o},null,null,null):o.constructor==null&&o.__b>0?Pt(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=r,o.__b=r.__b+1,a=null,(u=o.__i=za(o,t,l,c))!=-1&&(c--,(a=t[u])&&(a.__u|=2)),a==null||a.__v==null?(u==-1&&(s>d?f--:s<d&&f++),typeof o.type!="function"&&(o.__u|=4)):u!=l&&(u==l-1?f--:u==l+1?f++:(u>l?f--:f++,o.__u|=4))):r.__k[i]=null;if(c)for(i=0;i<d;i++)(a=t[i])!=null&&!(2&a.__u)&&(a.__e==n&&(n=ht(a)),Ji(a,a));return n}function Wi(r,e,t){var n,s;if(typeof r.type=="function"){for(n=r.__k,s=0;n&&s<n.length;s++)n[s]&&(n[s].__=r,e=Wi(n[s],e,t));return e}r.__e!=e&&(e&&r.type&&!t.contains(e)&&(e=ht(r)),t.insertBefore(r.__e,e||null),e=r.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function be(r,e){return e=e||[],r==null||typeof r=="boolean"||(Ht(r)?r.some(function(t){be(t,e)}):e.push(r)),e}function za(r,e,t,n){var s,i,o=r.key,a=r.type,l=e[t];if(l===null&&r.key==null||l&&o==l.key&&a==l.type&&!(2&l.__u))return t;if(n>(l!=null&&!(2&l.__u)?1:0))for(s=t-1,i=t+1;s>=0||i<e.length;){if(s>=0){if((l=e[s])&&!(2&l.__u)&&o==l.key&&a==l.type)return s;s--}if(i<e.length){if((l=e[i])&&!(2&l.__u)&&o==l.key&&a==l.type)return i;i++}}return-1}function is(r,e,t){e[0]=="-"?r.setProperty(e,t??""):r[e]=t==null?"":typeof t!="number"||Wa.test(e)?t:t+"px"}function ir(r,e,t,n,s){var i,o;e:if(e=="style")if(typeof t=="string")r.style.cssText=t;else{if(typeof n=="string"&&(r.style.cssText=n=""),n)for(e in n)t&&e in t||is(r.style,e,"");if(t)for(e in t)n&&t[e]==n[e]||is(r.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")i=e!=(e=e.replace(Mi,"$1")),o=e.toLowerCase(),e=o in r||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),r.l||(r.l={}),r.l[e+i]=t,t?n?t.u=n.u:(t.u=$n,r.addEventListener(e,i?on:sn,i)):r.removeEventListener(e,i?on:sn,i);else{if(s=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in r)try{r[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?r.removeAttribute(e):r.setAttribute(e,e=="popover"&&t==1?"":t))}}function os(r){return function(e){if(this.l){var t=this.l[e.type+r];if(e.t==null)e.t=$n++;else if(e.t<t.u)return;return t(x.event?x.event(e):e)}}}function An(r,e,t,n,s,i,o,a,l,u){var d,c,f,h,v,m,_,b,y,w,A,O,E,q,$,j,W,N=e.type;if(e.constructor!=null)return null;128&t.__u&&(l=!!(32&t.__u),i=[a=e.__e=t.__e]),(d=x.__b)&&d(e);e:if(typeof N=="function")try{if(b=e.props,y="prototype"in N&&N.prototype.render,w=(d=N.contextType)&&n[d.__c],A=d?w?w.props.value:d.__:n,t.__c?_=(c=e.__c=t.__c).__=c.__E:(y?e.__c=c=new N(b,A):(e.__c=c=new pe(b,A),c.constructor=N,c.render=Va),w&&w.sub(c),c.props=b,c.state||(c.state={}),c.context=A,c.__n=n,f=c.__d=!0,c.__h=[],c._sb=[]),y&&c.__s==null&&(c.__s=c.state),y&&N.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=Ae({},c.__s)),Ae(c.__s,N.getDerivedStateFromProps(b,c.__s))),h=c.props,v=c.state,c.__v=e,f)y&&N.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),y&&c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(y&&N.getDerivedStateFromProps==null&&b!==h&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(b,A),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(b,c.__s,A)===!1||e.__v==t.__v){for(e.__v!=t.__v&&(c.props=b,c.state=c.__s,c.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(Q){Q&&(Q.__=e)}),O=0;O<c._sb.length;O++)c.__h.push(c._sb[O]);c._sb=[],c.__h.length&&o.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(b,c.__s,A),y&&c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(h,v,m)})}if(c.context=A,c.props=b,c.__P=r,c.__e=!1,E=x.__r,q=0,y){for(c.state=c.__s,c.__d=!1,E&&E(e),d=c.render(c.props,c.state,c.context),$=0;$<c._sb.length;$++)c.__h.push(c._sb[$]);c._sb=[]}else do c.__d=!1,E&&E(e),d=c.render(c.props,c.state,c.context),c.state=c.__s;while(c.__d&&++q<25);c.state=c.__s,c.getChildContext!=null&&(n=Ae(Ae({},n),c.getChildContext())),y&&!f&&c.getSnapshotBeforeUpdate!=null&&(m=c.getSnapshotBeforeUpdate(h,v)),j=d,d!=null&&d.type===de&&d.key==null&&(j=zi(d.props.children)),a=qi(r,Ht(j)?j:[j],e,t,n,s,i,o,a,l,u),c.base=e.__e,e.__u&=-161,c.__h.length&&o.push(c),_&&(c.__E=c.__=null)}catch(Q){if(e.__v=null,l||i!=null)if(Q.then){for(e.__u|=l?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;i[i.indexOf(a)]=null,e.__e=a}else for(W=i.length;W--;)kn(i[W]);else e.__e=t.__e,e.__k=t.__k;x.__e(Q,e,t)}else i==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):a=e.__e=Ja(t.__e,e,t,n,s,i,o,l,u);return(d=x.diffed)&&d(e),128&e.__u?void 0:a}function Gi(r,e,t){for(var n=0;n<t.length;n++)On(t[n],t[++n],t[++n]);x.__c&&x.__c(e,r),r.some(function(s){try{r=s.__h,s.__h=[],r.some(function(i){i.call(s)})}catch(i){x.__e(i,s.__v)}})}function zi(r){return typeof r!="object"||r==null||r.__b&&r.__b>0?r:Ht(r)?r.map(zi):Ae({},r)}function Ja(r,e,t,n,s,i,o,a,l){var u,d,c,f,h,v,m,_=t.props,b=e.props,y=e.type;if(y=="svg"?s="http://www.w3.org/2000/svg":y=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),i!=null){for(u=0;u<i.length;u++)if((h=i[u])&&"setAttribute"in h==!!y&&(y?h.localName==y:h.nodeType==3)){r=h,i[u]=null;break}}if(r==null){if(y==null)return document.createTextNode(b);r=document.createElementNS(s,y,b.is&&b),a&&(x.__m&&x.__m(e,i),a=!1),i=null}if(y==null)_===b||a&&r.data==b||(r.data=b);else{if(i=i&&Bt.call(r.childNodes),_=t.props||Ut,!a&&i!=null)for(_={},u=0;u<r.attributes.length;u++)_[(h=r.attributes[u]).name]=h.value;for(u in _)if(h=_[u],u!="children"){if(u=="dangerouslySetInnerHTML")c=h;else if(!(u in b)){if(u=="value"&&"defaultValue"in b||u=="checked"&&"defaultChecked"in b)continue;ir(r,u,null,h,s)}}for(u in b)h=b[u],u=="children"?f=h:u=="dangerouslySetInnerHTML"?d=h:u=="value"?v=h:u=="checked"?m=h:a&&typeof h!="function"||_[u]===h||ir(r,u,h,_[u],s);if(d)a||c&&(d.__html==c.__html||d.__html==r.innerHTML)||(r.innerHTML=d.__html),e.__k=[];else if(c&&(r.innerHTML=""),qi(e.type=="template"?r.content:r,Ht(f)?f:[f],e,t,n,y=="foreignObject"?"http://www.w3.org/1999/xhtml":s,i,o,i?i[0]:t.__k&&ht(t,0),a,l),i!=null)for(u=i.length;u--;)kn(i[u]);a||(u="value",y=="progress"&&v==null?r.removeAttribute("value"):v!=null&&(v!==r[u]||y=="progress"&&!v||y=="option"&&v!=_[u])&&ir(r,u,v,_[u],s),u="checked",m!=null&&m!=r[u]&&ir(r,u,m,_[u],s))}return r}function On(r,e,t){try{if(typeof r=="function"){var n=typeof r.__u=="function";n&&r.__u(),n&&e==null||(r.__u=r(e))}else r.current=e}catch(s){x.__e(s,t)}}function Ji(r,e,t){var n,s;if(x.unmount&&x.unmount(r),(n=r.ref)&&(n.current&&n.current!=r.__e||On(n,null,e)),(n=r.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(i){x.__e(i,e)}n.base=n.__P=null}if(n=r.__k)for(s=0;s<n.length;s++)n[s]&&Ji(n[s],e,t||typeof r.type!="function");t||kn(r.__e),r.__c=r.__=r.__e=void 0}function Va(r,e,t){return this.constructor(r,t)}function Ye(r,e,t){var n,s,i,o;e==document&&(e=document.documentElement),x.__&&x.__(r,e),s=(n=typeof t=="function")?null:t&&t.__k||e.__k,i=[],o=[],An(e,r=(!n&&t||e).__k=V(de,null,[r]),s||Ut,Ut,e.namespaceURI,!n&&t?[t]:s?null:e.firstChild?Bt.call(e.childNodes):null,i,!n&&t?t:s?s.__e:e.firstChild,n,o),Gi(i,r,o)}function Rn(r,e){Ye(r,e,Rn)}function jn(r,e,t){var n,s,i,o,a=Ae({},r.props);for(i in r.type&&r.type.defaultProps&&(o=r.type.defaultProps),e)i=="key"?n=e[i]:i=="ref"?s=e[i]:a[i]=e[i]===void 0&&o!=null?o[i]:e[i];return arguments.length>2&&(a.children=arguments.length>3?Bt.call(arguments,2):t),Pt(r.type,a,n||r.key,s||r.ref,null)}function qt(r){function e(t){var n,s;return this.getChildContext||(n=new Set,(s={})[e.__c]=this,this.getChildContext=function(){return s},this.componentWillUnmount=function(){n=null},this.shouldComponentUpdate=function(i){this.props.value!=i.value&&n.forEach(function(o){o.__e=!0,an(o)})},this.sub=function(i){n.add(i);var o=i.componentWillUnmount;i.componentWillUnmount=function(){n&&n.delete(i),o&&o.call(i)}}),t.children}return e.__c="__cC"+Fi++,e.__=r,e.Provider=e.__l=(e.Consumer=function(t,n){return t.children(n)}).contextType=e,e}Bt=Bi.slice,x={__e:function(r,e,t,n){for(var s,i,o;e=e.__;)if((s=e.__c)&&!s.__)try{if((i=s.constructor)&&i.getDerivedStateFromError!=null&&(s.setState(i.getDerivedStateFromError(r)),o=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(r,n||{}),o=s.__d),o)return s.__E=s}catch(a){r=a}throw r}},Ui=0,Di=function(r){return r!=null&&r.constructor==null},pe.prototype.setState=function(r,e){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Ae({},this.state),typeof r=="function"&&(r=r(Ae({},t),this.props)),r&&Ae(t,r),r!=null&&this.__v&&(e&&this._sb.push(e),an(this))},pe.prototype.forceUpdate=function(r){this.__v&&(this.__e=!0,r&&this.__h.push(r),an(this))},pe.prototype.render=de,Ge=[],Ni=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Li=function(r,e){return r.__v.__b-e.__v.__b},gr.__r=0,Mi=/(PointerCapture)$|Capture$/i,$n=0,sn=os(!1),on=os(!0),Fi=0;const Ka=Object.freeze(Object.defineProperty({__proto__:null,Component:pe,Fragment:de,cloneElement:jn,createContext:qt,createElement:V,createRef:Pn,h:V,hydrate:Rn,get isValidElement(){return Di},get options(){return x},render:Ye,toChildArray:be},Symbol.toStringTag,{value:"Module"}));var Br;function F(r,e){return x.__a&&x.__a(e),r}(Br=typeof globalThis<"u"?globalThis:typeof window<"u"?window:void 0)!=null&&Br.__PREACT_DEVTOOLS__&&Br.__PREACT_DEVTOOLS__.attachPreact("10.26.9",x,{Fragment:de,Component:pe});var Ce,K,Hr,as,ft=0,Vi=[],X=x,ls=X.__b,cs=X.__r,us=X.diffed,ds=X.__c,hs=X.unmount,fs=X.__;function Qe(r,e){X.__h&&X.__h(K,r,ft||e),ft=0;var t=K.__H||(K.__H={__:[],__h:[]});return r>=t.__.length&&t.__.push({}),t.__[r]}function U(r){return ft=1,kr(Ki,r)}function kr(r,e,t){var n=Qe(Ce++,2);if(n.t=r,!n.__c&&(n.__=[t?t(e):Ki(void 0,e),function(a){var l=n.__N?n.__N[0]:n.__[0],u=n.t(l,a);l!==u&&(n.__N=[u,n.__[1]],n.__c.setState({}))}],n.__c=K,!K.__f)){var s=function(a,l,u){if(!n.__c.__H)return!0;var d=n.__c.__H.__.filter(function(f){return!!f.__c});if(d.every(function(f){return!f.__N}))return!i||i.call(this,a,l,u);var c=n.__c.props!==a;return d.forEach(function(f){if(f.__N){var h=f.__[0];f.__=f.__N,f.__N=void 0,h!==f.__[0]&&(c=!0)}}),i&&i.call(this,a,l,u)||c};K.__f=!0;var i=K.shouldComponentUpdate,o=K.componentWillUpdate;K.componentWillUpdate=function(a,l,u){if(this.__e){var d=i;i=void 0,s(a,l,u),i=d}o&&o.call(this,a,l,u)},K.shouldComponentUpdate=s}return n.__N||n.__}function ne(r,e){var t=Qe(Ce++,3);!X.__s&&Un(t.__H,e)&&(t.__=r,t.u=e,K.__H.__h.push(t))}function mt(r,e){var t=Qe(Ce++,4);!X.__s&&Un(t.__H,e)&&(t.__=r,t.u=e,K.__h.push(t))}function Wt(r){return ft=5,Gt(function(){return{current:r}},[])}function xn(r,e,t){ft=6,mt(function(){if(typeof r=="function"){var n=r(e());return function(){r(null),n&&typeof n=="function"&&n()}}if(r)return r.current=e(),function(){return r.current=null}},t==null?t:t.concat(r))}function Gt(r,e){var t=Qe(Ce++,7);return Un(t.__H,e)&&(t.__=r(),t.__H=e,t.__h=r),t.__}function pt(r,e){return ft=8,Gt(function(){return r},e)}function Pr(r){var e=K.context[r.__c],t=Qe(Ce++,9);return t.c=r,e?(t.__==null&&(t.__=!0,e.sub(K)),e.props.value):r.__}function Cn(r,e){X.useDebugValue&&X.useDebugValue(e?e(r):r)}function Ya(r){var e=Qe(Ce++,10),t=U();return e.__=r,K.componentDidCatch||(K.componentDidCatch=function(n,s){e.__&&e.__(n,s),t[1](n)}),[t[0],function(){t[1](void 0)}]}function In(){var r=Qe(Ce++,11);if(!r.__){for(var e=K.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var t=e.__m||(e.__m=[0,0]);r.__="P"+t[0]+"-"+t[1]++}return r.__}function Qa(){for(var r;r=Vi.shift();)if(r.__P&&r.__H)try{r.__H.__h.forEach(hr),r.__H.__h.forEach(ln),r.__H.__h=[]}catch(e){r.__H.__h=[],X.__e(e,r.__v)}}X.__b=function(r){K=null,ls&&ls(r)},X.__=function(r,e){r&&e.__k&&e.__k.__m&&(r.__m=e.__k.__m),fs&&fs(r,e)},X.__r=function(r){cs&&cs(r),Ce=0;var e=(K=r.__c).__H;e&&(Hr===K?(e.__h=[],K.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(e.__h.forEach(hr),e.__h.forEach(ln),e.__h=[],Ce=0)),Hr=K},X.diffed=function(r){us&&us(r);var e=r.__c;e&&e.__H&&(e.__H.__h.length&&(Vi.push(e)!==1&&as===X.requestAnimationFrame||((as=X.requestAnimationFrame)||Xa)(Qa)),e.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.u=void 0})),Hr=K=null},X.__c=function(r,e){e.some(function(t){try{t.__h.forEach(hr),t.__h=t.__h.filter(function(n){return!n.__||ln(n)})}catch(n){e.some(function(s){s.__h&&(s.__h=[])}),e=[],X.__e(n,t.__v)}}),ds&&ds(r,e)},X.unmount=function(r){hs&&hs(r);var e,t=r.__c;t&&t.__H&&(t.__H.__.forEach(function(n){try{hr(n)}catch(s){e=s}}),t.__H=void 0,e&&X.__e(e,t.__v))};var ps=typeof requestAnimationFrame=="function";function Xa(r){var e,t=function(){clearTimeout(n),ps&&cancelAnimationFrame(e),setTimeout(r)},n=setTimeout(t,35);ps&&(e=requestAnimationFrame(t))}function hr(r){var e=K,t=r.__c;typeof t=="function"&&(r.__c=void 0,t()),K=e}function ln(r){var e=K;r.__c=r.__(),K=e}function Un(r,e){return!r||r.length!==e.length||e.some(function(t,n){return t!==r[n]})}function Ki(r,e){return typeof e=="function"?e(r):e}var Za={};function $t(r,e){for(var t in e)r[t]=e[t];return r}function el(r,e,t){var n,s=/(?:\?([^#]*))?(#.*)?$/,i=r.match(s),o={};if(i&&i[1])for(var a=i[1].split("&"),l=0;l<a.length;l++){var u=a[l].split("=");o[decodeURIComponent(u[0])]=decodeURIComponent(u.slice(1).join("="))}r=cn(r.replace(s,"")),e=cn(e||"");for(var d=Math.max(r.length,e.length),c=0;c<d;c++)if(e[c]&&e[c].charAt(0)===":"){var f=e[c].replace(/(^:|[+*?]+$)/g,""),h=(e[c].match(/[+*?]+$/)||Za)[0]||"",v=~h.indexOf("+"),m=~h.indexOf("*"),_=r[c]||"";if(!_&&!m&&(h.indexOf("?")<0||v)){n=!1;break}if(o[f]=decodeURIComponent(_),v||m){o[f]=r.slice(c).map(decodeURIComponent).join("/");break}}else if(e[c]!==r[c]){n=!1;break}return(t.default===!0||n!==!1)&&o}function tl(r,e){return r.rank<e.rank?1:r.rank>e.rank?-1:r.index-e.index}function rl(r,e){return r.index=e,r.rank=function(t){return t.props.default?0:cn(t.props.path).map(nl).join("")}(r),r.props}function cn(r){return r.replace(/(^\/+|\/+$)/g,"").split("/")}function nl(r){return r.charAt(0)==":"?1+"*+?".indexOf(r.charAt(r.length-1))||4:5}var sl={},Ve=[],_s=[],ge=null,Yi={url:Dn()},il=qt(Yi);function Dn(){var r;return""+((r=ge&&ge.location?ge.location:ge&&ge.getCurrentLocation?ge.getCurrentLocation():typeof location<"u"?location:sl).pathname||"")+(r.search||"")}function _t(r,e){return e===void 0&&(e=!1),typeof r!="string"&&r.url&&(e=r.replace,r=r.url),function(t){for(var n=Ve.length;n--;)if(Ve[n].canRoute(t))return!0;return!1}(r)&&function(t,n){n===void 0&&(n="push"),ge&&ge[n]?ge[n](t):typeof history<"u"&&history[n+"State"]&&history[n+"State"](null,null,t)}(r,e?"replace":"push"),Qi(r)}function Qi(r){for(var e=!1,t=0;t<Ve.length;t++)Ve[t].routeTo(r)&&(e=!0);return e}function ol(r){if(r&&r.getAttribute){var e=r.getAttribute("href"),t=r.getAttribute("target");if(e&&e.match(/^\//g)&&(!t||t.match(/^_?self$/i)))return _t(e)}}function al(r){return r.stopImmediatePropagation&&r.stopImmediatePropagation(),r.stopPropagation&&r.stopPropagation(),r.preventDefault(),!1}function Xi(r){if(!(r.ctrlKey||r.metaKey||r.altKey||r.shiftKey||r.button)){var e=r.target;do if(e.localName==="a"&&e.getAttribute("href")){if(e.hasAttribute("data-native")||e.hasAttribute("native"))return;if(ol(e))return al(r)}while(e=e.parentNode)}}var vs=!1;function Zi(r){r.history&&(ge=r.history),this.state={url:r.url||Dn()}}$t(Zi.prototype=new pe,{shouldComponentUpdate:function(r){return r.static!==!0||r.url!==this.props.url||r.onChange!==this.props.onChange},canRoute:function(r){var e=be(this.props.children);return this.g(e,r)!==void 0},routeTo:function(r){this.setState({url:r});var e=this.canRoute(r);return this.p||this.forceUpdate(),e},componentWillMount:function(){this.p=!0},componentDidMount:function(){var r=this;vs||(vs=!0,ge||addEventListener("popstate",function(){Qi(Dn())}),addEventListener("click",Xi)),Ve.push(this),ge&&(this.u=ge.listen(function(e){var t=e.location||e;r.routeTo(""+(t.pathname||"")+(t.search||""))})),this.p=!1},componentWillUnmount:function(){typeof this.u=="function"&&this.u(),Ve.splice(Ve.indexOf(this),1)},componentWillUpdate:function(){this.p=!0},componentDidUpdate:function(){this.p=!1},g:function(r,e){r=r.filter(rl).sort(tl);for(var t=0;t<r.length;t++){var n=r[t],s=el(e,n.props.path,n.props);if(s)return[n,s]}},render:function(r,e){var t,n,s=r.onChange,i=e.url,o=this.c,a=this.g(be(r.children),i);if(a&&(n=jn(a[0],$t($t({url:i,matches:t=a[1]},t),{key:void 0,ref:void 0}))),i!==(o&&o.url)){$t(Yi,o=this.c={url:i,previous:o&&o.url,current:n,path:n?n.props.path:null,matches:t}),o.router=this,o.active=n?[n]:[];for(var l=_s.length;l--;)_s[l]({});typeof s=="function"&&s(o)}return V(il.Provider,{value:o},n)}});var He=function(r){return V("a",$t({onClick:Xi},r))};function yr(){return yr=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},yr.apply(null,arguments)}var ct;(function(r){r.Pop="POP",r.Push="PUSH",r.Replace="REPLACE"})(ct||(ct={}));var gs=function(r){return r},ys="beforeunload",ll="hashchange",cl="popstate";function ul(r){r===void 0&&(r={});var e=r,t=e.window,n=t===void 0?document.defaultView:t,s=n.history;function i(){var $=ws(n.location.hash.substr(1)),j=$.pathname,W=j===void 0?"/":j,N=$.search,Q=N===void 0?"":N,ce=$.hash,ye=ce===void 0?"":ce,_e=s.state||{};return[_e.idx,gs({pathname:W,search:Q,hash:ye,state:_e.usr||null,key:_e.key||"default"})]}var o=null;function a(){if(o)h.call(o),o=null;else{var $=ct.Pop,j=i(),W=j[0],N=j[1];if(h.length){if(W!=null){var Q=d-W;Q&&(o={action:$,location:N,retry:function(){E(Q*-1)}},E(Q))}}else w($)}}n.addEventListener(cl,a),n.addEventListener(ll,function(){var $=i(),j=$[1];qr(j)!==qr(c)&&a()});var l=ct.Pop,u=i(),d=u[0],c=u[1],f=bs(),h=bs();d==null&&(d=0,s.replaceState(yr({},s.state,{idx:d}),""));function v(){var $=document.querySelector("base"),j="";if($&&$.getAttribute("href")){var W=n.location.href,N=W.indexOf("#");j=N===-1?W:W.slice(0,N)}return j}function m($){return v()+"#"+(typeof $=="string"?$:qr($))}function _($,j){return j===void 0&&(j=null),gs(yr({pathname:c.pathname,hash:"",search:""},typeof $=="string"?ws($):$,{state:j,key:dl()}))}function b($,j){return[{usr:$.state,key:$.key,idx:j},m($)]}function y($,j,W){return!h.length||(h.call({action:$,location:j,retry:W}),!1)}function w($){l=$;var j=i();d=j[0],c=j[1],f.call({action:l,location:c})}function A($,j){var W=ct.Push,N=_($,j);function Q(){A($,j)}if(y(W,N,Q)){var ce=b(N,d+1),ye=ce[0],_e=ce[1];try{s.pushState(ye,"",_e)}catch{n.location.assign(_e)}w(W)}}function O($,j){var W=ct.Replace,N=_($,j);function Q(){O($,j)}if(y(W,N,Q)){var ce=b(N,d),ye=ce[0],_e=ce[1];s.replaceState(ye,"",_e),w(W)}}function E($){s.go($)}var q={get action(){return l},get location(){return c},createHref:m,push:A,replace:O,go:E,back:function(){E(-1)},forward:function(){E(1)},listen:function(j){return f.push(j)},block:function(j){var W=h.push(j);return h.length===1&&n.addEventListener(ys,ms),function(){W(),h.length||n.removeEventListener(ys,ms)}}};return q}function ms(r){r.preventDefault(),r.returnValue=""}function bs(){var r=[];return{get length(){return r.length},push:function(t){return r.push(t),function(){r=r.filter(function(n){return n!==t})}},call:function(t){r.forEach(function(n){return n&&n(t)})}}}function dl(){return Math.random().toString(36).substr(2,8)}function qr(r){var e=r.pathname,t=e===void 0?"/":e,n=r.search,s=n===void 0?"":n,i=r.hash,o=i===void 0?"":i;return s&&s!=="?"&&(t+=s.charAt(0)==="?"?s:"?"+s),o&&o!=="#"&&(t+=o.charAt(0)==="#"?o:"#"+o),t}function ws(r){var e={};if(r){var t=r.indexOf("#");t>=0&&(e.hash=r.substr(t),r=r.substr(0,t));var n=r.indexOf("?");n>=0&&(e.search=r.substr(n),r=r.substr(0,n)),r&&(e.pathname=r)}return e}const hl="modulepreload",fl=function(r){return"/"+r},Ss={},zt=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(t.map(l=>{if(l=fl(l),l in Ss)return;Ss[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const c=document.createElement("link");if(c.rel=u?"stylesheet":hl,u||(c.as="script"),c.crossOrigin="",c.href=l,a&&c.setAttribute("nonce",a),document.head.appendChild(c),u)return new Promise((f,h)=>{c.addEventListener("load",f),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},pl=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>zt(async()=>{const{default:n}=await Promise.resolve().then(()=>bt);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};class Nn extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class _l extends Nn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Es extends Nn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ts extends Nn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var un;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(un||(un={}));var vl=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};class gl{constructor(e,{headers:t={},customFetch:n,region:s=un.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=pl(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n;return vl(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=t;let a={},{region:l}=t;l||(l=this.region);const u=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,u.searchParams.set("forceFunctionRegion",l));let d;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",d=o):typeof o=="string"?(a["Content-Type"]="text/plain",d=o):typeof FormData<"u"&&o instanceof FormData?d=o:(a["Content-Type"]="application/json",d=JSON.stringify(o)));const c=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:d}).catch(m=>{throw new _l(m)}),f=c.headers.get("x-relay-error");if(f&&f==="true")throw new Es(c);if(!c.ok)throw new Ts(c);let h=((n=c.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),v;return h==="application/json"?v=yield c.json():h==="application/octet-stream"?v=yield c.blob():h==="text/event-stream"?v=c:h==="multipart/form-data"?v=yield c.formData():v=yield c.text(),{data:v,error:null,response:c}}catch(s){return{data:null,error:s,response:s instanceof Ts||s instanceof Es?s.context:void 0}}})}}var we=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function eo(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Ln(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var s=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:function(){return r[n]}})}),t}var fe={},Mn={},Ar={},Jt={},Or={},Rr={},yl=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},vt=yl();const ml=vt.fetch,to=vt.fetch.bind(vt),ro=vt.Headers,bl=vt.Request,wl=vt.Response,bt=Object.freeze(Object.defineProperty({__proto__:null,Headers:ro,Request:bl,Response:wl,default:to,fetch:ml},Symbol.toStringTag,{value:"Module"})),Sl=Ln(bt);var jr={};Object.defineProperty(jr,"__esModule",{value:!0});let El=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};jr.default=El;var no=we&&we.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Rr,"__esModule",{value:!0});const Tl=no(Sl),$l=no(jr);let kl=class{constructor(e){var t,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(n=e.isMaybeSingle)!==null&&n!==void 0?n:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Tl.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,a,l,u;let d=null,c=null,f=null,h=i.status,v=i.statusText;if(i.ok){if(this.method!=="HEAD"){const y=await i.text();y===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?c=y:c=JSON.parse(y))}const _=(a=this.headers.get("Prefer"))===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),b=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");_&&b&&b.length>1&&(f=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(d={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,f=null,h=406,v="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const _=await i.text();try{d=JSON.parse(_),Array.isArray(d)&&i.status===404&&(c=[],d=null,h=200,v="OK")}catch{i.status===404&&_===""?(h=204,v="No Content"):d={message:_}}if(d&&this.isMaybeSingle&&(!((u=d==null?void 0:d.details)===null||u===void 0)&&u.includes("0 rows"))&&(d=null,h=200,v="OK"),d&&this.shouldThrowOnError)throw new $l.default(d)}return{error:d,data:c,count:f,status:h,statusText:v}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,a,l;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(a=i==null?void 0:i.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}};Rr.default=kl;var Pl=we&&we.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Or,"__esModule",{value:!0});const Al=Pl(Rr);let Ol=class extends Al.default{select(e){let t=!1;const n=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:n=t}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var a;const l=[e?"analyze":null,t?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${u}"; options=${l};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};Or.default=Ol;var Rl=we&&we.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Jt,"__esModule",{value:!0});const jl=Rl(Or);let xl=class extends jl.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const n=Array.from(new Set(t)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${i}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,n])=>{this.url.searchParams.append(t,`eq.${n}`)}),this}not(e,t,n){return this.url.searchParams.append(e,`not.${t}.${n}`),this}or(e,{foreignTable:t,referencedTable:n=t}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,n){return this.url.searchParams.append(e,`${t}.${n}`),this}};Jt.default=xl;var Cl=we&&we.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ar,"__esModule",{value:!0});const Tt=Cl(Jt);let Il=class{constructor(e,{headers:t={},schema:n,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=n,this.fetch=s}select(e,{head:t=!1,count:n}={}){const s=t?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),n&&this.headers.append("Prefer",`count=${n}`),new Tt.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:n=!0}={}){var s;const i="POST";if(t&&this.headers.append("Prefer",`count=${t}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){const a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new Tt.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){var o;const a="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),s&&this.headers.append("Prefer",`count=${s}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(l.length>0){const u=[...new Set(l)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new Tt.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:t}={}){var n;const s="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Tt.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:e}={}){var t;const n="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Tt.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}};Ar.default=Il;var so=we&&we.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Mn,"__esModule",{value:!0});const Ul=so(Ar),Dl=so(Jt);let Nl=class io{constructor(e,{headers:t={},schema:n,fetch:s}={}){this.url=e,this.headers=new Headers(t),this.schemaName=n,this.fetch=s}from(e){const t=new URL(`${this.url}/${e}`);return new Ul.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new io(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:n=!1,get:s=!1,count:i}={}){var o;let a;const l=new URL(`${this.url}/rpc/${e}`);let u;n||s?(a=n?"HEAD":"GET",Object.entries(t).filter(([c,f])=>f!==void 0).map(([c,f])=>[c,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([c,f])=>{l.searchParams.append(c,f)})):(a="POST",u=t);const d=new Headers(this.headers);return i&&d.set("Prefer",`count=${i}`),new Dl.default({method:a,url:l,headers:d,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};Mn.default=Nl;var wt=we&&we.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(fe,"__esModule",{value:!0});fe.PostgrestError=fe.PostgrestBuilder=fe.PostgrestTransformBuilder=fe.PostgrestFilterBuilder=fe.PostgrestQueryBuilder=fe.PostgrestClient=void 0;const oo=wt(Mn);fe.PostgrestClient=oo.default;const ao=wt(Ar);fe.PostgrestQueryBuilder=ao.default;const lo=wt(Jt);fe.PostgrestFilterBuilder=lo.default;const co=wt(Or);fe.PostgrestTransformBuilder=co.default;const uo=wt(Rr);fe.PostgrestBuilder=uo.default;const ho=wt(jr);fe.PostgrestError=ho.default;var Ll=fe.default={PostgrestClient:oo.default,PostgrestQueryBuilder:ao.default,PostgrestFilterBuilder:lo.default,PostgrestTransformBuilder:co.default,PostgrestBuilder:uo.default,PostgrestError:ho.default};const{PostgrestClient:Ml,PostgrestQueryBuilder:y_,PostgrestFilterBuilder:m_,PostgrestTransformBuilder:b_,PostgrestBuilder:w_,PostgrestError:S_}=Ll;function Fl(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Bl=Fl(),Hl="2.11.15",ql=`realtime-js/${Hl}`,Wl="1.0.0",fo=1e4,Gl=1e3;var At;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(At||(At={}));var le;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(le||(le={}));var $e;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})($e||($e={}));var dn;(function(r){r.websocket="websocket"})(dn||(dn={}));var ze;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(ze||(ze={}));class zl{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const s=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=n.decode(e.slice(o,o+s));o=o+s;const l=n.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:u}}}class po{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Y;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(Y||(Y={}));const $s=(r,e,t={})=>{var n;const s=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((i,o)=>(i[o]=Jl(o,r,e,s),i),{})},Jl=(r,e,t,n)=>{const s=e.find(a=>a.name===r),i=s==null?void 0:s.type,o=t[r];return i&&!n.includes(i)?_o(i,o):hn(o)},_o=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return Ql(e,t)}switch(r){case Y.bool:return Vl(e);case Y.float4:case Y.float8:case Y.int2:case Y.int4:case Y.int8:case Y.numeric:case Y.oid:return Kl(e);case Y.json:case Y.jsonb:return Yl(e);case Y.timestamp:return Xl(e);case Y.abstime:case Y.date:case Y.daterange:case Y.int4range:case Y.int8range:case Y.money:case Y.reltime:case Y.text:case Y.time:case Y.timestamptz:case Y.timetz:case Y.tsrange:case Y.tstzrange:return hn(e);default:return hn(e)}},hn=r=>r,Vl=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Kl=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},Yl=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},Ql=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,n=r[t];if(r[0]==="{"&&n==="}"){let i;const o=r.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>_o(e,a))}return r},Xl=r=>typeof r=="string"?r.replace(" ","T"):r,vo=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Wr{constructor(e,t,n={},s=fo){this.channel=e,this.event=t,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ks;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(ks||(ks={}));class Ot{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ot.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=Ot.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ot.syncDiff(this.state,s,i,o),a())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,s){const i=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(i,(u,d)=>{o[u]||(l[u]=d)}),this.map(o,(u,d)=>{const c=i[u];if(c){const f=d.map(_=>_.presence_ref),h=c.map(_=>_.presence_ref),v=d.filter(_=>h.indexOf(_.presence_ref)<0),m=c.filter(_=>f.indexOf(_.presence_ref)<0);v.length>0&&(a[u]=v),m.length>0&&(l[u]=m)}else a[u]=d}),this.syncDiff(i,{joins:a,leaves:l},n,s)}static syncDiff(e,t,n,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{var u;const d=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(l),d.length>0){const c=e[a].map(h=>h.presence_ref),f=d.filter(h=>c.indexOf(h.presence_ref)<0);e[a].unshift(...f)}n(a,d,l)}),this.map(o,(a,l)=>{let u=e[a];if(!u)return;const d=l.map(c=>c.presence_ref);u=u.filter(c=>d.indexOf(c.presence_ref)<0),e[a]=u,s(a,u,l),u.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const s=e[n];return"metas"in s?t[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[n]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ps;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Ps||(Ps={}));var As;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(As||(As={}));var je;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(je||(je={}));class Fn{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=le.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Wr(this,$e.join,this.params,this.timeout),this.rejoinTimer=new po(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=le.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=le.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=le.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=le.errored,this.rejoinTimer.scheduleTimeout())}),this._on($e.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Ot(this),this.broadcastEndpointURL=vo(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==le.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(d=>e==null?void 0:e(je.CHANNEL_ERROR,d)),this._onClose(()=>e==null?void 0:e(je.CLOSED));const l={},u={broadcast:i,presence:o,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&s!==void 0?s:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:d})=>{var c;if(this.socket.setAuth(),d===void 0){e==null||e(je.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,h=(c=f==null?void 0:f.length)!==null&&c!==void 0?c:0,v=[];for(let m=0;m<h;m++){const _=f[m],{filter:{event:b,schema:y,table:w,filter:A}}=_,O=d&&d[m];if(O&&O.event===b&&O.schema===y&&O.table===w&&O.filter===A)v.push(Object.assign(Object.assign({},_),{id:O.id}));else{this.unsubscribe(),this.state=le.errored,e==null||e(je.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(je.SUBSCRIBED);return}}).receive("error",d=>{this.state=le.errored,e==null||e(je.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(je.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e,t={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=le.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger($e.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Wr(this,$e.leave,{},e),n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),o}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Wr(this,e,t,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var s,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:u,join:d}=$e;if(n&&[a,l,u,d].indexOf(o)>=0&&n!==this._joinRef())return;let f=this._onMessage(o,t,n);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(h=>{var v,m,_;return((v=h.filter)===null||v===void 0?void 0:v.event)==="*"||((_=(m=h.filter)===null||m===void 0?void 0:m.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===o}).map(h=>h.callback(f,n)):(i=this.bindings[o])===null||i===void 0||i.filter(h=>{var v,m,_,b,y,w;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in h){const A=h.id,O=(v=h.filter)===null||v===void 0?void 0:v.event;return A&&((m=t.ids)===null||m===void 0?void 0:m.includes(A))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((_=t.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const A=(y=(b=h==null?void 0:h.filter)===null||b===void 0?void 0:b.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return A==="*"||A===((w=t==null?void 0:t.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===o}).map(h=>{if(typeof f=="object"&&"ids"in f){const v=f.data,{schema:m,table:_,commit_timestamp:b,type:y,errors:w}=v;f=Object.assign(Object.assign({},{schema:m,table:_,commit_timestamp:b,eventType:y,new:{},old:{},errors:w}),this._getPayloadRecords(v))}h.callback(f,n)})}_isClosed(){return this.state===le.closed}_isJoined(){return this.state===le.joined}_isJoining(){return this.state===le.joining}_isLeaving(){return this.state===le.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Fn.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on($e.close,{},e)}_onError(e){this._on($e.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=le.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=$s(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=$s(e.columns,e.old_record)),t}}const Os=()=>{},Zl=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ec{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=fo,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Os,this.ref=0,this.logger=Os,this.conn=null,this.sendBuffer=[],this.serializer=new zl,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>zt(async()=>{const{default:l}=await Promise.resolve().then(()=>bt);return{default:l}},void 0).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${dn.websocket}`,this.httpEndpoint=vo(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(n=t==null?void 0:t.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,o)=>o(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new po(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Bl),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Wl}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case At.connecting:return ze.Connecting;case At.open:return ze.Open;case At.closing:return ze.Closing;default:return ze.Closed}}isConnected(){return this.connectionState()===ze.Open}channel(e,t={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new Fn(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:n,payload:s,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${n} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const s={access_token:t,version:ql};t&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push($e.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Gl,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:n,event:s,payload:i,ref:o}=t;n==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(a=>a._isMember(n)).forEach(a=>a._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger($e.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${n}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([Zl],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}}class Bn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ie(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class tc extends Bn{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class fn extends Bn{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var rc=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};const go=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>zt(async()=>{const{default:n}=await Promise.resolve().then(()=>bt);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},nc=()=>rc(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield zt(()=>Promise.resolve().then(()=>bt),void 0)).Response:Response}),pn=r=>{if(Array.isArray(r))return r.map(t=>pn(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,n])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=pn(n)}),e};var Xe=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};const Gr=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),sc=(r,e,t)=>Xe(void 0,void 0,void 0,function*(){const n=yield nc();r instanceof n&&!(t!=null&&t.noResolveJson)?r.json().then(s=>{e(new tc(Gr(s),r.status||500))}).catch(s=>{e(new fn(Gr(s),s))}):e(new fn(Gr(r),r))}),ic=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),t))};function Vt(r,e,t,n,s,i){return Xe(this,void 0,void 0,function*(){return new Promise((o,a)=>{r(t,ic(e,n,s,i)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>sc(l,a,n))})})}function mr(r,e,t,n){return Xe(this,void 0,void 0,function*(){return Vt(r,"GET",e,t,n)})}function De(r,e,t,n,s){return Xe(this,void 0,void 0,function*(){return Vt(r,"POST",e,n,s,t)})}function oc(r,e,t,n,s){return Xe(this,void 0,void 0,function*(){return Vt(r,"PUT",e,n,s,t)})}function ac(r,e,t,n){return Xe(this,void 0,void 0,function*(){return Vt(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function yo(r,e,t,n,s){return Xe(this,void 0,void 0,function*(){return Vt(r,"DELETE",e,n,s,t)})}var he=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};const lc={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Rs={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class cc{constructor(e,t={},n,s){this.url=e,this.headers=t,this.bucketId=n,this.fetch=go(s)}uploadOrUpdate(e,t,n,s){return he(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Rs),s);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(a=Object.assign(Object.assign({},a),s.headers));const u=this._removeEmptyFolders(t),d=this._getFinalPath(u),c=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:e,body:i,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),f=yield c.json();return c.ok?{data:{path:u,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(i){if(ie(i))return{data:null,error:i};throw i}})}upload(e,t,n){return he(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,s){return he(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let l;const u=Object.assign({upsert:Rs.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const c=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:d}),f=yield c.json();return c.ok?{data:{path:i,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(ie(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return he(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const i=yield De(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new Bn("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(n){if(ie(n))return{data:null,error:n};throw n}})}update(e,t,n){return he(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return he(this,void 0,void 0,function*(){try{return{data:yield De(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(ie(s))return{data:null,error:s};throw s}})}copy(e,t,n){return he(this,void 0,void 0,function*(){try{return{data:{path:(yield De(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(ie(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,n){return he(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield De(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(ie(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,n){return he(this,void 0,void 0,function*(){try{const s=yield De(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(ie(s))return{data:null,error:s};throw s}})}download(e,t){return he(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield mr(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(ie(a))return{data:null,error:a};throw a}})}info(e){return he(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield mr(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:pn(n),error:null}}catch(n){if(ie(n))return{data:null,error:n};throw n}})}exists(e){return he(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield ac(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(ie(n)&&n instanceof fn){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&s.push(l);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${u}`)}}}remove(e){return he(this,void 0,void 0,function*(){try{return{data:yield yo(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(ie(t))return{data:null,error:t};throw t}})}list(e,t,n){return he(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},lc),t),{prefix:e||""});return{data:yield De(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(ie(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const uc="2.7.1",dc={"X-Client-Info":`storage-js/${uc}`};var tt=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};class hc{constructor(e,t={},n){this.url=e,this.headers=Object.assign(Object.assign({},dc),t),this.fetch=go(n)}listBuckets(){return tt(this,void 0,void 0,function*(){try{return{data:yield mr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ie(e))return{data:null,error:e};throw e}})}getBucket(e){return tt(this,void 0,void 0,function*(){try{return{data:yield mr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(ie(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return tt(this,void 0,void 0,function*(){try{return{data:yield De(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ie(n))return{data:null,error:n};throw n}})}updateBucket(e,t){return tt(this,void 0,void 0,function*(){try{return{data:yield oc(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ie(n))return{data:null,error:n};throw n}})}emptyBucket(e){return tt(this,void 0,void 0,function*(){try{return{data:yield De(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(ie(t))return{data:null,error:t};throw t}})}deleteBucket(e){return tt(this,void 0,void 0,function*(){try{return{data:yield yo(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(ie(t))return{data:null,error:t};throw t}})}}class fc extends hc{constructor(e,t={},n){super(e,t,n)}from(e){return new cc(this.url,this.headers,e,this.fetch)}}const pc="2.50.4";let kt="";typeof Deno<"u"?kt="deno":typeof document<"u"?kt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?kt="react-native":kt="node";const _c={"X-Client-Info":`supabase-js-${kt}/${pc}`},vc={headers:_c},gc={schema:"public"},yc={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},mc={};var bc=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};const wc=r=>{let e;return r?e=r:typeof fetch>"u"?e=to:e=fetch,(...t)=>e(...t)},Sc=()=>typeof Headers>"u"?ro:Headers,Ec=(r,e,t)=>{const n=wc(t),s=Sc();return(i,o)=>bc(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:r;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",r),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},o),{headers:u}))})};var Tc=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};function $c(r){return r.endsWith("/")?r:r+"/"}function kc(r,e){var t,n;const{db:s,auth:i,realtime:o,global:a}=r,{db:l,auth:u,realtime:d,global:c}=e,f={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},d),o),global:Object.assign(Object.assign(Object.assign({},c),a),{headers:Object.assign(Object.assign({},(t=c==null?void 0:c.headers)!==null&&t!==void 0?t:{}),(n=a==null?void 0:a.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>Tc(this,void 0,void 0,function*(){return""})};return r.accessToken?f.accessToken=r.accessToken:delete f.accessToken,f}const mo="2.70.0",at=30*1e3,_n=3,zr=_n*at,Pc="http://localhost:9999",Ac="supabase.auth.token",Oc={"X-Client-Info":`gotrue-js/${mo}`},vn="X-Supabase-Api-Version",bo={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Rc=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,jc=6e5;class Hn extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function I(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class xc extends Hn{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function Cc(r){return I(r)&&r.name==="AuthApiError"}class wo extends Hn{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Me extends Hn{constructor(e,t,n,s){super(e,n,s),this.name=t,this.status=n}}class Ue extends Me{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ic(r){return I(r)&&r.name==="AuthSessionMissingError"}class or extends Me{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ar extends Me{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class lr extends Me{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Uc(r){return I(r)&&r.name==="AuthImplicitGrantRedirectError"}class js extends Me{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class gn extends Me{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Jr(r){return I(r)&&r.name==="AuthRetryableFetchError"}class xs extends Me{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class Rt extends Me{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const br="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Cs=` 	
\r=`.split(""),Dc=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<Cs.length;e+=1)r[Cs[e].charCodeAt(0)]=-2;for(let e=0;e<br.length;e+=1)r[br[e].charCodeAt(0)]=e;return r})();function Is(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(br[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(br[n]),e.queuedBits-=6}}function So(r,e,t){const n=Dc[r];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function Us(r){const e=[],t=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{Mc(o,n,t)};for(let o=0;o<r.length;o+=1)So(r.charCodeAt(o),s,i);return e.join("")}function Nc(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function Lc(r,e){for(let t=0;t<r.length;t+=1){let n=r.charCodeAt(t);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(r.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}Nc(n,e)}}function Mc(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let n=1;n<6;n+=1)if(!(r>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Fc(r){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<r.length;s+=1)So(r.charCodeAt(s),t,n);return new Uint8Array(e)}function Bc(r){const e=[];return Lc(r,t=>e.push(t)),new Uint8Array(e)}function Hc(r){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};return r.forEach(s=>Is(s,t,n)),Is(null,t,n),e.join("")}function qc(r){return Math.round(Date.now()/1e3)+r}function Wc(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const Te=()=>typeof window<"u"&&typeof document<"u",qe={tested:!1,writable:!1},jt=()=>{if(!Te())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(qe.tested)return qe.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),qe.tested=!0,qe.writable=!0}catch{qe.tested=!0,qe.writable=!1}return qe.writable};function Gc(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((n,s)=>{e[s]=n}),e}const Eo=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>zt(async()=>{const{default:n}=await Promise.resolve().then(()=>bt);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},zc=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",To=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},cr=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ur=async(r,e)=>{await r.removeItem(e)};class xr{constructor(){this.promise=new xr.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}xr.promiseConstructor=Promise;function Vr(r){const e=r.split(".");if(e.length!==3)throw new Rt("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!Rc.test(e[n]))throw new Rt("JWT not in base64url format");return{header:JSON.parse(Us(e[0])),payload:JSON.parse(Us(e[1])),signature:Fc(e[2]),raw:{header:e[0],payload:e[1]}}}async function Jc(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Vc(r,e){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await r(i);if(!e(i,null,o)){n(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function Kc(r){return("0"+r.toString(16)).substr(-2)}function Yc(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,Kc).join("")}async function Qc(r){const t=new TextEncoder().encode(r),n=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function Xc(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Qc(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function rt(r,e,t=!1){const n=Yc();let s=n;t&&(s+="/PASSWORD_RECOVERY"),await To(r,`${e}-code-verifier`,s);const i=await Xc(n);return[i,n===i?"plain":"s256"]}const Zc=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function eu(r){const e=r.headers.get(vn);if(!e||!e.match(Zc))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function tu(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function ru(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const nu=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function nt(r){if(!nu.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var su=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t};const We=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),iu=[502,503,504];async function Ds(r){var e;if(!zc(r))throw new gn(We(r),0);if(iu.includes(r.status))throw new gn(We(r),r.status);let t;try{t=await r.json()}catch(i){throw new wo(We(i),i)}let n;const s=eu(r);if(s&&s.getTime()>=bo["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new xs(We(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Ue}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new xs(We(t),r.status,t.weak_password.reasons);throw new xc(We(t),r.status||500,n)}const ou=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),t))};async function M(r,e,t,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[vn]||(i[vn]=bo["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await au(r,e,t+a,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function au(r,e,t,n,s,i){const o=ou(e,n,s,i);let a;try{a=await r(t,Object.assign({},o))}catch(l){throw console.error(l),new gn(We(l),0)}if(a.ok||await Ds(a),n!=null&&n.noResolveJson)return a;try{return await a.json()}catch(l){await Ds(l)}}function Re(r){var e;let t=null;du(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=qc(r.expires_in)));const n=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:n},error:null}}function Ns(r){const e=Re(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=r.weak_password),e}function Ne(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function lu(r){return{data:r,error:null}}function cu(r){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:i}=r,o=su(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function uu(r){return r}function du(r){return r.access_token&&r.refresh_token&&r.expires_in}const Kr=["global","local","others"];var hu=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t};class fu{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=Eo(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Kr[0]){if(Kr.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Kr.join(", ")}`);try{return await M(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(I(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await M(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Ne})}catch(n){if(I(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=hu(e,["options"]),s=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await M(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:cu,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(I(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await M(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ne})}catch(t){if(I(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,s,i,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},d=await M(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:uu});if(d.error)throw d.error;const c=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(l=(a=d.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(v=>{const m=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(v.split(";")[1].split("=")[1]);u[`${_}Page`]=m}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},c),u),error:null}}catch(u){if(I(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){nt(e);try{return await M(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ne})}catch(t){if(I(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){nt(e);try{return await M(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Ne})}catch(n){if(I(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){nt(e);try{return await M(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Ne})}catch(n){if(I(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){nt(e.userId);try{const{data:t,error:n}=await M(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:n}}catch(t){if(I(t))return{data:null,error:t};throw t}}async _deleteFactor(e){nt(e.userId),nt(e.id);try{return{data:await M(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(I(t))return{data:null,error:t};throw t}}}const pu={getItem:r=>jt()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{jt()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{jt()&&globalThis.localStorage.removeItem(r)}};function Ls(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function _u(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const st={debug:!!(globalThis&&jt()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class $o extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class vu extends $o{}async function gu(r,e,t){st.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),st.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){st.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,s.name);try{return await t()}finally{st.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,s.name)}}else{if(e===0)throw st.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new vu(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(st.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}_u();const yu={url:Pc,storageKey:Ac,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Oc,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ms(r,e,t){return await t()}class Dt{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Dt.nextInstanceID,Dt.nextInstanceID+=1,this.instanceID>0&&Te()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},yu),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new fu({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Eo(s.fetch),this.lock=s.lock||Ms,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Te()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=gu:this.lock=Ms,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:jt()?this.storage=pu:(this.memoryStorage={},this.storage=Ls(this.memoryStorage)):(this.memoryStorage={},this.storage=Ls(this.memoryStorage)),Te()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${mo}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Gc(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),Te()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Uc(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return I(t)?{error:t}:{error:new wo("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,s;try{const i=await M(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:Re}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(I(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,n,s;try{let i;if("email"in e){const{email:d,password:c,options:f}=e;let h=null,v=null;this.flowType==="pkce"&&([h,v]=await rt(this.storage,this.storageKey)),i=await M(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:c,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:h,code_challenge_method:v},xform:Re})}else if("phone"in e){const{phone:d,password:c,options:f}=e;i=await M(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:c,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Re})}else throw new ar("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(I(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:a}=e;t=await M(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Ns})}else if("phone"in e){const{phone:i,password:o,options:a}=e;t=await M(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Ns})}else throw new ar("You must provide either an email or phone number and a password");const{data:n,error:s}=t;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new or}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(t){if(I(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,n,s,i,o,a,l,u,d,c,f,h;let v,m;if("message"in e)v=e.message,m=e.signature;else{const{chain:_,wallet:b,statement:y,options:w}=e;let A;if(Te())if(typeof b=="object")A=b;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))A=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");A=b}const O=new URL((t=w==null?void 0:w.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in A&&A.signIn){const E=await A.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),y?{statement:y}:null));let q;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")q=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)q=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in q&&"signature"in q&&(typeof q.signedMessage=="string"||q.signedMessage instanceof Uint8Array)&&q.signature instanceof Uint8Array)v=typeof q.signedMessage=="string"?q.signedMessage:new TextDecoder().decode(q.signedMessage),m=q.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in A)||typeof A.signMessage!="function"||!("publicKey"in A)||typeof A!="object"||!A.publicKey||!("toBase58"in A.publicKey)||typeof A.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${O.host} wants you to sign in with your Solana account:`,A.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(s=(n=w==null?void 0:w.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((u=w==null?void 0:w.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((c=(d=w==null?void 0:w.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||c===void 0)&&c.length?["Resources",...w.signInWithSolana.resources.map(q=>`- ${q}`)]:[]].join(`
`);const E=await A.signMessage(new TextEncoder().encode(v),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=E}}try{const{data:_,error:b}=await M(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Hc(m)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=e.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Re});if(b)throw b;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new or}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:b})}catch(_){if(I(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(e){const t=await cr(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(t??"").split("/");try{const{data:i,error:o}=await M(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Re});if(await ur(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new or}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(I(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:n,token:s,access_token:i,nonce:o}=e,a=await M(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Re}),{data:l,error:u}=a;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new or}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(t){if(I(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,s,i,o;try{if("email"in e){const{email:a,options:l}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await rt(this.storage,this.storageKey));const{error:c}=await M(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:c}}if("phone"in e){const{phone:a,options:l}=e,{data:u,error:d}=await M(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new ar("You must provide either an email or phone number.")}catch(a){if(I(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,n;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:a}=await M(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Re});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(I(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,n,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await rt(this.storage,this.storageKey)),await M(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:lu})}catch(i){if(I(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Ue;const{error:s}=await M(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(I(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:i}=e,{error:o}=await M(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:s,options:i}=e,{data:o,error:a}=await M(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new ar("You must provide either an email or phone number and a type")}catch(t){if(I(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await cr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<zr:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,d)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,d))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await M(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ne}):await this._useSession(async t=>{var n,s,i;const{data:o,error:a}=t;if(a)throw a;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ue}:await M(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Ne})})}catch(t){if(I(t))return Ic(t)&&(await this._removeSession(),await ur(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Ue;const o=s.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await rt(this.storage,this.storageKey));const{data:u,error:d}=await M(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Ne});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(I(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ue;const t=Date.now()/1e3;let n=t,s=!0,i=null;const{payload:o}=Vr(e.access_token);if(o.exp&&(n=o.exp,s=n<=t),s){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(I(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:o,error:a}=t;if(a)throw a;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Ue;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(I(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Te())throw new lr("No browser detected.");if(e.error||e.error_description||e.error_code)throw new lr(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new js("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new lr("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new js("No code detected.");const{data:y,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const A=new URL(window.location.href);return A.searchParams.delete("code"),window.history.replaceState(window.history.state,"",A.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:u}=e;if(!i||!a||!o||!u)throw new lr("No session defined in URL");const d=Math.round(Date.now()/1e3),c=parseInt(a);let f=d+c;l&&(f=parseInt(l));const h=f-d;h*1e3<=at&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${c}s`);const v=f-c;d-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,f,d):d-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,f,d);const{data:m,error:_}=await this._getUser(i);if(_)throw _;const b={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:c,expires_at:f,refresh_token:o,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(n){if(I(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await cr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:s,error:i}=t;if(i)return{error:i};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(Cc(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await ur(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Wc(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,s;try{const{data:{session:i},error:o}=t;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await rt(this.storage,this.storageKey,!0));try{return await M(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(I(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(I(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:s}=await this._useSession(async i=>{var o,a,l,u,d;const{data:c,error:f}=i;if(f)throw f;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await M(this.fetch,"GET",h,{headers:this.headers,jwt:(d=(u=c.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return Te()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(I(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,s;const{data:i,error:o}=t;if(o)throw o;return await M(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(I(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await Vc(async s=>(s>0&&await Jc(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await M(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Re})),(s,i)=>{const o=200*Math.pow(2,s);return i&&Jr(i)&&Date.now()+o-n<at})}catch(n){if(this._debug(t,"error",n),I(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),Te()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await cr(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n)){this._debug(t,"session is not valid"),n!==null&&await this._removeSession();return}const s=((e=n.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<zr;if(this._debug(t,`session has${s?"":" not"} expired with margin of ${zr}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),Jr(i)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(t,"error",n),console.error(n);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Ue;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new xr;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Ue;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(s,"error",i),I(i)){const o={session:null,error:i};return Jr(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await To(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await ur(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Te()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),at);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/at);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${at}ms, refresh threshold is ${_n} ticks`),s<=_n&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof $o)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Te()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const s=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await rt(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;return i?{data:null,error:i}:await M(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(I(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,s;const{data:i,error:o}=t;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await M(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(I(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:a}=await M(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(t){if(I(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;return i?{data:null,error:i}:await M(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(I(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(e==null?void 0:e.factors)||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Vr(s.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((n=(t=s.user.factors)===null||t===void 0?void 0:t.filter(c=>c.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const d=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(o=>o.kid===e);if(n||(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+jc>Date.now()))return n;const{data:s,error:i}=await M(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new Rt("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(o=>o.kid===e),!n)throw new Rt("No matching signing key found in JWKS");return n}async getClaims(e,t={keys:[]}){try{let n=e;if(!n){const{data:h,error:v}=await this.getSession();if(v||!h.session)return{data:null,error:v};n=h.session.access_token}const{header:s,payload:i,signature:o,raw:{header:a,payload:l}}=Vr(n);if(tu(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:i,header:s,signature:o},error:null}}const u=ru(s.alg),d=await this.fetchJwk(s.kid,t),c=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,c,o,Bc(`${a}.${l}`)))throw new Rt("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(n){if(I(n))return{data:null,error:n};throw n}}}Dt.nextInstanceID=0;const mu=Dt;class bu extends mu{constructor(e){super(e)}}var wu=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};class Su{constructor(e,t,n){var s,i,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=$c(e),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:gc,realtime:mc,auth:Object.assign(Object.assign({},yc),{storageKey:u}),global:vc},c=kc(n??{},d);this.storageKey=(s=c.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=c.global.headers)!==null&&i!==void 0?i:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=c.auth)!==null&&o!==void 0?o:{},this.headers,c.global.fetch),this.fetch=Ec(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new Ml(new URL("rest/v1",l).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),c.accessToken||this._listenForAuthEvents()}get functions(){return new gl(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new fc(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return wu(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,storageKey:i,flowType:o,lock:a,debug:l},u,d){const c={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new bu({url:this.authUrl.href,headers:Object.assign(Object.assign({},c),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,flowType:o,lock:a,debug:l,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new ec(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Eu=(r,e,t)=>new Su(r,e,t),Tu="https://symlpvgdqnmccllwwejt.supabase.co",$u="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5bWxwdmdkcW5tY2NsbHd3ZWp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIxMzI4MjMsImV4cCI6MjA2NzcwODgyM30.O6gqcY6Mzl1XAtn9blKGx4m142p3vJynmr18kNDA9T8",ae=Eu(Tu,$u);var ku=0;function p(r,e,t,n,s,i){e||(e={});var o,a,l=e;if("ref"in l)for(a in l={},e)a=="ref"?o=e[a]:l[a]=e[a];var u={type:r,props:l,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--ku,__i:-1,__u:0,__source:s,__self:i};if(typeof r=="function"&&(o=r.defaultProps))for(a in o)l[a]===void 0&&(l[a]=o[a]);return x.vnode&&x.vnode(u),u}const ko=qt();function Pu({children:r}){const[e,t]=F(U(null),"session"),[n,s]=F(U(null),"user"),[i,o]=F(U(!0),"loading");ne(()=>{(async()=>{const{data:{session:d}}=await ae.auth.getSession();t(d),s((d==null?void 0:d.user)??null),o(!1)})();const{data:u}=ae.auth.onAuthStateChange((d,c)=>{t(c),s((c==null?void 0:c.user)??null)});return()=>{u.subscription.unsubscribe()}},[]);const a={session:e,user:n,signOut:()=>ae.auth.signOut()};return p(ko.Provider,{value:a,children:!i&&r})}function Cr(){return Pr(ko)}function Po(r,e){for(var t in e)r[t]=e[t];return r}function yn(r,e){for(var t in r)if(t!=="__source"&&!(t in e))return!0;for(var n in e)if(n!=="__source"&&r[n]!==e[n])return!0;return!1}function qn(r,e){var t=e(),n=U({t:{__:t,u:e}}),s=n[0].t,i=n[1];return mt(function(){s.__=t,s.u=e,Yr(s)&&i({t:s})},[r,t,e]),ne(function(){return Yr(s)&&i({t:s}),r(function(){Yr(s)&&i({t:s})})},[r]),t}function Yr(r){var e,t,n=r.u,s=r.__;try{var i=n();return!((e=s)===(t=i)&&(e!==0||1/e==1/t)||e!=e&&t!=t)}catch{return!0}}function Wn(r){r()}function Gn(r){return r}function zn(){return[!1,Wn]}var Jn=mt;function wr(r,e){this.props=r,this.context=e}function Vn(r,e){function t(s){var i=this.props.ref,o=i==s.ref;return!o&&i&&(i.call?i(null):i.current=null),e?!e(this.props,s)||!o:yn(this.props,s)}function n(s){return this.shouldComponentUpdate=t,V(r,s)}return n.displayName="Memo("+(r.displayName||r.name)+")",n.prototype.isReactComponent=!0,n.__f=!0,n}(wr.prototype=new pe).isPureReactComponent=!0,wr.prototype.shouldComponentUpdate=function(r,e){return yn(this.props,r)||yn(this.state,e)};var Fs=x.__b;x.__b=function(r){r.type&&r.type.__f&&r.ref&&(r.props.ref=r.ref,r.ref=null),Fs&&Fs(r)};var Au=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Ao(r){function e(t){var n=Po({},t);return delete n.ref,r(n,t.ref||null)}return e.$$typeof=Au,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(r.displayName||r.name)+")",e}var Bs=function(r,e){return r==null?null:be(be(r).map(e))},Oo={map:Bs,forEach:Bs,count:function(r){return r?be(r).length:0},only:function(r){var e=be(r);if(e.length!==1)throw"Children.only";return e[0]},toArray:be},Ou=x.__e;x.__e=function(r,e,t,n){if(r.then){for(var s,i=e;i=i.__;)if((s=i.__c)&&s.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),s.__c(r,e)}Ou(r,e,t,n)};var Hs=x.unmount;function Ro(r,e,t){return r&&(r.__c&&r.__c.__H&&(r.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),r.__c.__H=null),(r=Po({},r)).__c!=null&&(r.__c.__P===t&&(r.__c.__P=e),r.__c.__e=!0,r.__c=null),r.__k=r.__k&&r.__k.map(function(n){return Ro(n,e,t)})),r}function jo(r,e,t){return r&&t&&(r.__v=null,r.__k=r.__k&&r.__k.map(function(n){return jo(n,e,t)}),r.__c&&r.__c.__P===e&&(r.__e&&t.appendChild(r.__e),r.__c.__e=!0,r.__c.__P=t)),r}function xt(){this.__u=0,this.o=null,this.__b=null}function xo(r){var e=r.__.__c;return e&&e.__a&&e.__a(r)}function Co(r){var e,t,n;function s(i){if(e||(e=r()).then(function(o){t=o.default||o},function(o){n=o}),n)throw n;if(!t)throw e;return V(t,i)}return s.displayName="Lazy",s.__f=!0,s}function ut(){this.i=null,this.l=null}x.unmount=function(r){var e=r.__c;e&&e.__R&&e.__R(),e&&32&r.__u&&(r.type=null),Hs&&Hs(r)},(xt.prototype=new pe).__c=function(r,e){var t=e.__c,n=this;n.o==null&&(n.o=[]),n.o.push(t);var s=xo(n.__v),i=!1,o=function(){i||(i=!0,t.__R=null,s?s(a):a())};t.__R=o;var a=function(){if(!--n.__u){if(n.state.__a){var l=n.state.__a;n.__v.__k[0]=jo(l,l.__c.__P,l.__c.__O)}var u;for(n.setState({__a:n.__b=null});u=n.o.pop();)u.forceUpdate()}};n.__u++||32&e.__u||n.setState({__a:n.__b=n.__v.__k[0]}),r.then(o,o)},xt.prototype.componentWillUnmount=function(){this.o=[]},xt.prototype.render=function(r,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=Ro(this.__b,t,n.__O=n.__P)}this.__b=null}var s=e.__a&&V(de,null,r.fallback);return s&&(s.__u&=-33),[V(de,null,e.__a?null:r.children),s]};var qs=function(r,e,t){if(++t[1]===t[0]&&r.l.delete(e),r.props.revealOrder&&(r.props.revealOrder[0]!=="t"||!r.l.size))for(t=r.i;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;r.i=t=t[2]}};function Ru(r){return this.getChildContext=function(){return r.context},r.children}function ju(r){var e=this,t=r.h;if(e.componentWillUnmount=function(){Ye(null,e.v),e.v=null,e.h=null},e.h&&e.h!==t&&e.componentWillUnmount(),!e.v){for(var n=e.__v;n!==null&&!n.__m&&n.__!==null;)n=n.__;e.h=t,e.v={nodeType:1,parentNode:t,childNodes:[],__k:{__m:n.__m},contains:function(){return!0},insertBefore:function(s,i){this.childNodes.push(s),e.h.insertBefore(s,i)},removeChild:function(s){this.childNodes.splice(this.childNodes.indexOf(s)>>>1,1),e.h.removeChild(s)}}}Ye(V(Ru,{context:e.context},r.__v),e.v)}function Io(r,e){var t=V(ju,{__v:r,h:e});return t.containerInfo=e,t}(ut.prototype=new pe).__a=function(r){var e=this,t=xo(e.__v),n=e.l.get(r);return n[0]++,function(s){var i=function(){e.props.revealOrder?(n.push(s),qs(e,r,n)):s()};t?t(i):i()}},ut.prototype.render=function(r){this.i=null,this.l=new Map;var e=be(r.children);r.revealOrder&&r.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.l.set(e[t],this.i=[1,0,this.i]);return r.children},ut.prototype.componentDidUpdate=ut.prototype.componentDidMount=function(){var r=this;this.l.forEach(function(e,t){qs(r,t,e)})};var Uo=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,xu=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Cu=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Iu=/[A-Z0-9]/g,Uu=typeof document<"u",Du=function(r){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(r)};function Do(r,e,t){return e.__k==null&&(e.textContent=""),Ye(r,e),typeof t=="function"&&t(),r?r.__c:null}function No(r,e,t){return Rn(r,e),typeof t=="function"&&t(),r?r.__c:null}pe.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(r){Object.defineProperty(pe.prototype,r,{configurable:!0,get:function(){return this["UNSAFE_"+r]},set:function(e){Object.defineProperty(this,r,{configurable:!0,writable:!0,value:e})}})});var Ws=x.event;function Nu(){}function Lu(){return this.cancelBubble}function Mu(){return this.defaultPrevented}x.event=function(r){return Ws&&(r=Ws(r)),r.persist=Nu,r.isPropagationStopped=Lu,r.isDefaultPrevented=Mu,r.nativeEvent=r};var Kn,Fu={enumerable:!1,configurable:!0,get:function(){return this.class}},Gs=x.vnode;x.vnode=function(r){typeof r.type=="string"&&function(e){var t=e.props,n=e.type,s={},i=n.indexOf("-")===-1;for(var o in t){var a=t[o];if(!(o==="value"&&"defaultValue"in t&&a==null||Uu&&o==="children"&&n==="noscript"||o==="class"||o==="className")){var l=o.toLowerCase();o==="defaultValue"&&"value"in t&&t.value==null?o="value":o==="download"&&a===!0?a="":l==="translate"&&a==="no"?a=!1:l[0]==="o"&&l[1]==="n"?l==="ondoubleclick"?o="ondblclick":l!=="onchange"||n!=="input"&&n!=="textarea"||Du(t.type)?l==="onfocus"?o="onfocusin":l==="onblur"?o="onfocusout":Cu.test(o)&&(o=l):l=o="oninput":i&&xu.test(o)?o=o.replace(Iu,"-$&").toLowerCase():a===null&&(a=void 0),l==="oninput"&&s[o=l]&&(o="oninputCapture"),s[o]=a}}n=="select"&&s.multiple&&Array.isArray(s.value)&&(s.value=be(t.children).forEach(function(u){u.props.selected=s.value.indexOf(u.props.value)!=-1})),n=="select"&&s.defaultValue!=null&&(s.value=be(t.children).forEach(function(u){u.props.selected=s.multiple?s.defaultValue.indexOf(u.props.value)!=-1:s.defaultValue==u.props.value})),t.class&&!t.className?(s.class=t.class,Object.defineProperty(s,"className",Fu)):(t.className&&!t.class||t.class&&t.className)&&(s.class=s.className=t.className),e.props=s}(r),r.$$typeof=Uo,Gs&&Gs(r)};var zs=x.__r;x.__r=function(r){zs&&zs(r),Kn=r.__c};var Js=x.diffed;x.diffed=function(r){Js&&Js(r);var e=r.props,t=r.__e;t!=null&&r.type==="textarea"&&"value"in e&&e.value!==t.value&&(t.value=e.value==null?"":e.value),Kn=null};var Lo={ReactCurrentDispatcher:{current:{readContext:function(r){return Kn.__n[r.__c].props.value},useCallback:pt,useContext:Pr,useDebugValue:Cn,useDeferredValue:Gn,useEffect:ne,useId:In,useImperativeHandle:xn,useInsertionEffect:Jn,useLayoutEffect:mt,useMemo:Gt,useReducer:kr,useRef:Wt,useState:U,useSyncExternalStore:qn,useTransition:zn}}},Bu="18.3.1";function Mo(r){return V.bind(null,r)}function Kt(r){return!!r&&r.$$typeof===Uo}function Fo(r){return Kt(r)&&r.type===de}function Bo(r){return!!r&&!!r.displayName&&(typeof r.displayName=="string"||r.displayName instanceof String)&&r.displayName.startsWith("Memo(")}function Ho(r){return Kt(r)?jn.apply(null,arguments):r}function qo(r){return!!r.__k&&(Ye(null,r),!0)}function Wo(r){return r&&(r.base||r.nodeType===1&&r)||null}var Go=function(r,e){return r(e)},zo=function(r,e){return r(e)},Jo=de,Vo=Kt,Ko={useState:U,useId:In,useReducer:kr,useEffect:ne,useLayoutEffect:mt,useInsertionEffect:Jn,useTransition:zn,useDeferredValue:Gn,useSyncExternalStore:qn,startTransition:Wn,useRef:Wt,useImperativeHandle:xn,useMemo:Gt,useCallback:pt,useContext:Pr,useDebugValue:Cn,version:"18.3.1",Children:Oo,render:Do,hydrate:No,unmountComponentAtNode:qo,createPortal:Io,createElement:V,createContext:qt,createFactory:Mo,cloneElement:Ho,createRef:Pn,Fragment:de,isValidElement:Kt,isElement:Vo,isFragment:Fo,isMemo:Bo,findDOMNode:Wo,Component:pe,PureComponent:wr,memo:Vn,forwardRef:Ao,flushSync:zo,unstable_batchedUpdates:Go,StrictMode:Jo,Suspense:xt,SuspenseList:ut,lazy:Co,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Lo};const Hu=Object.freeze(Object.defineProperty({__proto__:null,Children:Oo,Component:pe,Fragment:de,PureComponent:wr,StrictMode:Jo,Suspense:xt,SuspenseList:ut,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Lo,cloneElement:Ho,createContext:qt,createElement:V,createFactory:Mo,createPortal:Io,createRef:Pn,default:Ko,findDOMNode:Wo,flushSync:zo,forwardRef:Ao,hydrate:No,isElement:Vo,isFragment:Fo,isMemo:Bo,isValidElement:Kt,lazy:Co,memo:Vn,render:Do,startTransition:Wn,unmountComponentAtNode:qo,unstable_batchedUpdates:Go,useCallback:pt,useContext:Pr,useDebugValue:Cn,useDeferredValue:Gn,useEffect:ne,useErrorBoundary:Ya,useId:In,useImperativeHandle:xn,useInsertionEffect:Jn,useLayoutEffect:mt,useMemo:Gt,useReducer:kr,useRef:Wt,useState:U,useSyncExternalStore:qn,useTransition:zn,version:Bu},Symbol.toStringTag,{value:"Module"}));let qu={data:""},Wu=r=>typeof window=="object"?((r?r.querySelector("#_goober"):window._goober)||Object.assign((r||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:r||qu,Gu=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,zu=/\/\*[^]*?\*\/|  +/g,Vs=/\n+/g,Le=(r,e)=>{let t="",n="",s="";for(let i in r){let o=r[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":n+=i[1]=="f"?Le(o,i):i+"{"+Le(o,i[1]=="k"?"":e)+"}":typeof o=="object"?n+=Le(o,e?e.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,a):a?a+" "+l:l)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Le.p?Le.p(i,o):i+":"+o+";")}return t+(e&&s?e+"{"+s+"}":s)+n},Oe={},Yo=r=>{if(typeof r=="object"){let e="";for(let t in r)e+=t+Yo(r[t]);return e}return r},Ju=(r,e,t,n,s)=>{let i=Yo(r),o=Oe[i]||(Oe[i]=(l=>{let u=0,d=11;for(;u<l.length;)d=101*d+l.charCodeAt(u++)>>>0;return"go"+d})(i));if(!Oe[o]){let l=i!==r?r:(u=>{let d,c,f=[{}];for(;d=Gu.exec(u.replace(zu,""));)d[4]?f.shift():d[3]?(c=d[3].replace(Vs," ").trim(),f.unshift(f[0][c]=f[0][c]||{})):f[0][d[1]]=d[2].replace(Vs," ").trim();return f[0]})(r);Oe[o]=Le(s?{["@keyframes "+o]:l}:l,t?"":"."+o)}let a=t&&Oe.g?Oe.g:null;return t&&(Oe.g=Oe[o]),((l,u,d,c)=>{c?u.data=u.data.replace(c,l):u.data.indexOf(l)===-1&&(u.data=d?l+u.data:u.data+l)})(Oe[o],e,n,a),o},Vu=(r,e,t)=>r.reduce((n,s,i)=>{let o=e[i];if(o&&o.call){let a=o(t),l=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=l?"."+l:a&&typeof a=="object"?a.props?"":Le(a,""):a===!1?"":a}return n+s+(o??"")},"");function Ir(r){let e=this||{},t=r.call?r(e.p):r;return Ju(t.unshift?t.raw?Vu(t,[].slice.call(arguments,1),e.p):t.reduce((n,s)=>Object.assign(n,s&&s.call?s(e.p):s),{}):t,Wu(e.target),e.g,e.o,e.k)}let Qo,mn,bn;Ir.bind({g:1});let Ie=Ir.bind({k:1});function Ku(r,e,t,n){Le.p=e,Qo=r,mn=t,bn=n}function Fe(r,e){let t=this||{};return function(){let n=arguments;function s(i,o){let a=Object.assign({},i),l=a.className||s.className;t.p=Object.assign({theme:mn&&mn()},a),t.o=/ *go\d+/.test(l),a.className=Ir.apply(t,n)+(l?" "+l:"");let u=r;return r[0]&&(u=a.as||r,delete a.as),bn&&u[0]&&bn(a),Qo(u,a)}return s}}var Yu=r=>typeof r=="function",Sr=(r,e)=>Yu(r)?r(e):r,Qu=(()=>{let r=0;return()=>(++r).toString()})(),Xo=(()=>{let r;return()=>{if(r===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");r=!e||e.matches}return r}})(),Xu=20,Zo=(r,e)=>{switch(e.type){case 0:return{...r,toasts:[e.toast,...r.toasts].slice(0,Xu)};case 1:return{...r,toasts:r.toasts.map(i=>i.id===e.toast.id?{...i,...e.toast}:i)};case 2:let{toast:t}=e;return Zo(r,{type:r.toasts.find(i=>i.id===t.id)?1:0,toast:t});case 3:let{toastId:n}=e;return{...r,toasts:r.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return e.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(i=>i.id!==e.toastId)};case 5:return{...r,pausedAt:e.time};case 6:let s=e.time-(r.pausedAt||0);return{...r,pausedAt:void 0,toasts:r.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+s}))}}},fr=[],Je={toasts:[],pausedAt:void 0},Ze=r=>{Je=Zo(Je,r),fr.forEach(e=>{e(Je)})},Zu={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},ed=(r={})=>{let[e,t]=U(Je),n=Wt(Je);ne(()=>(n.current!==Je&&t(Je),fr.push(t),()=>{let i=fr.indexOf(t);i>-1&&fr.splice(i,1)}),[]);let s=e.toasts.map(i=>{var o,a,l;return{...r,...r[i.type],...i,removeDelay:i.removeDelay||((o=r[i.type])==null?void 0:o.removeDelay)||(r==null?void 0:r.removeDelay),duration:i.duration||((a=r[i.type])==null?void 0:a.duration)||(r==null?void 0:r.duration)||Zu[i.type],style:{...r.style,...(l=r[i.type])==null?void 0:l.style,...i.style}}});return{...e,toasts:s}},td=(r,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:r,pauseDuration:0,...t,id:(t==null?void 0:t.id)||Qu()}),Yt=r=>(e,t)=>{let n=td(e,r,t);return Ze({type:2,toast:n}),n.id},ue=(r,e)=>Yt("blank")(r,e);ue.error=Yt("error");ue.success=Yt("success");ue.loading=Yt("loading");ue.custom=Yt("custom");ue.dismiss=r=>{Ze({type:3,toastId:r})};ue.remove=r=>Ze({type:4,toastId:r});ue.promise=(r,e,t)=>{let n=ue.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof r=="function"&&(r=r()),r.then(s=>{let i=e.success?Sr(e.success,s):void 0;return i?ue.success(i,{id:n,...t,...t==null?void 0:t.success}):ue.dismiss(n),s}).catch(s=>{let i=e.error?Sr(e.error,s):void 0;i?ue.error(i,{id:n,...t,...t==null?void 0:t.error}):ue.dismiss(n)}),r};var rd=(r,e)=>{Ze({type:1,toast:{id:r,height:e}})},nd=()=>{Ze({type:5,time:Date.now()})},Ct=new Map,sd=1e3,id=(r,e=sd)=>{if(Ct.has(r))return;let t=setTimeout(()=>{Ct.delete(r),Ze({type:4,toastId:r})},e);Ct.set(r,t)},od=r=>{let{toasts:e,pausedAt:t}=ed(r);ne(()=>{if(t)return;let i=Date.now(),o=e.map(a=>{if(a.duration===1/0)return;let l=(a.duration||0)+a.pauseDuration-(i-a.createdAt);if(l<0){a.visible&&ue.dismiss(a.id);return}return setTimeout(()=>ue.dismiss(a.id),l)});return()=>{o.forEach(a=>a&&clearTimeout(a))}},[e,t]);let n=pt(()=>{t&&Ze({type:6,time:Date.now()})},[t]),s=pt((i,o)=>{let{reverseOrder:a=!1,gutter:l=8,defaultPosition:u}=o||{},d=e.filter(h=>(h.position||u)===(i.position||u)&&h.height),c=d.findIndex(h=>h.id===i.id),f=d.filter((h,v)=>v<c&&h.visible).length;return d.filter(h=>h.visible).slice(...a?[f+1]:[0,f]).reduce((h,v)=>h+(v.height||0)+l,0)},[e]);return ne(()=>{e.forEach(i=>{if(i.dismissed)id(i.id,i.removeDelay);else{let o=Ct.get(i.id);o&&(clearTimeout(o),Ct.delete(i.id))}})},[e]),{toasts:e,handlers:{updateHeight:rd,startPause:nd,endPause:n,calculateOffset:s}}},ad=Ie`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,ld=Ie`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,cd=Ie`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,ud=Fe("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${ad} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${ld} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${r=>r.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${cd} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,dd=Ie`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,hd=Fe("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${r=>r.secondary||"#e0e0e0"};
  border-right-color: ${r=>r.primary||"#616161"};
  animation: ${dd} 1s linear infinite;
`,fd=Ie`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,pd=Ie`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,_d=Fe("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${fd} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${pd} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${r=>r.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,vd=Fe("div")`
  position: absolute;
`,gd=Fe("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,yd=Ie`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,md=Fe("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${yd} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,bd=({toast:r})=>{let{icon:e,type:t,iconTheme:n}=r;return e!==void 0?typeof e=="string"?V(md,null,e):e:t==="blank"?null:V(gd,null,V(hd,{...n}),t!=="loading"&&V(vd,null,t==="error"?V(ud,{...n}):V(_d,{...n})))},wd=r=>`
0% {transform: translate3d(0,${r*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Sd=r=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${r*-150}%,-1px) scale(.6); opacity:0;}
`,Ed="0%{opacity:0;} 100%{opacity:1;}",Td="0%{opacity:1;} 100%{opacity:0;}",$d=Fe("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,kd=Fe("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Pd=(r,e)=>{let t=r.includes("top")?1:-1,[n,s]=Xo()?[Ed,Td]:[wd(t),Sd(t)];return{animation:e?`${Ie(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ie(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Ad=Vn(({toast:r,position:e,style:t,children:n})=>{let s=r.height?Pd(r.position||e||"top-center",r.visible):{opacity:0},i=V(bd,{toast:r}),o=V(kd,{...r.ariaProps},Sr(r.message,r));return V($d,{className:r.className,style:{...s,...t,...r.style}},typeof n=="function"?n({icon:i,message:o}):V(de,null,i,o))});Ku(V);var Od=({id:r,className:e,style:t,onHeightUpdate:n,children:s})=>{let i=pt(o=>{if(o){let a=()=>{let l=o.getBoundingClientRect().height;n(r,l)};a(),new MutationObserver(a).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[r,n]);return V("div",{ref:i,className:e,style:t},s)},Rd=(r,e)=>{let t=r.includes("top"),n=t?{top:0}:{bottom:0},s=r.includes("center")?{justifyContent:"center"}:r.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Xo()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...n,...s}},jd=Ir`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,dr=16,xd=({reverseOrder:r,position:e="top-center",toastOptions:t,gutter:n,children:s,containerStyle:i,containerClassName:o})=>{let{toasts:a,handlers:l}=od(t);return V("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:dr,left:dr,right:dr,bottom:dr,pointerEvents:"none",...i},className:o,onMouseEnter:l.startPause,onMouseLeave:l.endPause},a.map(u=>{let d=u.position||e,c=l.calculateOffset(u,{reverseOrder:r,gutter:n,defaultPosition:e}),f=Rd(d,c);return V(Od,{id:u.id,key:u.id,onHeightUpdate:l.updateHeight,className:u.visible?jd:"",style:f},u.type==="custom"?Sr(u.message,u):s?s(u):V(Ad,{toast:u,position:d}))}))},Er=ue;const Cd=()=>{const[r,e]=F(U(""),"query"),[t,n]=F(U(!1),"isMenuOpen"),{user:s,signOut:i}=Cr(),o=u=>{u.preventDefault(),r.trim()&&(_t(`/search?q=${encodeURIComponent(r.trim())}`),e(""))},a=async()=>{await i(),_t("/")},l=()=>{n(!t)};return p("header",{children:p("div",{class:"container",children:[p("div",{class:"header-left",children:[p(He,{href:"/",class:"logo",children:"FreeStream"}),p("nav",{class:t?"active":"",children:p("ul",{onClick:()=>n(!1),children:[p("li",{children:p(He,{activeClassName:"active",href:"/?type=movie",children:"Movies"})}),p("li",{children:p(He,{activeClassName:"active",href:"/?type=tv",children:"TV Shows"})}),p("li",{children:p(He,{activeClassName:"active",href:"/favorites",children:"Favorites"})}),p("li",{children:p(He,{activeClassName:"active",href:"/history",children:"History"})})]})})]}),p("div",{class:"header-right",children:[p("form",{class:"search-container",onSubmit:o,children:p("input",{type:"text",placeholder:"Search...",value:r,onInput:u=>e(u.target.value)})}),p("div",{class:"auth-links",children:s?p(de,{children:[p("span",{class:"user-email",children:s.email}),p("button",{onClick:a,class:"auth-button",children:"Logout"})]}):p(de,{children:[p(He,{href:"/login",class:"auth-link",children:"Login"}),p(He,{href:"/signup",class:"auth-link",children:"Sign Up"})]})})]}),p("button",{class:"hamburger",onClick:l,"aria-label":"Toggle menu",children:[p("span",{class:"bar"}),p("span",{class:"bar"}),p("span",{class:"bar"})]})]})})},Id={},Ks=r=>{let e;const t=new Set,n=(d,c)=>{const f=typeof d=="function"?d(e):d;if(!Object.is(f,e)){const h=e;e=c??(typeof f!="object"||f===null)?f:Object.assign({},e,f),t.forEach(v=>v(e,h))}},s=()=>e,l={setState:n,getState:s,getInitialState:()=>u,subscribe:d=>(t.add(d),()=>t.delete(d)),destroy:()=>{(Id?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},u=e=r(n,s,l);return l},Ud=r=>r?Ks(r):Ks;var ea={exports:{}},ta={};const ra=Ln(Hu);var na={exports:{}},sa={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gt=ra;function Dd(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var Nd=typeof Object.is=="function"?Object.is:Dd,Ld=gt.useState,Md=gt.useEffect,Fd=gt.useLayoutEffect,Bd=gt.useDebugValue;function Hd(r,e){var t=e(),n=Ld({inst:{value:t,getSnapshot:e}}),s=n[0].inst,i=n[1];return Fd(function(){s.value=t,s.getSnapshot=e,Qr(s)&&i({inst:s})},[r,t,e]),Md(function(){return Qr(s)&&i({inst:s}),r(function(){Qr(s)&&i({inst:s})})},[r]),Bd(t),t}function Qr(r){var e=r.getSnapshot;r=r.value;try{var t=e();return!Nd(r,t)}catch{return!0}}function qd(r,e){return e()}var Wd=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?qd:Hd;sa.useSyncExternalStore=gt.useSyncExternalStore!==void 0?gt.useSyncExternalStore:Wd;na.exports=sa;var Gd=na.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ur=ra,zd=Gd;function Jd(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var Vd=typeof Object.is=="function"?Object.is:Jd,Kd=zd.useSyncExternalStore,Yd=Ur.useRef,Qd=Ur.useEffect,Xd=Ur.useMemo,Zd=Ur.useDebugValue;ta.useSyncExternalStoreWithSelector=function(r,e,t,n,s){var i=Yd(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=Xd(function(){function l(h){if(!u){if(u=!0,d=h,h=n(h),s!==void 0&&o.hasValue){var v=o.value;if(s(v,h))return c=v}return c=h}if(v=c,Vd(d,h))return v;var m=n(h);return s!==void 0&&s(v,m)?(d=h,v):(d=h,c=m)}var u=!1,d,c,f=t===void 0?null:t;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,t,n,s]);var a=Kd(r,i[0],i[1]);return Qd(function(){o.hasValue=!0,o.value=a},[a]),Zd(a),a};ea.exports=ta;var eh=ea.exports;const th=eo(eh),ia={},{useDebugValue:rh}=Ko,{useSyncExternalStoreWithSelector:nh}=th;let Ys=!1;const sh=r=>r;function ih(r,e=sh,t){(ia?"production":void 0)!=="production"&&t&&!Ys&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Ys=!0);const n=nh(r.subscribe,r.getState,r.getServerState||r.getInitialState,e,t);return rh(n),n}const Qs=r=>{(ia?"production":void 0)!=="production"&&typeof r!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof r=="function"?Ud(r):r,t=(n,s)=>ih(e,n,s);return Object.assign(t,e),t},oh=r=>r?Qs(r):Qs,ah={};function lh(r,e){let t;try{t=r()}catch{return}return{getItem:s=>{var i;const o=l=>l===null?null:JSON.parse(l,void 0),a=(i=t.getItem(s))!=null?i:null;return a instanceof Promise?a.then(o):o(a)},setItem:(s,i)=>t.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>t.removeItem(s)}}const Nt=r=>e=>{try{const t=r(e);return t instanceof Promise?t:{then(n){return Nt(n)(t)},catch(n){return this}}}catch(t){return{then(n){return this},catch(n){return Nt(n)(t)}}}},ch=(r,e)=>(t,n,s)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:_=>_,version:0,merge:(_,b)=>({...b,..._}),...e},o=!1;const a=new Set,l=new Set;let u;try{u=i.getStorage()}catch{}if(!u)return r((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(..._)},n,s);const d=Nt(i.serialize),c=()=>{const _=i.partialize({...n()});let b;const y=d({state:_,version:i.version}).then(w=>u.setItem(i.name,w)).catch(w=>{b=w});if(b)throw b;return y},f=s.setState;s.setState=(_,b)=>{f(_,b),c()};const h=r((..._)=>{t(..._),c()},n,s);let v;const m=()=>{var _;if(!u)return;o=!1,a.forEach(y=>y(n()));const b=((_=i.onRehydrateStorage)==null?void 0:_.call(i,n()))||void 0;return Nt(u.getItem.bind(u))(i.name).then(y=>{if(y)return i.deserialize(y)}).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==i.version){if(i.migrate)return i.migrate(y.state,y.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return y.state}).then(y=>{var w;return v=i.merge(y,(w=n())!=null?w:h),t(v,!0),c()}).then(()=>{b==null||b(v,void 0),o=!0,l.forEach(y=>y(v))}).catch(y=>{b==null||b(void 0,y)})};return s.persist={setOptions:_=>{i={...i,..._},_.getStorage&&(u=_.getStorage())},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>m(),hasHydrated:()=>o,onHydrate:_=>(a.add(_),()=>{a.delete(_)}),onFinishHydration:_=>(l.add(_),()=>{l.delete(_)})},m(),v||h},uh=(r,e)=>(t,n,s)=>{let i={storage:lh(()=>localStorage),partialize:m=>m,version:0,merge:(m,_)=>({..._,...m}),...e},o=!1;const a=new Set,l=new Set;let u=i.storage;if(!u)return r((...m)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...m)},n,s);const d=()=>{const m=i.partialize({...n()});return u.setItem(i.name,{state:m,version:i.version})},c=s.setState;s.setState=(m,_)=>{c(m,_),d()};const f=r((...m)=>{t(...m),d()},n,s);s.getInitialState=()=>f;let h;const v=()=>{var m,_;if(!u)return;o=!1,a.forEach(y=>{var w;return y((w=n())!=null?w:f)});const b=((_=i.onRehydrateStorage)==null?void 0:_.call(i,(m=n())!=null?m:f))||void 0;return Nt(u.getItem.bind(u))(i.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==i.version){if(i.migrate)return[!0,i.migrate(y.state,y.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var w;const[A,O]=y;if(h=i.merge(O,(w=n())!=null?w:f),t(h,!0),A)return d()}).then(()=>{b==null||b(h,void 0),h=n(),o=!0,l.forEach(y=>y(h))}).catch(y=>{b==null||b(void 0,y)})};return s.persist={setOptions:m=>{i={...i,...m},m.storage&&(u=m.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:m=>(a.add(m),()=>{a.delete(m)}),onFinishHydration:m=>(l.add(m),()=>{l.delete(m)})},i.skipHydration||v(),h||f},dh=(r,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((ah?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),ch(r,e)):uh(r,e),hh=dh,Lt=oh(hh((r,e)=>({trending:[],popularMovies:[],popularTv:[],topRatedMovies:[],topRatedTv:[],favorites:[],favoritesFetched:!1,currentMediaItem:null,setCurrentMediaItem:t=>r({currentMediaItem:t}),fetchTrending:async()=>{if(!(e().trending.length>0))try{const t=await fetch("/api/tmdb/trending/all/week");if(t.ok){const n=await t.json();r({trending:n.results||[]})}}catch(t){console.error("Error fetching trending:",t)}},fetchPopularMovies:async()=>{if(!(e().popularMovies.length>0))try{const t=await fetch("/api/tmdb/movie/popular");if(t.ok){const n=await t.json();r({popularMovies:n.results||[]})}}catch(t){console.error("Error fetching popular movies:",t)}},fetchPopularTv:async()=>{if(!(e().popularTv.length>0))try{const t=await fetch("/api/tmdb/tv/popular");if(t.ok){const n=await t.json();r({popularTv:n.results||[]})}}catch(t){console.error("Error fetching popular TV:",t)}},fetchTopRatedMovies:async()=>{if(!(e().topRatedMovies.length>0))try{const t=await fetch("/api/tmdb/movie/top_rated");if(t.ok){const n=await t.json();r({topRatedMovies:n.results||[]})}}catch(t){console.error("Error fetching top rated movies:",t)}},fetchTopRatedTv:async()=>{if(!(e().topRatedTv.length>0))try{const t=await fetch("/api/tmdb/tv/top_rated");if(t.ok){const n=await t.json();r({topRatedTv:n.results||[]})}}catch(t){console.error("Error fetching top rated TV:",t)}},fetchFavorites:async()=>{const{data:{user:t}}=await ae.auth.getUser();if(!t){r({favorites:[],favoritesFetched:!0});return}const{data:n,error:s}=await ae.from("favorites").select("media_id, media_type").eq("user_id",t.id);if(s){console.error("Error fetching favorites:",s),r({favoritesFetched:!0});return}const i=await Promise.all(n.map(async o=>{const a=await fetch(`/api/tmdb/${o.media_type}/${o.media_id}`);return a.ok?{...await a.json(),type:o.media_type}:null}));r({favorites:i.filter(Boolean),favoritesFetched:!0})},addFavorite:async t=>{const{data:{user:n}}=await ae.auth.getUser();if(!n)return;r(i=>({favorites:[t,...i.favorites]}));const{error:s}=await ae.from("favorites").insert({user_id:n.id,media_id:t.id,media_type:t.type});s&&(console.error("Error adding favorite:",s),r(i=>({favorites:i.favorites.filter(o=>o.id!==t.id)})))},removeFavorite:async t=>{const{data:{user:n}}=await ae.auth.getUser();if(!n)return;const s=e().favorites;r(o=>({favorites:o.favorites.filter(a=>a.id!==t)}));const{error:i}=await ae.from("favorites").delete().match({user_id:n.id,media_id:t});i&&(console.error("Error removing favorite:",i),r({favorites:s}))},isFavorited:t=>{const{favorites:n,favoritesFetched:s}=e();return s?n.some(i=>i.id===t):!1}}),{name:"freestream-storage",getStorage:()=>localStorage,partialize:r=>({favorites:r.favorites,trending:r.trending,popularMovies:r.popularMovies,popularTv:r.popularTv,topRatedMovies:r.topRatedMovies,topRatedTv:r.topRatedTv})})),fh="https://image.tmdb.org/t/p/w500",Qt=({item:r,type:e,progress:t})=>{const n=r.poster_path&&r.poster_path!=="undefined"?`${fh}${r.poster_path}`:"https://via.placeholder.com/200x300.png?text=No+Image",s=r.title||r.name,i=r.vote_average?r.vote_average.toFixed(1):"N/A",o=`/watch?id=${r.id}&type=${e}`,{addFavorite:a,removeFavorite:l,isFavorited:u}=Lt(),d=u(r.id),c=h=>{h.preventDefault(),h.stopPropagation(),d?l(r.id):a({...r,type:e})};let f=0;return t&&t.progress_seconds&&t.duration_seconds&&(f=t.progress_seconds/t.duration_seconds*100),p("div",{class:"movie-card-container",children:[p("a",{href:o,class:"movie-card",children:[p("div",{class:"poster-wrapper",children:[p("img",{src:n,alt:s,loading:"lazy"}),f>1&&f<95&&p("div",{class:"progress-bar-container",children:p("div",{class:"progress-bar",style:{width:`${f}%`}})})]}),p("div",{class:"movie-info",children:[p("h3",{children:s}),p("span",{class:"rating",children:[" ",i]})]})]}),p("button",{class:`favorite-btn ${d?"favorited":""}`,onClick:c,children:d?"":""})]})},Dr=async()=>{const{data:{user:r}}=await ae.auth.getUser();return r==null?void 0:r.id},oa=async()=>{const r=await Dr();if(!r)return[];const{data:e,error:t}=await ae.from("watch_history").select("*").eq("user_id",r).order("watched_at",{ascending:!1});return t?(console.error("Error fetching watch history:",t),[]):e},ph=async(r,e,t,n)=>{const s=await Dr();if(!s)return null;let i=ae.from("watch_progress").select("progress_seconds, duration_seconds").eq("user_id",s).eq("media_id",r).eq("media_type",e);e!=="movie"&&(i=i.eq("season_number",t).eq("episode_number",n));const{data:o,error:a}=await i.single();return a&&a.code!=="PGRST116"&&console.error("Error fetching watch progress:",a),o},_h=async(r,e,t)=>{if(!r||typeof e>"u"||e<5)return;const n={p_media_id:r.id,p_media_type:r.type,p_season_number:r.season,p_episode_number:r.episode,p_progress_seconds:Math.round(e)};t&&(n.p_duration_seconds=t*60);const{error:s}=await ae.rpc("save_watch_progress",n);s&&console.error("Error saving watch progress:",s)},vh=async r=>{const e=await Dr();if(!e)return{};const{data:t,error:n}=await ae.from("watch_progress").select("*").eq("user_id",e).eq("media_id",r);if(n)return console.error("Error fetching series history:",n),{};const s={};return t.forEach(i=>{const o=`tv-${i.media_id}-s${i.season_number}-e${i.episode_number}`;s[o]={id:i.media_id,type:i.media_type,season:i.season_number,episode:i.episode_number,progress:i.progress_seconds,duration:i.duration_seconds}}),s},gh=async r=>{const e=await Dr();if(!e)return null;const{data:t,error:n}=await ae.from("watch_history").select("season_number, episode_number").eq("user_id",e).eq("media_id",r).order("watched_at",{ascending:!1}).limit(1).single();return n&&n.code!=="PGRST116"?(console.error("Error fetching last watched episode:",n),null):t?{season:t.season_number,episode:t.episode_number}:null},xe="/api",yh=()=>{const{trending:r,popularMovies:e,popularTv:t,topRatedMovies:n,topRatedTv:s,fetchTrending:i,fetchPopularMovies:o,fetchPopularTv:a,fetchTopRatedMovies:l,fetchTopRatedTv:u}=Lt(),[d,c]=F(U({}),"watchHistory"),[f,h]=F(U([]),"continueWatching"),[v,m]=F(U(!0),"loadingContinueWatching");ne(()=>{i(),o(),a(),l(),u()},[i,o,a,l,u]),ne(()=>{(async()=>{m(!0);const y=await oa();if(!y){m(!1);return}const w=y.reduce((O,E)=>{const q=`${E.media_type}-${E.media_id}${E.media_type!=="movie"?"-s"+E.season_number+"-e"+E.episode_number:""}`;if(O[q]=E,E.media_type==="tv"||E.media_type==="anime"){const $=`${E.media_type}-${E.id}`;(!O[$]||new Date(E.watched_at)>new Date(O[$].watched_at))&&(O[$]=E)}return O},{});c(w);const A=y.filter(O=>O.duration_seconds>0?O.progress_seconds/O.duration_seconds<.95:!0).sort((O,E)=>new Date(E.watched_at)-new Date(O.watched_at));if(A.length>0){const O=await Promise.all(A.map(async E=>{try{const q=await fetch(`${xe}/tmdb/${E.media_type}/${E.media_id}`);return q.ok?{...await q.json(),...E,type:E.media_type}:null}catch{return null}}));h(O.filter(Boolean))}else h([]);m(!1)})()},[]);const _=(b,y,w,A)=>A?p("section",{class:"home-section",children:[p("h2",{children:b}),p("div",{class:"movie-list-placeholder",children:[...Array(5)].map((O,E)=>p("div",{class:"movie-card-placeholder"},E))})]}):(!y||y.length===0)&&b!=="Continue Watching"?null:p("section",{class:"home-section",children:[p("h2",{children:b}),p("div",{class:"movie-list",children:y.map(O=>{const E=O.media_type||w;return p(Qt,{item:{...O,type:E},type:E,progress:d[`${E}-${O.id}`]||O},O.id)})})]});return p("div",{class:"container home-page",children:[p("h1",{class:"main-title",children:"Discover"}),_("Continue Watching",f,"movie",v),_("Trending This Week",r,"movie"),_("Popular Movies",e,"movie"),_("Top Rated Movies",n,"movie"),_("Popular TV Shows",t,"tv"),_("Top Rated TV Shows",s,"tv")]})};var wn={exports:{}};const aa=Ln(Ka);var Xs=aa;function mh(r,e){var t={};for(var n in r)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);return t}function bh(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function wh(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function Sh(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var Eh=function(e,t,n){if(typeof e!="function")throw new Error("Expected reducePropsToState to be a function.");if(typeof t!="function")throw new Error("Expected handleStateChangeOnClient to be a function.");if(typeof n<"u"&&typeof n!="function")throw new Error("Expected mapStateOnServer to either be undefined or a function.");function s(o){return o.displayName||o.name||"Component"}return function(a){if(typeof a!="function")throw new Error("Expected WrappedComponent to be a React component.");var l=[],u=void 0;function d(){u=e(l.map(function(f){return f.props})),c.canUseDOM?t(u):n&&(u=n(u))}var c=function(f){Sh(h,f);function h(){return bh(this,h),wh(this,f.apply(this,arguments))}return h.peek=function(){return u},h.rewind=function(){if(h.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var m=u;return u=void 0,l=[],m},h.prototype.shouldComponentUpdate=function(m){var _=m.children,b=mh(m,["children"]);return _&&_.length&&(b.children=_),i(b,this.props)},h.prototype.componentWillMount=function(){l.push(this),d()},h.prototype.componentDidUpdate=function(){d()},h.prototype.componentWillUnmount=function(){var m=l.indexOf(this);l.splice(m,1),d()},h.prototype.render=function(){return(0,Xs.h)(a,this.props)},h}(Xs.Component);return c.displayName="SideEffect("+s(a)+")",c.canUseDOM=!!(typeof window<"u"&&window.document&&window.document.createElement),c};function i(o,a){for(var l in o)if(!(l in a))return!0;for(var u in a)if(o[u]!==a[u])return!0;return!1}},Zs=Object.prototype.toString,la=function(e){var t=Zs.call(e),n=t==="[object Arguments]";return n||(n=t!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&Zs.call(e.callee)==="[object Function]"),n},Xr,ei;function Th(){if(ei)return Xr;ei=1;var r;if(!Object.keys){var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,n=la,s=Object.prototype.propertyIsEnumerable,i=!s.call({toString:null},"toString"),o=s.call(function(){},"prototype"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(f){var h=f.constructor;return h&&h.prototype===f},u={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if(typeof window>"u")return!1;for(var f in window)try{if(!u["$"+f]&&e.call(window,f)&&window[f]!==null&&typeof window[f]=="object")try{l(window[f])}catch{return!0}}catch{return!0}return!1}(),c=function(f){if(typeof window>"u"||!d)return l(f);try{return l(f)}catch{return!1}};r=function(h){var v=h!==null&&typeof h=="object",m=t.call(h)==="[object Function]",_=n(h),b=v&&t.call(h)==="[object String]",y=[];if(!v&&!m&&!_)throw new TypeError("Object.keys called on a non-object");var w=o&&m;if(b&&h.length>0&&!e.call(h,0))for(var A=0;A<h.length;++A)y.push(String(A));if(_&&h.length>0)for(var O=0;O<h.length;++O)y.push(String(O));else for(var E in h)!(w&&E==="prototype")&&e.call(h,E)&&y.push(String(E));if(i)for(var q=c(h),$=0;$<a.length;++$)!(q&&a[$]==="constructor")&&e.call(h,a[$])&&y.push(a[$]);return y}}return Xr=r,Xr}var $h=Array.prototype.slice,kh=la,ti=Object.keys,pr=ti?function(e){return ti(e)}:Th(),ri=Object.keys;pr.shim=function(){if(Object.keys){var e=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);e||(Object.keys=function(n){return kh(n)?ri($h.call(n)):ri(n)})}else Object.keys=pr;return Object.keys||pr};var ca=pr,ua=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),n=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var s=42;e[t]=s;for(var i in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,t);if(a.value!==s||a.enumerable!==!0)return!1}return!0},Ph=ua,Yn=function(){return Ph()&&!!Symbol.toStringTag},da=Object,ha=Error,Ah=EvalError,Oh=RangeError,Rh=ReferenceError,fa=SyntaxError,St=TypeError,jh=URIError,xh=Math.abs,Ch=Math.floor,Ih=Math.max,Uh=Math.min,Dh=Math.pow,Nh=Math.round,Lh=Number.isNaN||function(e){return e!==e},Mh=Lh,Fh=function(e){return Mh(e)||e===0?e:e<0?-1:1},Bh=Object.getOwnPropertyDescriptor,_r=Bh;if(_r)try{_r([],"length")}catch{_r=null}var Et=_r,vr=Object.defineProperty||!1;if(vr)try{vr({},"a",{value:1})}catch{vr=!1}var Nr=vr,Zr,ni;function Hh(){if(ni)return Zr;ni=1;var r=typeof Symbol<"u"&&Symbol,e=ua;return Zr=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},Zr}var pa=typeof Reflect<"u"&&Reflect.getPrototypeOf||null,qh=da,_a=qh.getPrototypeOf||null,Wh="Function.prototype.bind called on incompatible ",Gh=Object.prototype.toString,zh=Math.max,Jh="[object Function]",si=function(e,t){for(var n=[],s=0;s<e.length;s+=1)n[s]=e[s];for(var i=0;i<t.length;i+=1)n[i+e.length]=t[i];return n},Vh=function(e,t){for(var n=[],s=t,i=0;s<e.length;s+=1,i+=1)n[i]=e[s];return n},Kh=function(r,e){for(var t="",n=0;n<r.length;n+=1)t+=r[n],n+1<r.length&&(t+=e);return t},Yh=function(e){var t=this;if(typeof t!="function"||Gh.apply(t)!==Jh)throw new TypeError(Wh+t);for(var n=Vh(arguments,1),s,i=function(){if(this instanceof s){var d=t.apply(this,si(n,arguments));return Object(d)===d?d:this}return t.apply(e,si(n,arguments))},o=zh(0,t.length-n.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(s=Function("binder","return function ("+Kh(a,",")+"){ return binder.apply(this,arguments); }")(i),t.prototype){var u=function(){};u.prototype=t.prototype,s.prototype=new u,u.prototype=null}return s},Qh=Yh,Xt=Function.prototype.bind||Qh,Qn=Function.prototype.call,Xn=Function.prototype.apply,Xh=typeof Reflect<"u"&&Reflect&&Reflect.apply,Zh=Xt,ef=Xn,tf=Qn,rf=Xh,va=rf||Zh.call(tf,ef),nf=Xt,sf=St,of=Qn,af=va,Zn=function(e){if(e.length<1||typeof e[0]!="function")throw new sf("a function is required");return af(nf,of,e)},lf=Zn,ii=Et,ga;try{ga=[].__proto__===Array.prototype}catch(r){if(!r||typeof r!="object"||!("code"in r)||r.code!=="ERR_PROTO_ACCESS")throw r}var en=!!ga&&ii&&ii(Object.prototype,"__proto__"),ya=Object,oi=ya.getPrototypeOf,cf=en&&typeof en.get=="function"?lf([en.get]):typeof oi=="function"?function(e){return oi(e==null?e:ya(e))}:!1,ai=pa,li=_a,ci=cf,ma=ai?function(e){return ai(e)}:li?function(e){if(!e||typeof e!="object"&&typeof e!="function")throw new TypeError("getProto: not an object");return li(e)}:ci?function(e){return ci(e)}:null,uf=Function.prototype.call,df=Object.prototype.hasOwnProperty,hf=Xt,ba=hf.call(uf,df),L,ff=da,pf=ha,_f=Ah,vf=Oh,gf=Rh,yt=fa,dt=St,yf=jh,mf=xh,bf=Ch,wf=Ih,Sf=Uh,Ef=Dh,Tf=Nh,$f=Fh,wa=Function,tn=function(r){try{return wa('"use strict"; return ('+r+").constructor;")()}catch{}},Mt=Et,kf=Nr,rn=function(){throw new dt},Pf=Mt?function(){try{return arguments.callee,rn}catch{try{return Mt(arguments,"callee").get}catch{return rn}}}():rn,it=Hh()(),oe=ma,Af=_a,Of=pa,Sa=Xn,Zt=Qn,lt={},Rf=typeof Uint8Array>"u"||!oe?L:oe(Uint8Array),Ke={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?L:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?L:ArrayBuffer,"%ArrayIteratorPrototype%":it&&oe?oe([][Symbol.iterator]()):L,"%AsyncFromSyncIteratorPrototype%":L,"%AsyncFunction%":lt,"%AsyncGenerator%":lt,"%AsyncGeneratorFunction%":lt,"%AsyncIteratorPrototype%":lt,"%Atomics%":typeof Atomics>"u"?L:Atomics,"%BigInt%":typeof BigInt>"u"?L:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?L:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?L:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?L:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":pf,"%eval%":eval,"%EvalError%":_f,"%Float16Array%":typeof Float16Array>"u"?L:Float16Array,"%Float32Array%":typeof Float32Array>"u"?L:Float32Array,"%Float64Array%":typeof Float64Array>"u"?L:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?L:FinalizationRegistry,"%Function%":wa,"%GeneratorFunction%":lt,"%Int8Array%":typeof Int8Array>"u"?L:Int8Array,"%Int16Array%":typeof Int16Array>"u"?L:Int16Array,"%Int32Array%":typeof Int32Array>"u"?L:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":it&&oe?oe(oe([][Symbol.iterator]())):L,"%JSON%":typeof JSON=="object"?JSON:L,"%Map%":typeof Map>"u"?L:Map,"%MapIteratorPrototype%":typeof Map>"u"||!it||!oe?L:oe(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":ff,"%Object.getOwnPropertyDescriptor%":Mt,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?L:Promise,"%Proxy%":typeof Proxy>"u"?L:Proxy,"%RangeError%":vf,"%ReferenceError%":gf,"%Reflect%":typeof Reflect>"u"?L:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?L:Set,"%SetIteratorPrototype%":typeof Set>"u"||!it||!oe?L:oe(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?L:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":it&&oe?oe(""[Symbol.iterator]()):L,"%Symbol%":it?Symbol:L,"%SyntaxError%":yt,"%ThrowTypeError%":Pf,"%TypedArray%":Rf,"%TypeError%":dt,"%Uint8Array%":typeof Uint8Array>"u"?L:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?L:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?L:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?L:Uint32Array,"%URIError%":yf,"%WeakMap%":typeof WeakMap>"u"?L:WeakMap,"%WeakRef%":typeof WeakRef>"u"?L:WeakRef,"%WeakSet%":typeof WeakSet>"u"?L:WeakSet,"%Function.prototype.call%":Zt,"%Function.prototype.apply%":Sa,"%Object.defineProperty%":kf,"%Object.getPrototypeOf%":Af,"%Math.abs%":mf,"%Math.floor%":bf,"%Math.max%":wf,"%Math.min%":Sf,"%Math.pow%":Ef,"%Math.round%":Tf,"%Math.sign%":$f,"%Reflect.getPrototypeOf%":Of};if(oe)try{null.error}catch(r){var jf=oe(oe(r));Ke["%Error.prototype%"]=jf}var xf=function r(e){var t;if(e==="%AsyncFunction%")t=tn("async function () {}");else if(e==="%GeneratorFunction%")t=tn("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=tn("async function* () {}");else if(e==="%AsyncGenerator%"){var n=r("%AsyncGeneratorFunction%");n&&(t=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var s=r("%AsyncGenerator%");s&&oe&&(t=oe(s.prototype))}return Ke[e]=t,t},ui={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},er=Xt,Tr=ba,Cf=er.call(Zt,Array.prototype.concat),If=er.call(Sa,Array.prototype.splice),di=er.call(Zt,String.prototype.replace),$r=er.call(Zt,String.prototype.slice),Uf=er.call(Zt,RegExp.prototype.exec),Df=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Nf=/\\(\\)?/g,Lf=function(e){var t=$r(e,0,1),n=$r(e,-1);if(t==="%"&&n!=="%")throw new yt("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&t!=="%")throw new yt("invalid intrinsic syntax, expected opening `%`");var s=[];return di(e,Df,function(i,o,a,l){s[s.length]=a?di(l,Nf,"$1"):o||i}),s},Mf=function(e,t){var n=e,s;if(Tr(ui,n)&&(s=ui[n],n="%"+s[0]+"%"),Tr(Ke,n)){var i=Ke[n];if(i===lt&&(i=xf(n)),typeof i>"u"&&!t)throw new dt("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:s,name:n,value:i}}throw new yt("intrinsic "+e+" does not exist!")},Ea=function(e,t){if(typeof e!="string"||e.length===0)throw new dt("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new dt('"allowMissing" argument must be a boolean');if(Uf(/^%?[^%]*%?$/,e)===null)throw new yt("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=Lf(e),s=n.length>0?n[0]:"",i=Mf("%"+s+"%",t),o=i.name,a=i.value,l=!1,u=i.alias;u&&(s=u[0],If(n,Cf([0,1],u)));for(var d=1,c=!0;d<n.length;d+=1){var f=n[d],h=$r(f,0,1),v=$r(f,-1);if((h==='"'||h==="'"||h==="`"||v==='"'||v==="'"||v==="`")&&h!==v)throw new yt("property names with quotes must have matching quotes");if((f==="constructor"||!c)&&(l=!0),s+="."+f,o="%"+s+"%",Tr(Ke,o))a=Ke[o];else if(a!=null){if(!(f in a)){if(!t)throw new dt("base intrinsic for "+e+" exists, but the property is not available.");return}if(Mt&&d+1>=n.length){var m=Mt(a,f);c=!!m,c&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[f]}else c=Tr(a,f),a=a[f];c&&!l&&(Ke[o]=a)}}return a},Ta=Ea,$a=Zn,Ff=$a([Ta("%String.prototype.indexOf%")]),es=function(e,t){var n=Ta(e,!!t);return typeof n=="function"&&Ff(e,".prototype.")>-1?$a([n]):n},Bf=Yn(),Hf=es,Sn=Hf("Object.prototype.toString"),Lr=function(e){return Bf&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:Sn(e)==="[object Arguments]"},ka=function(e){return Lr(e)?!0:e!==null&&typeof e=="object"&&"length"in e&&typeof e.length=="number"&&e.length>=0&&Sn(e)!=="[object Array]"&&"callee"in e&&Sn(e.callee)==="[object Function]"},qf=function(){return Lr(arguments)}();Lr.isLegacyArguments=ka;var Wf=qf?Lr:ka,hi=Nr,Gf=fa,ot=St,fi=Et,ts=function(e,t,n){if(!e||typeof e!="object"&&typeof e!="function")throw new ot("`obj` must be an object or a function`");if(typeof t!="string"&&typeof t!="symbol")throw new ot("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new ot("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new ot("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new ot("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new ot("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,i=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,l=!!fi&&fi(e,t);if(hi)hi(e,t,{configurable:o===null&&l?l.configurable:!o,enumerable:s===null&&l?l.enumerable:!s,value:n,writable:i===null&&l?l.writable:!i});else if(a||!s&&!i&&!o)e[t]=n;else throw new Gf("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},En=Nr,Pa=function(){return!!En};Pa.hasArrayLengthDefineBug=function(){if(!En)return null;try{return En([],"length",{value:1}).length!==1}catch{return!0}};var rs=Pa,zf=ca,Jf=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",Vf=Object.prototype.toString,Kf=Array.prototype.concat,pi=ts,Yf=function(r){return typeof r=="function"&&Vf.call(r)==="[object Function]"},Aa=rs(),Qf=function(r,e,t,n){if(e in r){if(n===!0){if(r[e]===t)return}else if(!Yf(n)||!n())return}Aa?pi(r,e,t,!0):pi(r,e,t)},Oa=function(r,e){var t=arguments.length>2?arguments[2]:{},n=zf(e);Jf&&(n=Kf.call(n,Object.getOwnPropertySymbols(e)));for(var s=0;s<n.length;s+=1)Qf(r,n[s],e[n[s]],t[n[s]])};Oa.supportsDescriptors=!!Aa;var tr=Oa,Ra={exports:{}},Xf=Ea,_i=ts,Zf=rs(),vi=Et,gi=St,ep=Xf("%Math.floor%"),tp=function(e,t){if(typeof e!="function")throw new gi("`fn` is not a function");if(typeof t!="number"||t<0||t>4294967295||ep(t)!==t)throw new gi("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],s=!0,i=!0;if("length"in e&&vi){var o=vi(e,"length");o&&!o.configurable&&(s=!1),o&&!o.writable&&(i=!1)}return(s||i||!n)&&(Zf?_i(e,"length",t,!0,!0):_i(e,"length",t)),e},rp=Xt,np=Xn,sp=va,ip=function(){return sp(rp,np,arguments)};(function(r){var e=tp,t=Nr,n=Zn,s=ip;r.exports=function(o){var a=n(arguments),l=o.length-(arguments.length-1);return e(a,1+(l>0?l:0),!0)},t?t(r.exports,"apply",{value:s}):r.exports.apply=s})(Ra);var ja=Ra.exports,yi=function(r){return r!==r},xa=function(e,t){return e===0&&t===0?1/e===1/t:!!(e===t||yi(e)&&yi(t))},op=xa,Ca=function(){return typeof Object.is=="function"?Object.is:op},ap=Ca,lp=tr,cp=function(){var e=ap();return lp(Object,{is:e},{is:function(){return Object.is!==e}}),e},up=tr,dp=ja,hp=xa,Ia=Ca,fp=cp,Ua=dp(Ia(),Object);up(Ua,{getPolyfill:Ia,implementation:hp,shim:fp});var pp=Ua,mi=es,_p=Yn(),vp=ba,gp=Et,Tn;if(_p){var yp=mi("RegExp.prototype.exec"),bi={},nn=function(){throw bi},wi={toString:nn,valueOf:nn};typeof Symbol.toPrimitive=="symbol"&&(wi[Symbol.toPrimitive]=nn),Tn=function(e){if(!e||typeof e!="object")return!1;var t=gp(e,"lastIndex"),n=t&&vp(t,"value");if(!n)return!1;try{yp(e,wi)}catch(s){return s===bi}}}else{var mp=mi("Object.prototype.toString"),bp="[object RegExp]";Tn=function(e){return!e||typeof e!="object"&&typeof e!="function"?!1:mp(e)===bp}}var wp=Tn,Ft=function(){return typeof(function(){}).name=="string"},It=Object.getOwnPropertyDescriptor;if(It)try{It([],"length")}catch{It=null}Ft.functionsHaveConfigurableNames=function(){if(!Ft()||!It)return!1;var e=It(function(){},"name");return!!e&&!!e.configurable};var Sp=Function.prototype.bind;Ft.boundFunctionsHaveNames=function(){return Ft()&&typeof Sp=="function"&&(function(){}).bind().name!==""};var Ep=Ft,Si=ts,Tp=rs(),$p=Ep.functionsHaveConfigurableNames(),kp=St,Pp=function(e,t){if(typeof e!="function")throw new kp("`fn` is not a function");var n=arguments.length>2&&!!arguments[2];return(!n||$p)&&(Tp?Si(e,"name",t,!0,!0):Si(e,"name",t)),e},Ap=Pp,Op=St,Rp=Object,Da=Ap(function(){if(this==null||this!==Rp(this))throw new Op("RegExp.prototype.flags getter called on non-object");var e="";return this.hasIndices&&(e+="d"),this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.unicodeSets&&(e+="v"),this.sticky&&(e+="y"),e},"get flags",!0),jp=Da,xp=tr.supportsDescriptors,Cp=Object.getOwnPropertyDescriptor,Na=function(){if(xp&&/a/mig.flags==="gim"){var e=Cp(RegExp.prototype,"flags");if(e&&typeof e.get=="function"&&"dotAll"in RegExp.prototype&&"hasIndices"in RegExp.prototype){var t="",n={};if(Object.defineProperty(n,"hasIndices",{get:function(){t+="d"}}),Object.defineProperty(n,"sticky",{get:function(){t+="y"}}),e.get.call(n),t==="dy")return e.get}}return jp},Ip=tr.supportsDescriptors,Up=Na,Dp=Et,Np=Object.defineProperty,Lp=ha,Ei=ma,Mp=/a/,Fp=function(){if(!Ip||!Ei)throw new Lp("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=Up(),t=Ei(Mp),n=Dp(t,"flags");return(!n||n.get!==e)&&Np(t,"flags",{configurable:!0,enumerable:!1,get:e}),e},Bp=tr,Hp=ja,qp=Da,La=Na,Wp=Fp,Ma=Hp(La());Bp(Ma,{getPolyfill:La,implementation:qp,shim:Wp});var Gp=Ma,Fa=es,zp=Fa("Date.prototype.getDay"),Jp=function(e){try{return zp(e),!0}catch{return!1}},Vp=Fa("Object.prototype.toString"),Kp="[object Date]",Yp=Yn(),Qp=function(e){return typeof e!="object"||e===null?!1:Yp?Jp(e):Vp(e)===Kp},Ti=ca,$i=Wf,ki=pp,Pi=wp,Ai=Gp,Oi=Qp,Ri=Date.prototype.getTime;function Ba(r,e,t){var n=t||{};return(n.strict?ki(r,e):r===e)?!0:!r||!e||typeof r!="object"&&typeof e!="object"?n.strict?ki(r,e):r==e:Xp(r,e,n)}function ji(r){return r==null}function xi(r){return!(!r||typeof r!="object"||typeof r.length!="number"||typeof r.copy!="function"||typeof r.slice!="function"||r.length>0&&typeof r[0]!="number")}function Xp(r,e,t){var n,s;if(typeof r!=typeof e||ji(r)||ji(e)||r.prototype!==e.prototype||$i(r)!==$i(e))return!1;var i=Pi(r),o=Pi(e);if(i!==o)return!1;if(i||o)return r.source===e.source&&Ai(r)===Ai(e);if(Oi(r)&&Oi(e))return Ri.call(r)===Ri.call(e);var a=xi(r),l=xi(e);if(a!==l)return!1;if(a||l){if(r.length!==e.length)return!1;for(n=0;n<r.length;n++)if(r[n]!==e[n])return!1;return!0}if(typeof r!=typeof e)return!1;try{var u=Ti(r),d=Ti(e)}catch{return!1}if(u.length!==d.length)return!1;for(u.sort(),d.sort(),n=u.length-1;n>=0;n--)if(u[n]!=d[n])return!1;for(n=u.length-1;n>=0;n--)if(s=u[n],!Ba(r[s],e[s],t))return!1;return!0}var Zp=Ba;/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Ci=Object.getOwnPropertySymbols,e_=Object.prototype.hasOwnProperty,t_=Object.prototype.propertyIsEnumerable;function r_(r){if(r==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(r)}function n_(){try{if(!Object.assign)return!1;var r=new String("abc");if(r[5]="de",Object.getOwnPropertyNames(r)[0]==="5")return!1;for(var e={},t=0;t<10;t++)e["_"+String.fromCharCode(t)]=t;var n=Object.getOwnPropertyNames(e).map(function(i){return e[i]});if(n.join("")!=="0123456789")return!1;var s={};return"abcdefghijklmnopqrst".split("").forEach(function(i){s[i]=i}),Object.keys(Object.assign({},s)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var s_=n_()?Object.assign:function(r,e){for(var t,n=r_(r),s,i=1;i<arguments.length;i++){t=Object(arguments[i]);for(var o in t)e_.call(t,o)&&(n[o]=t[o]);if(Ci){s=Ci(t);for(var a=0;a<s.length;a++)t_.call(t,s[a])&&(n[s[a]]=t[s[a]])}}return n},rr={};rr.__esModule=!0;rr.TAG_NAMES={HTML:"htmlAttributes",TITLE:"title",BASE:"base",META:"meta",LINK:"link",SCRIPT:"script",NOSCRIPT:"noscript",STYLE:"style"};rr.TAG_PROPERTIES={NAME:"name",CHARSET:"charset",HTTPEQUIV:"http-equiv",REL:"rel",HREF:"href",PROPERTY:"property",SRC:"src",INNER_HTML:"innerHTML",CSS_TEXT:"cssText",ITEM_PROP:"itemprop"};rr.PREACT_TAG_MAP={charset:"charSet","http-equiv":"httpEquiv",itemprop:"itemProp",class:"className"};(function(r,e){e.__esModule=!0;var t=function(){function R(g,T){for(var S=0;S<T.length;S++){var P=T[S];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(g,P.key,P)}}return function(g,T,S){return T&&R(g.prototype,T),S&&R(g,S),g}}(),n=Object.assign||function(R){for(var g=1;g<arguments.length;g++){var T=arguments[g];for(var S in T)Object.prototype.hasOwnProperty.call(T,S)&&(R[S]=T[S])}return R},s=aa,i=Eh,o=f(i),a=Zp,l=f(a),u=s_,d=f(u),c=rr;function f(R){return R&&R.__esModule?R:{default:R}}function h(R,g){if(!(R instanceof g))throw new TypeError("Cannot call a class as a function")}function v(R,g){if(!R)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:R}function m(R,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);R.prototype=Object.create(g&&g.prototype,{constructor:{value:R,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(R,g):R.__proto__=g)}function _(R,g,T){return g in R?Object.defineProperty(R,g,{value:T,enumerable:!0,configurable:!0,writable:!0}):R[g]=T,R}var b="data-preact-helmet",y=function(g){return String(g).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},w=function(g,T){for(var S=g.length-1;S>=0;S--){var P=g[S];if(P[T])return P[T]}return null},A=function(g){var T=w(g,"title"),S=w(g,"titleTemplate");if(S&&T)return S.replace(/%s/g,function(){return T});var P=w(g,"defaultTitle");return T||P||""},O=function(g){return w(g,"onChangeClientState")||function(){}},E=function(g,T){return T.filter(function(S){return typeof S[g]<"u"}).map(function(S){return S[g]}).reduce(function(S,P){return n({},S,P)},{})},q=function(g,T){return T.filter(function(S){return typeof S[c.TAG_NAMES.BASE]<"u"}).map(function(S){return S[c.TAG_NAMES.BASE]}).reverse().reduce(function(S,P){if(!S.length)for(var D=Object.keys(P),G=0;G<D.length;G++){var H=D[G],C=H.toLowerCase();if(g.indexOf(C)!==-1&&P[C])return S.concat(P)}return S},[])},$=function(g,T,S){var P={};return S.filter(function(D){return typeof D[g]<"u"}).map(function(D){return D[g]}).reverse().reduce(function(D,G){var H={};G.filter(function(re){for(var ee=void 0,Be=Object.keys(re),ke=0;ke<Be.length;ke++){var me=Be[ke],k=me.toLowerCase();T.indexOf(k)!==-1&&!(ee===c.TAG_PROPERTIES.REL&&re[ee].toLowerCase()==="canonical")&&!(k===c.TAG_PROPERTIES.REL&&re[k].toLowerCase()==="stylesheet")&&(ee=k),T.indexOf(me)!==-1&&(me===c.TAG_PROPERTIES.INNER_HTML||me===c.TAG_PROPERTIES.CSS_TEXT||me===c.TAG_PROPERTIES.ITEM_PROP)&&(ee=me)}if(!ee||!re[ee])return!1;var J=re[ee].toLowerCase();return P[ee]||(P[ee]={}),H[ee]||(H[ee]={}),P[ee][J]?!1:(H[ee][J]=!0,!0)}).reverse().forEach(function(re){return D.push(re)});for(var C=Object.keys(H),z=0;z<C.length;z++){var Z=C[z],Ee=(0,d.default)({},P[Z],H[Z]);P[Z]=Ee}return D},[]).reverse()},j=function(g,T){document.title=g||document.title,W(c.TAG_NAMES.TITLE,T)},W=function(g,T){for(var S=document.getElementsByTagName(g)[0],P=S.getAttribute(b),D=P?P.split(","):[],G=[].concat(D),H=Object.keys(T),C=0;C<H.length;C++){var z=H[C],Z=T[z]||"";S.setAttribute(z,Z),D.indexOf(z)===-1&&D.push(z);var Ee=G.indexOf(z);Ee!==-1&&G.splice(Ee,1)}for(var re=G.length-1;re>=0;re--)S.removeAttribute(G[re]);D.length===G.length?S.removeAttribute(b):S.setAttribute(b,D.join(","))},N=function(g,T){var S=document.head||document.querySelector("head"),P=S.querySelectorAll(g+"["+b+"]"),D=Array.prototype.slice.call(P),G=[],H=void 0;return T&&T.length&&T.forEach(function(C){var z=document.createElement(g);for(var Z in C)if(C.hasOwnProperty(Z))if(Z==="innerHTML")z.innerHTML=C.innerHTML;else if(Z==="cssText")z.styleSheet?z.styleSheet.cssText=C.cssText:z.appendChild(document.createTextNode(C.cssText));else{var Ee=typeof C[Z]>"u"?"":C[Z];z.setAttribute(Z,Ee)}z.setAttribute(b,"true"),D.some(function(re,ee){return H=ee,z.isEqualNode(re)})?D.splice(H,1):G.push(z)}),D.forEach(function(C){return C.parentNode.removeChild(C)}),G.forEach(function(C){return S.appendChild(C)}),{oldTags:D,newTags:G}},Q=function(g){return Object.keys(g).reduce(function(T,S){var P=typeof g[S]<"u"?S+'="'+g[S]+'"':""+S;return T?T+" "+P:P},"")},ce=function(g,T,S){var P=Q(S);return P?"<"+g+" "+b+" "+P+">"+y(T)+"</"+g+">":"<"+g+" "+b+">"+y(T)+"</"+g+">"},ye=function(g,T){return T.reduce(function(S,P){var D=Object.keys(P).filter(function(C){return!(C==="innerHTML"||C==="cssText")}).reduce(function(C,z){var Z=typeof P[z]>"u"?z:z+'="'+y(P[z])+'"';return C?C+" "+Z:Z},""),G=P.innerHTML||P.cssText||"",H=[c.TAG_NAMES.NOSCRIPT,c.TAG_NAMES.SCRIPT,c.TAG_NAMES.STYLE].indexOf(g)===-1;return S+"<"+g+" "+b+" "+D+(H?">":">"+G+"</"+g+">")},"")},_e=function(g,T,S){var P=_({key:T},b,!0),D=Object.keys(S).reduce(function(G,H){return G[H]=S[H],G},P);return[(0,s.h)(c.TAG_NAMES.TITLE,D,T)]},et=function(g,T){return T.map(function(S,P){var D=_({key:P},b,!0);return Object.keys(S).forEach(function(G){var H=G;if(H==="innerHTML"||H==="cssText"){var C=S.innerHTML||S.cssText;D.dangerouslySetInnerHTML={__html:C}}else D[H]=S[G]}),(0,s.h)(g,D)})},Se=function(g,T){switch(g){case c.TAG_NAMES.TITLE:return{toComponent:function(){return _e(g,T.title,T.titleAttributes)},toString:function(){return ce(g,T.title,T.titleAttributes)}};case c.TAG_NAMES.HTML:return{toComponent:function(){return T},toString:function(){return Q(T)}};default:return{toComponent:function(){return et(g,T)},toString:function(){return ye(g,T)}}}},nr=function(g){var T=g.htmlAttributes,S=g.title,P=g.titleAttributes,D=g.baseTag,G=g.metaTags,H=g.linkTags,C=g.scriptTags,z=g.noscriptTags,Z=g.styleTags;return{htmlAttributes:Se(c.TAG_NAMES.HTML,T),title:Se(c.TAG_NAMES.TITLE,{title:S,titleAttributes:P}),base:Se(c.TAG_NAMES.BASE,D),meta:Se(c.TAG_NAMES.META,G),link:Se(c.TAG_NAMES.LINK,H),script:Se(c.TAG_NAMES.SCRIPT,C),noscript:Se(c.TAG_NAMES.NOSCRIPT,z),style:Se(c.TAG_NAMES.STYLE,Z)}},sr=function(g){var T,S;return S=T=function(P){m(D,P);function D(){return h(this,D),v(this,(D.__proto__||Object.getPrototypeOf(D)).apply(this,arguments))}return t(D,[{key:"shouldComponentUpdate",value:function(H){var C=n({},H);return(!C.children||!C.children.length)&&delete C.children,!(0,l.default)(this.props,C)}},{key:"render",value:function(){return(0,s.h)(g,this.props)}}],[{key:"canUseDOM",set:function(H){g.canUseDOM=H}}]),D}(s.Component),T.peek=g.peek,T.rewind=function(){var P=g.rewind();return P||(P=nr({htmlAttributes:{},title:"",titleAttributes:{},baseTag:[],metaTags:[],linkTags:[],scriptTags:[],noscriptTags:[],styleTags:[]})),P},S},se=function(g){return{htmlAttributes:E(c.TAG_NAMES.HTML,g),title:A(g),titleAttributes:E("titleAttributes",g),baseTag:q([c.TAG_PROPERTIES.HREF],g),metaTags:$(c.TAG_NAMES.META,[c.TAG_PROPERTIES.NAME,c.TAG_PROPERTIES.CHARSET,c.TAG_PROPERTIES.HTTPEQUIV,c.TAG_PROPERTIES.PROPERTY,c.TAG_PROPERTIES.ITEM_PROP],g),linkTags:$(c.TAG_NAMES.LINK,[c.TAG_PROPERTIES.REL,c.TAG_PROPERTIES.HREF],g),scriptTags:$(c.TAG_NAMES.SCRIPT,[c.TAG_PROPERTIES.SRC,c.TAG_PROPERTIES.INNER_HTML],g),noscriptTags:$(c.TAG_NAMES.NOSCRIPT,[c.TAG_PROPERTIES.INNER_HTML],g),styleTags:$(c.TAG_NAMES.STYLE,[c.TAG_PROPERTIES.CSS_TEXT],g),onChangeClientState:O(g)}},B=function(g){var T=g.htmlAttributes,S=g.title,P=g.titleAttributes,D=g.baseTag,G=g.metaTags,H=g.linkTags,C=g.scriptTags,z=g.noscriptTags,Z=g.styleTags,Ee=g.onChangeClientState;W("html",T),j(S,P);var re={baseTag:N(c.TAG_NAMES.BASE,D),metaTags:N(c.TAG_NAMES.META,G),linkTags:N(c.TAG_NAMES.LINK,H),scriptTags:N(c.TAG_NAMES.SCRIPT,C),noscriptTags:N(c.TAG_NAMES.NOSCRIPT,z),styleTags:N(c.TAG_NAMES.STYLE,Z)},ee={},Be={};Object.keys(re).forEach(function(ke){var me=re[ke],k=me.newTags,J=me.oldTags;k.length&&(ee[ke]=k),J.length&&(Be[ke]=re[ke].oldTags)}),Ee(g,ee,Be)},Mr=function(){return null},Fr=(0,o.default)(se,B,nr)(Mr);e.default=sr(Fr),r.exports=e.default})(wn,wn.exports);var i_=wn.exports;const ns=eo(i_),o_=()=>{const{user:r}=Cr(),e=Lt(n=>n.favorites),t=Lt(n=>n.fetchFavorites);return ne(()=>{document.title="My Favorites - FreeStream",r&&t()},[r,t]),p("div",{class:"container",children:[p(ns,{children:p("title",{children:"My Favorites - FreeStream"})}),p("h1",{children:"My Favorites"}),e.length>0?p("div",{class:"movie-grid",children:e.map(n=>p(Qt,{item:n,mediaType:n.type}))}):p("p",{children:"You haven't added any favorites yet."})]})},a_=()=>{const{user:r}=Cr(),[e,t]=F(U([]),"history"),[n,s]=F(U(!0),"loading");return ne(()=>{(async()=>{if(!r){s(!1);return}s(!0);const o=await oa(),a=await Promise.all(o.map(async l=>{const u=await fetch(`/api/tmdb/${l.media_type}/${l.media_id}`);return u.ok?{...await u.json(),type:l.media_type}:null}));t(a.filter(Boolean)),s(!1)})()},[r]),n?p("div",{class:"container",children:p("p",{children:"Loading history..."})}):p("div",{class:"container",children:[p(ns,{children:p("title",{children:"Watch History - FreeStream"})}),p("h1",{children:"Watch History"}),e.length>0?p("div",{class:"movie-grid",children:e.map(i=>p(Qt,{item:i,mediaType:i.type},i.id))}):p("p",{children:"Your watch history is empty."})]})},l_=r=>{var me;const[e,t]=F(U(null),"mediaDetails"),[n,s]=F(U([]),"videos"),[i,o]=F(U([]),"recommendations"),[a,l]=F(U(""),"streamUrl"),[u,d]=F(U(!0),"loading"),[c,f]=F(U(1),"currentSeason"),[h,v]=F(U(1),"currentEpisode"),[m,_]=F(U(r.matches.type==="anime"?"consumet":"videasy"),"currentSource"),[b,y]=F(U([]),"availableSources"),[w,A]=F(U(null),"seasonDetails"),[O,E]=F(U(!1),"episodesLoading"),[q,$]=F(U(!1),"isDubbed"),[j,W]=F(U(!1),"showNextEpisodePrompt"),[N,Q]=F(U(null),"nextEpisodeCountdown"),[ce,ye]=F(U(!1),"isDirectSource"),[_e,et]=F(U([]),"qualities"),Se=F(Wt(null),"videoRef"),[nr,sr]=F(U({}),"seriesWatchHistory"),{id:se,type:B}=r.matches,{addFavorite:Mr,removeFavorite:Fr,isFavorited:R,setCurrentMediaItem:g}=Lt();ne(()=>(e&&g({...e,type:B}),()=>{g(null)}),[e,B,g]),ne(()=>{if(!se||!B){_t("/");return}l(""),ye(!1),et([]),t(null),d(!0),W(!1),Q(null),sr({}),(async()=>{d(!0);try{const[J,te,Pe]=await Promise.all([fetch(`${xe}/tmdb/${B}/${se}`).then(ve=>ve.json()),fetch(`${xe}/tmdb/${B}/${se}/videos`).then(ve=>ve.json()),fetch(`${xe}/tmdb/${B}/${se}/recommendations`).then(ve=>ve.json())]);if(t(J),s(te.results||[]),o(Pe.results||[]),(B==="tv"||B==="anime")&&J.seasons&&J.seasons.length>0){const ve=await gh(se);if(ve&&ve.season&&ve.episode)f(ve.season),v(ve.episode);else{const Ha=J.seasons.find(qa=>qa.season_number>0)||J.seasons[0];f(Ha.season_number),v(1)}}if(B==="tv"||B==="anime"){const ve=await vh(se);sr(ve)}}catch(J){console.error("Error fetching media details:",J)}finally{d(!1)}})()},[se,B]),ne(()=>{(async()=>{if(!(B!=="tv"&&B!=="anime"||!se||!c)){E(!0);try{const J=await fetch(`${xe}/tmdb/${B}/${se}/season/${c}`);if(J.ok){const te=await J.json();A(te)}else A(null)}catch(J){console.error("Error fetching season details:",J),A(null)}finally{E(!1)}}})()},[se,B,c]),ne(()=>{(async()=>{if(!se||!B)return;W(!1),Q(null);let J=`${xe}/stream-url?type=${B}&id=${se}&source=${m}`;(B==="tv"||B==="anime")&&(J+=`&season=${c}&episode=${h}`,B==="anime"&&(J+=`&dub=${q}`));try{const te=await fetch(J).then(Pe=>Pe.json());te.isDirectSource?(l(te.url),et(te.qualities||[]),ye(!0)):(l(te.url),ye(!1),et([])),te.currentSource&&_(te.currentSource),te.availableSources&&y(te.availableSources)}catch(te){console.error("Error fetching stream URL:",te),l(""),ye(!1)}})()},[se,B,c,h,m,q]);const T=()=>{if(!w||!w.episodes)return;const k=w.episodes.findIndex(J=>J.episode_number===h);if(k!==-1&&k<w.episodes.length-1){const J=w.episodes[k+1];v(J.episode_number)}else console.log("End of season");W(!1),Q(null)};if(ne(()=>{if(j&&N===null&&Q(15),N>0){const k=setTimeout(()=>{Q(N-1)},1e3);return()=>clearTimeout(k)}else N===0&&T()},[j,N]),ne(()=>{const k=Se.current;if(!k||!ce)return;const J=async()=>{const Pe=await ph(se,B,c,h);Pe&&Pe.progress_seconds&&(k.currentTime=Pe.progress_seconds)},te=()=>{e&&_h({...e,type:B,season:c,episode:h},k.currentTime,e.runtime),k.duration>0&&k.currentTime/k.duration>=.95&&!j&&(B==="tv"||B==="anime")&&W(!0)};return k.addEventListener("loadedmetadata",J),k.addEventListener("timeupdate",te),()=>{k.removeEventListener("loadedmetadata",J),k.removeEventListener("timeupdate",te)}},[a,ce,se,B,c,h,e,j]),u)return p("div",{class:"loading-spinner"});if(!e)return p("div",{class:"container",children:p("p",{children:"Could not load media details."})});const{title:S,name:P,overview:D,vote_average:G,release_date:H,first_air_date:C,runtime:z,number_of_seasons:Z,genres:Ee,poster_path:re}=e,ee=R(e.id),Be=H||C?new Date(H||C).getFullYear():"",ke=()=>{ee?Fr(e.id):Mr({...e,type:B})};return p("div",{children:[p(ns,{children:p("title",{children:[S||P," - FreeStream"]})}),p("div",{class:"player-container",children:[!a&&p("div",{class:"stream-error-message",children:[p("p",{children:"Could not load the video stream."}),p("p",{children:"If this issue persists, please try selecting a different source from the list below."})]}),ce?p("video",{ref:Se,src:a,controls:!0,autoPlay:!0,width:"100%"}):a&&p("iframe",{src:a,allowfullscreen:!0}),j&&p("div",{class:"next-episode-prompt",children:p("div",{class:"next-episode-content",children:[p("h3",{children:"Up Next"}),p("p",{children:["Playing next episode in ",N,"s..."]}),p("div",{class:"next-episode-buttons",children:[p("button",{onClick:T,class:"btn btn-primary",children:"Play Next"}),p("button",{onClick:()=>{W(!1),Q(null)},class:"btn",children:"Cancel"})]})]})})]}),p("div",{class:"container",children:[p("div",{class:"media-details-layout",children:[p("div",{class:"poster",children:p("img",{src:re?`${xe}/image/t/p/w500${re}`:"https://via.placeholder.com/500x750.png?text=No+Image",alt:S||P})}),p("div",{class:"details",children:[p("div",{class:"title-container",children:[p("h1",{children:S||P}),p("button",{onClick:ke,class:`favorite-btn ${ee?"favorited":""}`,children:ee?" Favorited":" Add to Favorites"})]}),p("div",{class:"meta",children:[p("span",{class:"rating",children:[" ",e.vote_average?e.vote_average.toFixed(1):"N/A"]}),p("span",{children:Be}),z&&p("span",{children:[z," min"]}),Z&&p("span",{children:[Z," Seasons"]})]}),p("div",{class:"genres",children:Ee&&Ee.map(k=>p("span",{class:"genre-tag",children:k.name}))}),p("p",{class:"overview",children:D}),_e.length>0&&p("div",{class:"quality-selector",children:[p("label",{children:"Quality:"}),_e.map(k=>p("button",{class:`quality-btn ${a===k.url?"active":""}`,onClick:()=>l(k.url),children:[k.quality,"p"]}))]})]})]}),B==="anime"&&p("div",{class:"select-container",children:[p("label",{for:"dub-select",children:"Audio:"}),p("select",{id:"dub-select",value:q,onChange:k=>$(k.target.value==="true"),children:[p("option",{value:"false",children:"Subbed"}),p("option",{value:"true",children:"Dubbed"})]})]}),p("div",{class:"selectors-container",children:[(B==="tv"||B==="anime")&&e&&e.seasons&&p("div",{class:"select-container",children:[p("label",{children:"Season:"}),p("div",{class:"selector-buttons",children:e.seasons.filter(k=>k.season_number>0).map(k=>p("button",{class:`selector-btn ${c===k.season_number?"active":""}`,onClick:()=>{f(k.season_number),v(1)},children:k.name},k.id))})]}),b.length>1&&p("div",{class:"select-container",children:[p("label",{children:"Source:"}),p("div",{class:"selector-buttons",children:b.map(k=>p("button",{class:`selector-btn ${m===k?"active":""}`,onClick:()=>_(k),children:k},k))})]})]}),(B==="tv"||B==="anime")&&p("div",{class:"episodes-container",children:[p("h3",{children:"Episodes"}),O?p("div",{class:"loading-spinner"}):p("div",{class:"episode-list",children:(me=w==null?void 0:w.episodes)==null?void 0:me.map(k=>{const J=`${se}-${B}-${c}-${k.episode_number}`,te=nr[J],Pe=te?te.progress_seconds/te.duration_seconds*100:0;return p("div",{class:`episode-card ${k.episode_number===h?"active":""}`,onClick:()=>v(k.episode_number),children:[p("div",{class:"episode-card-image",children:[p("img",{src:k.still_path?`${xe}/image/t/p/w300${k.still_path}`:`https://via.placeholder.com/300x169.png?text=${encodeURIComponent(k.name)}`,alt:k.name}),p("div",{class:"episode-number-badge",children:k.episode_number}),Pe>0&&p("div",{class:"episode-progress-bar",children:p("div",{class:"episode-progress",style:{width:`${Pe}%`}})})]}),p("div",{class:"episode-card-content",children:[p("h4",{children:k.name}),p("p",{class:"episode-overview",children:k.overview})]})]},k.id)})})]}),i.length>0&&p("div",{class:"recommendations",children:[p("h2",{children:"More Like This"}),p("div",{class:"movie-grid",children:i.map(k=>p(Qt,{item:k,mediaType:B}))})]})]})]})},c_=r=>{const[e,t]=F(U([]),"results"),[n,s]=F(U(!1),"loading"),[i,o]=F(U(""),"query");ne(()=>{var d;const u=new URLSearchParams(((d=r.url)==null?void 0:d.split("?")[1])||"").get("q");o(u||""),u?a(u):t([])},[r.url]);const a=async l=>{s(!0);try{const d=await(await fetch(`${xe}/tmdb/search/multi?query=${encodeURIComponent(l)}`)).json();if(d&&d.results){const c=d.results.filter(f=>(f.media_type==="movie"||f.media_type==="tv")&&f.poster_path);t(c)}}catch(u){console.error("Error performing search:",u),t([])}finally{s(!1)}};return p("div",{class:"container",children:[p("div",{class:"page-header",children:p("h1",{children:['Search Results for "',i,'"']})}),n?p("div",{class:"loading-spinner"}):e.length>0?p("div",{class:"movie-grid",children:e.map(l=>p(Qt,{item:l,mediaType:l.media_type}))}):p("p",{children:['No results found for "',i,'". Please try another search.']})]})};function u_(){const[r,e]=F(U(!1),"loading"),[t,n]=F(U(""),"email"),[s,i]=F(U(""),"password"),o=async a=>{a.preventDefault();try{e(!0);const{error:l}=await ae.auth.signInWithPassword({email:t,password:s});if(l)throw l;Er.success("Logged in successfully!"),_t("/",!0)}catch(l){Er.error(l.error_description||l.message)}finally{e(!1)}};return p("div",{className:"auth-container",children:p("div",{className:"auth-form",children:[p("h1",{className:"header",children:"Login"}),p("p",{className:"description",children:"Sign in to your account."}),p("form",{onSubmit:o,children:[p("div",{className:"input-group",children:[p("label",{htmlFor:"email",children:"Email"}),p("input",{id:"email",className:"input-field",type:"email",placeholder:"Your email",value:t,onChange:a=>n(a.target.value)})]}),p("div",{className:"input-group",children:[p("label",{htmlFor:"password",children:"Password"}),p("input",{id:"password",className:"input-field",type:"password",placeholder:"Your password",value:s,onChange:a=>i(a.target.value)})]}),p("div",{children:p("button",{className:"button",disabled:r,children:r?p("span",{children:"Loading..."}):p("span",{children:"Login"})})})]})]})})}function d_(){const[r,e]=F(U(!1),"loading"),[t,n]=F(U(""),"email"),[s,i]=F(U(""),"password"),o=async a=>{a.preventDefault();try{e(!0);const{error:l}=await ae.auth.signUp({email:t,password:s});if(l)throw l;Er.success("Check your email for the confirmation link!")}catch(l){Er.error(l.error_description||l.message)}finally{e(!1)}};return p("div",{className:"auth-container",children:p("div",{className:"auth-form",children:[p("h1",{className:"header",children:"Create an account"}),p("p",{className:"description",children:"Sign up for a new account."}),p("form",{onSubmit:o,children:[p("div",{className:"input-group",children:[p("label",{htmlFor:"email",children:"Email"}),p("input",{id:"email",className:"input-field",type:"email",placeholder:"Your email",value:t,onChange:a=>n(a.target.value)})]}),p("div",{className:"input-group",children:[p("label",{htmlFor:"password",children:"Password"}),p("input",{id:"password",className:"input-field",type:"password",placeholder:"Your password",value:s,onChange:a=>i(a.target.value)})]}),p("div",{children:p("button",{className:"button",disabled:r,children:r?p("span",{children:"Loading..."}):p("span",{children:"Sign Up"})})})]})]})})}const Ii=({component:r,...e})=>{const{user:t}=Cr();return t?p(r,{...e}):(_t("/login",!0),null)},h_=()=>p(Pu,{children:p("div",{class:"app",children:[p(xd,{position:"top-center",reverseOrder:!1,gutter:8,containerClassName:"",containerStyle:{},toastOptions:{className:"",duration:5e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,theme:{primary:"green",secondary:"black"}}}}),p(Cd,{}),p("main",{children:p(Zi,{history:ul(),children:[p(yh,{path:"/"}),p(Ii,{component:o_,path:"/favorites"}),p(Ii,{component:a_,path:"/history"}),p(l_,{path:"/watch"}),p(c_,{path:"/search"}),p(u_,{path:"/login"}),p(d_,{path:"/signup"})]})}),p("footer",{children:p("p",{children:" 2024 FreeStream. All Rights Reserved."})})]})});Ye(p(h_,{}),document.getElementById("app"));
