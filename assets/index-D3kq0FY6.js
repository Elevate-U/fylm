(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();var Ft,U,Ii,Ci,We,rs,Ui,Ni,Li,En,rn,nn,Di,Ct={},Mi=[],Ha=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Bt=Array.isArray;function Pe(r,e){for(var t in e)r[t]=e[t];return r}function $n(r){r&&r.parentNode&&r.parentNode.removeChild(r)}function J(r,e,t){var n,s,i,o={};for(i in e)i=="key"?n=e[i]:i=="ref"?s=e[i]:o[i]=e[i];if(arguments.length>2&&(o.children=arguments.length>3?Ft.call(arguments,2):t),typeof r=="function"&&r.defaultProps!=null)for(i in r.defaultProps)o[i]===void 0&&(o[i]=r.defaultProps[i]);return kt(r,o,n,s,null)}function kt(r,e,t,n,s){var i={type:r,props:e,key:t,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++Ii,__i:-1,__u:0};return s==null&&U.vnode!=null&&U.vnode(i),i}function Tn(){return{current:null}}function he(r){return r.children}function ve(r,e){this.props=r,this.context=e}function dt(r,e){if(e==null)return r.__?dt(r.__,r.__i+1):null;for(var t;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null)return t.__e;return typeof r.type=="function"?dt(r):null}function Fi(r){var e,t;if((r=r.__)!=null&&r.__c!=null){for(r.__e=r.__c.base=null,e=0;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null){r.__e=r.__c.base=t.__e;break}return Fi(r)}}function sn(r){(!r.__d&&(r.__d=!0)&&We.push(r)&&!vr.__r++||rs!=U.debounceRendering)&&((rs=U.debounceRendering)||Ui)(vr)}function vr(){for(var r,e,t,n,s,i,o,a=1;We.length;)We.length>a&&We.sort(Ni),r=We.shift(),a=We.length,r.__d&&(t=void 0,s=(n=(e=r).__v).__e,i=[],o=[],e.__P&&((t=Pe({},n)).__v=n.__v+1,U.vnode&&U.vnode(t),kn(e.__P,t,n,e.__n,e.__P.namespaceURI,32&n.__u?[s]:null,i,s??dt(n),!!(32&n.__u),o),t.__v=n.__v,t.__.__k[t.__i]=t,qi(i,t,o),t.__e!=s&&Fi(t)));vr.__r=0}function Bi(r,e,t,n,s,i,o,a,l,u,d){var c,f,h,v,m,_,b=n&&n.__k||Mi,y=e.length;for(l=qa(t,e,b,l,y),c=0;c<y;c++)(h=t.__k[c])!=null&&(f=h.__i==-1?Ct:b[h.__i]||Ct,h.__i=c,_=kn(r,h,f,s,i,o,a,l,u,d),v=h.__e,h.ref&&f.ref!=h.ref&&(f.ref&&Pn(f.ref,null,h),d.push(h.ref,h.__c||v,h)),m==null&&v!=null&&(m=v),4&h.__u||f.__k===h.__k?l=Hi(h,l,r):typeof h.type=="function"&&_!==void 0?l=_:v&&(l=v.nextSibling),h.__u&=-7);return t.__e=m,l}function qa(r,e,t,n,s){var i,o,a,l,u,d=t.length,c=d,f=0;for(r.__k=new Array(s),i=0;i<s;i++)(o=e[i])!=null&&typeof o!="boolean"&&typeof o!="function"?(l=i+f,(o=r.__k[i]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?kt(null,o,null,null,null):Bt(o)?kt(he,{children:o},null,null,null):o.constructor==null&&o.__b>0?kt(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=r,o.__b=r.__b+1,a=null,(u=o.__i=Wa(o,t,l,c))!=-1&&(c--,(a=t[u])&&(a.__u|=2)),a==null||a.__v==null?(u==-1&&(s>d?f--:s<d&&f++),typeof o.type!="function"&&(o.__u|=4)):u!=l&&(u==l-1?f--:u==l+1?f++:(u>l?f--:f++,o.__u|=4))):r.__k[i]=null;if(c)for(i=0;i<d;i++)(a=t[i])!=null&&!(2&a.__u)&&(a.__e==n&&(n=dt(a)),Gi(a,a));return n}function Hi(r,e,t){var n,s;if(typeof r.type=="function"){for(n=r.__k,s=0;n&&s<n.length;s++)n[s]&&(n[s].__=r,e=Hi(n[s],e,t));return e}r.__e!=e&&(e&&r.type&&!t.contains(e)&&(e=dt(r)),t.insertBefore(r.__e,e||null),e=r.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function me(r,e){return e=e||[],r==null||typeof r=="boolean"||(Bt(r)?r.some(function(t){me(t,e)}):e.push(r)),e}function Wa(r,e,t,n){var s,i,o=r.key,a=r.type,l=e[t];if(l===null&&r.key==null||l&&o==l.key&&a==l.type&&!(2&l.__u))return t;if(n>(l!=null&&!(2&l.__u)?1:0))for(s=t-1,i=t+1;s>=0||i<e.length;){if(s>=0){if((l=e[s])&&!(2&l.__u)&&o==l.key&&a==l.type)return s;s--}if(i<e.length){if((l=e[i])&&!(2&l.__u)&&o==l.key&&a==l.type)return i;i++}}return-1}function ns(r,e,t){e[0]=="-"?r.setProperty(e,t??""):r[e]=t==null?"":typeof t!="number"||Ha.test(e)?t:t+"px"}function sr(r,e,t,n,s){var i,o;e:if(e=="style")if(typeof t=="string")r.style.cssText=t;else{if(typeof n=="string"&&(r.style.cssText=n=""),n)for(e in n)t&&e in t||ns(r.style,e,"");if(t)for(e in t)n&&t[e]==n[e]||ns(r.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")i=e!=(e=e.replace(Li,"$1")),o=e.toLowerCase(),e=o in r||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),r.l||(r.l={}),r.l[e+i]=t,t?n?t.u=n.u:(t.u=En,r.addEventListener(e,i?nn:rn,i)):r.removeEventListener(e,i?nn:rn,i);else{if(s=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in r)try{r[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?r.removeAttribute(e):r.setAttribute(e,e=="popover"&&t==1?"":t))}}function ss(r){return function(e){if(this.l){var t=this.l[e.type+r];if(e.t==null)e.t=En++;else if(e.t<t.u)return;return t(U.event?U.event(e):e)}}}function kn(r,e,t,n,s,i,o,a,l,u){var d,c,f,h,v,m,_,b,y,w,A,O,E,H,T,R,q,L=e.type;if(e.constructor!=null)return null;128&t.__u&&(l=!!(32&t.__u),i=[a=e.__e=t.__e]),(d=U.__b)&&d(e);e:if(typeof L=="function")try{if(b=e.props,y="prototype"in L&&L.prototype.render,w=(d=L.contextType)&&n[d.__c],A=d?w?w.props.value:d.__:n,t.__c?_=(c=e.__c=t.__c).__=c.__E:(y?e.__c=c=new L(b,A):(e.__c=c=new ve(b,A),c.constructor=L,c.render=za),w&&w.sub(c),c.props=b,c.state||(c.state={}),c.context=A,c.__n=n,f=c.__d=!0,c.__h=[],c._sb=[]),y&&c.__s==null&&(c.__s=c.state),y&&L.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=Pe({},c.__s)),Pe(c.__s,L.getDerivedStateFromProps(b,c.__s))),h=c.props,v=c.state,c.__v=e,f)y&&L.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),y&&c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(y&&L.getDerivedStateFromProps==null&&b!==h&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(b,A),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(b,c.__s,A)===!1||e.__v==t.__v){for(e.__v!=t.__v&&(c.props=b,c.state=c.__s,c.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(Y){Y&&(Y.__=e)}),O=0;O<c._sb.length;O++)c.__h.push(c._sb[O]);c._sb=[],c.__h.length&&o.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(b,c.__s,A),y&&c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(h,v,m)})}if(c.context=A,c.props=b,c.__P=r,c.__e=!1,E=U.__r,H=0,y){for(c.state=c.__s,c.__d=!1,E&&E(e),d=c.render(c.props,c.state,c.context),T=0;T<c._sb.length;T++)c.__h.push(c._sb[T]);c._sb=[]}else do c.__d=!1,E&&E(e),d=c.render(c.props,c.state,c.context),c.state=c.__s;while(c.__d&&++H<25);c.state=c.__s,c.getChildContext!=null&&(n=Pe(Pe({},n),c.getChildContext())),y&&!f&&c.getSnapshotBeforeUpdate!=null&&(m=c.getSnapshotBeforeUpdate(h,v)),R=d,d!=null&&d.type===he&&d.key==null&&(R=Wi(d.props.children)),a=Bi(r,Bt(R)?R:[R],e,t,n,s,i,o,a,l,u),c.base=e.__e,e.__u&=-161,c.__h.length&&o.push(c),_&&(c.__E=c.__=null)}catch(Y){if(e.__v=null,l||i!=null)if(Y.then){for(e.__u|=l?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;i[i.indexOf(a)]=null,e.__e=a}else for(q=i.length;q--;)$n(i[q]);else e.__e=t.__e,e.__k=t.__k;U.__e(Y,e,t)}else i==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):a=e.__e=Ga(t.__e,e,t,n,s,i,o,l,u);return(d=U.diffed)&&d(e),128&e.__u?void 0:a}function qi(r,e,t){for(var n=0;n<t.length;n++)Pn(t[n],t[++n],t[++n]);U.__c&&U.__c(e,r),r.some(function(s){try{r=s.__h,s.__h=[],r.some(function(i){i.call(s)})}catch(i){U.__e(i,s.__v)}})}function Wi(r){return typeof r!="object"||r==null||r.__b&&r.__b>0?r:Bt(r)?r.map(Wi):Pe({},r)}function Ga(r,e,t,n,s,i,o,a,l){var u,d,c,f,h,v,m,_=t.props,b=e.props,y=e.type;if(y=="svg"?s="http://www.w3.org/2000/svg":y=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),i!=null){for(u=0;u<i.length;u++)if((h=i[u])&&"setAttribute"in h==!!y&&(y?h.localName==y:h.nodeType==3)){r=h,i[u]=null;break}}if(r==null){if(y==null)return document.createTextNode(b);r=document.createElementNS(s,y,b.is&&b),a&&(U.__m&&U.__m(e,i),a=!1),i=null}if(y==null)_===b||a&&r.data==b||(r.data=b);else{if(i=i&&Ft.call(r.childNodes),_=t.props||Ct,!a&&i!=null)for(_={},u=0;u<r.attributes.length;u++)_[(h=r.attributes[u]).name]=h.value;for(u in _)if(h=_[u],u!="children"){if(u=="dangerouslySetInnerHTML")c=h;else if(!(u in b)){if(u=="value"&&"defaultValue"in b||u=="checked"&&"defaultChecked"in b)continue;sr(r,u,null,h,s)}}for(u in b)h=b[u],u=="children"?f=h:u=="dangerouslySetInnerHTML"?d=h:u=="value"?v=h:u=="checked"?m=h:a&&typeof h!="function"||_[u]===h||sr(r,u,h,_[u],s);if(d)a||c&&(d.__html==c.__html||d.__html==r.innerHTML)||(r.innerHTML=d.__html),e.__k=[];else if(c&&(r.innerHTML=""),Bi(e.type=="template"?r.content:r,Bt(f)?f:[f],e,t,n,y=="foreignObject"?"http://www.w3.org/1999/xhtml":s,i,o,i?i[0]:t.__k&&dt(t,0),a,l),i!=null)for(u=i.length;u--;)$n(i[u]);a||(u="value",y=="progress"&&v==null?r.removeAttribute("value"):v!=null&&(v!==r[u]||y=="progress"&&!v||y=="option"&&v!=_[u])&&sr(r,u,v,_[u],s),u="checked",m!=null&&m!=r[u]&&sr(r,u,m,_[u],s))}return r}function Pn(r,e,t){try{if(typeof r=="function"){var n=typeof r.__u=="function";n&&r.__u(),n&&e==null||(r.__u=r(e))}else r.current=e}catch(s){U.__e(s,t)}}function Gi(r,e,t){var n,s;if(U.unmount&&U.unmount(r),(n=r.ref)&&(n.current&&n.current!=r.__e||Pn(n,null,e)),(n=r.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(i){U.__e(i,e)}n.base=n.__P=null}if(n=r.__k)for(s=0;s<n.length;s++)n[s]&&Gi(n[s],e,t||typeof r.type!="function");t||$n(r.__e),r.__c=r.__=r.__e=void 0}function za(r,e,t){return this.constructor(r,t)}function Ke(r,e,t){var n,s,i,o;e==document&&(e=document.documentElement),U.__&&U.__(r,e),s=(n=typeof t=="function")?null:t&&t.__k||e.__k,i=[],o=[],kn(e,r=(!n&&t||e).__k=J(he,null,[r]),s||Ct,Ct,e.namespaceURI,!n&&t?[t]:s?null:e.firstChild?Ft.call(e.childNodes):null,i,!n&&t?t:s?s.__e:e.firstChild,n,o),qi(i,r,o)}function An(r,e){Ke(r,e,An)}function On(r,e,t){var n,s,i,o,a=Pe({},r.props);for(i in r.type&&r.type.defaultProps&&(o=r.type.defaultProps),e)i=="key"?n=e[i]:i=="ref"?s=e[i]:a[i]=e[i]===void 0&&o!=null?o[i]:e[i];return arguments.length>2&&(a.children=arguments.length>3?Ft.call(arguments,2):t),kt(r.type,a,n||r.key,s||r.ref,null)}function Ht(r){function e(t){var n,s;return this.getChildContext||(n=new Set,(s={})[e.__c]=this,this.getChildContext=function(){return s},this.componentWillUnmount=function(){n=null},this.shouldComponentUpdate=function(i){this.props.value!=i.value&&n.forEach(function(o){o.__e=!0,sn(o)})},this.sub=function(i){n.add(i);var o=i.componentWillUnmount;i.componentWillUnmount=function(){n&&n.delete(i),o&&o.call(i)}}),t.children}return e.__c="__cC"+Di++,e.__=r,e.Provider=e.__l=(e.Consumer=function(t,n){return t.children(n)}).contextType=e,e}Ft=Mi.slice,U={__e:function(r,e,t,n){for(var s,i,o;e=e.__;)if((s=e.__c)&&!s.__)try{if((i=s.constructor)&&i.getDerivedStateFromError!=null&&(s.setState(i.getDerivedStateFromError(r)),o=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(r,n||{}),o=s.__d),o)return s.__E=s}catch(a){r=a}throw r}},Ii=0,Ci=function(r){return r!=null&&r.constructor==null},ve.prototype.setState=function(r,e){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Pe({},this.state),typeof r=="function"&&(r=r(Pe({},t),this.props)),r&&Pe(t,r),r!=null&&this.__v&&(e&&this._sb.push(e),sn(this))},ve.prototype.forceUpdate=function(r){this.__v&&(this.__e=!0,r&&this.__h.push(r),sn(this))},ve.prototype.render=he,We=[],Ui=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ni=function(r,e){return r.__v.__b-e.__v.__b},vr.__r=0,Li=/(PointerCapture)$|Capture$/i,En=0,rn=ss(!1),nn=ss(!0),Di=0;const Ja=Object.freeze(Object.defineProperty({__proto__:null,Component:ve,Fragment:he,cloneElement:On,createContext:Ht,createElement:J,createRef:Tn,h:J,hydrate:An,get isValidElement(){return Ci},get options(){return U},render:Ke,toChildArray:me},Symbol.toStringTag,{value:"Module"}));var Va=0;function p(r,e,t,n,s,i){e||(e={});var o,a,l=e;if("ref"in l)for(a in l={},e)a=="ref"?o=e[a]:l[a]=e[a];var u={type:r,props:l,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Va,__i:-1,__u:0,__source:s,__self:i};if(typeof r=="function"&&(o=r.defaultProps))for(a in o)l[a]===void 0&&(l[a]=o[a]);return U.vnode&&U.vnode(u),u}var xe,V,Fr,is,ht=0,zi=[],Q=U,os=Q.__b,as=Q.__r,ls=Q.diffed,cs=Q.__c,us=Q.unmount,ds=Q.__;function Ye(r,e){Q.__h&&Q.__h(V,r,ht||e),ht=0;var t=V.__H||(V.__H={__:[],__h:[]});return r>=t.__.length&&t.__.push({}),t.__[r]}function C(r){return ht=1,Tr(Ji,r)}function Tr(r,e,t){var n=Ye(xe++,2);if(n.t=r,!n.__c&&(n.__=[t?t(e):Ji(void 0,e),function(a){var l=n.__N?n.__N[0]:n.__[0],u=n.t(l,a);l!==u&&(n.__N=[u,n.__[1]],n.__c.setState({}))}],n.__c=V,!V.__f)){var s=function(a,l,u){if(!n.__c.__H)return!0;var d=n.__c.__H.__.filter(function(f){return!!f.__c});if(d.every(function(f){return!f.__N}))return!i||i.call(this,a,l,u);var c=n.__c.props!==a;return d.forEach(function(f){if(f.__N){var h=f.__[0];f.__=f.__N,f.__N=void 0,h!==f.__[0]&&(c=!0)}}),i&&i.call(this,a,l,u)||c};V.__f=!0;var i=V.shouldComponentUpdate,o=V.componentWillUpdate;V.componentWillUpdate=function(a,l,u){if(this.__e){var d=i;i=void 0,s(a,l,u),i=d}o&&o.call(this,a,l,u)},V.shouldComponentUpdate=s}return n.__N||n.__}function re(r,e){var t=Ye(xe++,3);!Q.__s&&In(t.__H,e)&&(t.__=r,t.u=e,V.__H.__h.push(t))}function yt(r,e){var t=Ye(xe++,4);!Q.__s&&In(t.__H,e)&&(t.__=r,t.u=e,V.__h.push(t))}function qt(r){return ht=5,Wt(function(){return{current:r}},[])}function jn(r,e,t){ht=6,yt(function(){if(typeof r=="function"){var n=r(e());return function(){r(null),n&&typeof n=="function"&&n()}}if(r)return r.current=e(),function(){return r.current=null}},t==null?t:t.concat(r))}function Wt(r,e){var t=Ye(xe++,7);return In(t.__H,e)&&(t.__=r(),t.__H=e,t.__h=r),t.__}function ft(r,e){return ht=8,Wt(function(){return r},e)}function kr(r){var e=V.context[r.__c],t=Ye(xe++,9);return t.c=r,e?(t.__==null&&(t.__=!0,e.sub(V)),e.props.value):r.__}function Rn(r,e){Q.useDebugValue&&Q.useDebugValue(e?e(r):r)}function Ka(r){var e=Ye(xe++,10),t=C();return e.__=r,V.componentDidCatch||(V.componentDidCatch=function(n,s){e.__&&e.__(n,s),t[1](n)}),[t[0],function(){t[1](void 0)}]}function xn(){var r=Ye(xe++,11);if(!r.__){for(var e=V.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var t=e.__m||(e.__m=[0,0]);r.__="P"+t[0]+"-"+t[1]++}return r.__}function Ya(){for(var r;r=zi.shift();)if(r.__P&&r.__H)try{r.__H.__h.forEach(dr),r.__H.__h.forEach(on),r.__H.__h=[]}catch(e){r.__H.__h=[],Q.__e(e,r.__v)}}Q.__b=function(r){V=null,os&&os(r)},Q.__=function(r,e){r&&e.__k&&e.__k.__m&&(r.__m=e.__k.__m),ds&&ds(r,e)},Q.__r=function(r){as&&as(r),xe=0;var e=(V=r.__c).__H;e&&(Fr===V?(e.__h=[],V.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(e.__h.forEach(dr),e.__h.forEach(on),e.__h=[],xe=0)),Fr=V},Q.diffed=function(r){ls&&ls(r);var e=r.__c;e&&e.__H&&(e.__H.__h.length&&(zi.push(e)!==1&&is===Q.requestAnimationFrame||((is=Q.requestAnimationFrame)||Qa)(Ya)),e.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.u=void 0})),Fr=V=null},Q.__c=function(r,e){e.some(function(t){try{t.__h.forEach(dr),t.__h=t.__h.filter(function(n){return!n.__||on(n)})}catch(n){e.some(function(s){s.__h&&(s.__h=[])}),e=[],Q.__e(n,t.__v)}}),cs&&cs(r,e)},Q.unmount=function(r){us&&us(r);var e,t=r.__c;t&&t.__H&&(t.__H.__.forEach(function(n){try{dr(n)}catch(s){e=s}}),t.__H=void 0,e&&Q.__e(e,t.__v))};var hs=typeof requestAnimationFrame=="function";function Qa(r){var e,t=function(){clearTimeout(n),hs&&cancelAnimationFrame(e),setTimeout(r)},n=setTimeout(t,35);hs&&(e=requestAnimationFrame(t))}function dr(r){var e=V,t=r.__c;typeof t=="function"&&(r.__c=void 0,t()),V=e}function on(r){var e=V;r.__c=r.__(),V=e}function In(r,e){return!r||r.length!==e.length||e.some(function(t,n){return t!==r[n]})}function Ji(r,e){return typeof e=="function"?e(r):e}var Xa={};function $t(r,e){for(var t in e)r[t]=e[t];return r}function Za(r,e,t){var n,s=/(?:\?([^#]*))?(#.*)?$/,i=r.match(s),o={};if(i&&i[1])for(var a=i[1].split("&"),l=0;l<a.length;l++){var u=a[l].split("=");o[decodeURIComponent(u[0])]=decodeURIComponent(u.slice(1).join("="))}r=an(r.replace(s,"")),e=an(e||"");for(var d=Math.max(r.length,e.length),c=0;c<d;c++)if(e[c]&&e[c].charAt(0)===":"){var f=e[c].replace(/(^:|[+*?]+$)/g,""),h=(e[c].match(/[+*?]+$/)||Xa)[0]||"",v=~h.indexOf("+"),m=~h.indexOf("*"),_=r[c]||"";if(!_&&!m&&(h.indexOf("?")<0||v)){n=!1;break}if(o[f]=decodeURIComponent(_),v||m){o[f]=r.slice(c).map(decodeURIComponent).join("/");break}}else if(e[c]!==r[c]){n=!1;break}return(t.default===!0||n!==!1)&&o}function el(r,e){return r.rank<e.rank?1:r.rank>e.rank?-1:r.index-e.index}function tl(r,e){return r.index=e,r.rank=function(t){return t.props.default?0:an(t.props.path).map(rl).join("")}(r),r.props}function an(r){return r.replace(/(^\/+|\/+$)/g,"").split("/")}function rl(r){return r.charAt(0)==":"?1+"*+?".indexOf(r.charAt(r.length-1))||4:5}var nl={},Je=[],fs=[],_e=null,Vi={url:Cn()},sl=Ht(Vi);function Cn(){var r;return""+((r=_e&&_e.location?_e.location:_e&&_e.getCurrentLocation?_e.getCurrentLocation():typeof location<"u"?location:nl).pathname||"")+(r.search||"")}function pt(r,e){return e===void 0&&(e=!1),typeof r!="string"&&r.url&&(e=r.replace,r=r.url),function(t){for(var n=Je.length;n--;)if(Je[n].canRoute(t))return!0;return!1}(r)&&function(t,n){n===void 0&&(n="push"),_e&&_e[n]?_e[n](t):typeof history<"u"&&history[n+"State"]&&history[n+"State"](null,null,t)}(r,e?"replace":"push"),Ki(r)}function Ki(r){for(var e=!1,t=0;t<Je.length;t++)Je[t].routeTo(r)&&(e=!0);return e}function il(r){if(r&&r.getAttribute){var e=r.getAttribute("href"),t=r.getAttribute("target");if(e&&e.match(/^\//g)&&(!t||t.match(/^_?self$/i)))return pt(e)}}function ol(r){return r.stopImmediatePropagation&&r.stopImmediatePropagation(),r.stopPropagation&&r.stopPropagation(),r.preventDefault(),!1}function Yi(r){if(!(r.ctrlKey||r.metaKey||r.altKey||r.shiftKey||r.button)){var e=r.target;do if(e.localName==="a"&&e.getAttribute("href")){if(e.hasAttribute("data-native")||e.hasAttribute("native"))return;if(il(e))return ol(r)}while(e=e.parentNode)}}var ps=!1;function Qi(r){r.history&&(_e=r.history),this.state={url:r.url||Cn()}}$t(Qi.prototype=new ve,{shouldComponentUpdate:function(r){return r.static!==!0||r.url!==this.props.url||r.onChange!==this.props.onChange},canRoute:function(r){var e=me(this.props.children);return this.g(e,r)!==void 0},routeTo:function(r){this.setState({url:r});var e=this.canRoute(r);return this.p||this.forceUpdate(),e},componentWillMount:function(){this.p=!0},componentDidMount:function(){var r=this;ps||(ps=!0,_e||addEventListener("popstate",function(){Ki(Cn())}),addEventListener("click",Yi)),Je.push(this),_e&&(this.u=_e.listen(function(e){var t=e.location||e;r.routeTo(""+(t.pathname||"")+(t.search||""))})),this.p=!1},componentWillUnmount:function(){typeof this.u=="function"&&this.u(),Je.splice(Je.indexOf(this),1)},componentWillUpdate:function(){this.p=!0},componentDidUpdate:function(){this.p=!1},g:function(r,e){r=r.filter(tl).sort(el);for(var t=0;t<r.length;t++){var n=r[t],s=Za(e,n.props.path,n.props);if(s)return[n,s]}},render:function(r,e){var t,n,s=r.onChange,i=e.url,o=this.c,a=this.g(me(r.children),i);if(a&&(n=On(a[0],$t($t({url:i,matches:t=a[1]},t),{key:void 0,ref:void 0}))),i!==(o&&o.url)){$t(Vi,o=this.c={url:i,previous:o&&o.url,current:n,path:n?n.props.path:null,matches:t}),o.router=this,o.active=n?[n]:[];for(var l=fs.length;l--;)fs[l]({});typeof s=="function"&&s(o)}return J(sl.Provider,{value:o},n)}});var Be=function(r){return J("a",$t({onClick:Yi},r))};function gr(){return gr=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},gr.apply(null,arguments)}var lt;(function(r){r.Pop="POP",r.Push="PUSH",r.Replace="REPLACE"})(lt||(lt={}));var _s=function(r){return r},vs="beforeunload",al="hashchange",ll="popstate";function cl(r){r===void 0&&(r={});var e=r,t=e.window,n=t===void 0?document.defaultView:t,s=n.history;function i(){var T=ms(n.location.hash.substr(1)),R=T.pathname,q=R===void 0?"/":R,L=T.search,Y=L===void 0?"":L,le=T.hash,ge=le===void 0?"":le,fe=s.state||{};return[fe.idx,_s({pathname:q,search:Y,hash:ge,state:fe.usr||null,key:fe.key||"default"})]}var o=null;function a(){if(o)h.call(o),o=null;else{var T=lt.Pop,R=i(),q=R[0],L=R[1];if(h.length){if(q!=null){var Y=d-q;Y&&(o={action:T,location:L,retry:function(){E(Y*-1)}},E(Y))}}else w(T)}}n.addEventListener(ll,a),n.addEventListener(al,function(){var T=i(),R=T[1];Br(R)!==Br(c)&&a()});var l=lt.Pop,u=i(),d=u[0],c=u[1],f=ys(),h=ys();d==null&&(d=0,s.replaceState(gr({},s.state,{idx:d}),""));function v(){var T=document.querySelector("base"),R="";if(T&&T.getAttribute("href")){var q=n.location.href,L=q.indexOf("#");R=L===-1?q:q.slice(0,L)}return R}function m(T){return v()+"#"+(typeof T=="string"?T:Br(T))}function _(T,R){return R===void 0&&(R=null),_s(gr({pathname:c.pathname,hash:"",search:""},typeof T=="string"?ms(T):T,{state:R,key:ul()}))}function b(T,R){return[{usr:T.state,key:T.key,idx:R},m(T)]}function y(T,R,q){return!h.length||(h.call({action:T,location:R,retry:q}),!1)}function w(T){l=T;var R=i();d=R[0],c=R[1],f.call({action:l,location:c})}function A(T,R){var q=lt.Push,L=_(T,R);function Y(){A(T,R)}if(y(q,L,Y)){var le=b(L,d+1),ge=le[0],fe=le[1];try{s.pushState(ge,"",fe)}catch{n.location.assign(fe)}w(q)}}function O(T,R){var q=lt.Replace,L=_(T,R);function Y(){O(T,R)}if(y(q,L,Y)){var le=b(L,d),ge=le[0],fe=le[1];s.replaceState(ge,"",fe),w(q)}}function E(T){s.go(T)}var H={get action(){return l},get location(){return c},createHref:m,push:A,replace:O,go:E,back:function(){E(-1)},forward:function(){E(1)},listen:function(R){return f.push(R)},block:function(R){var q=h.push(R);return h.length===1&&n.addEventListener(vs,gs),function(){q(),h.length||n.removeEventListener(vs,gs)}}};return H}function gs(r){r.preventDefault(),r.returnValue=""}function ys(){var r=[];return{get length(){return r.length},push:function(t){return r.push(t),function(){r=r.filter(function(n){return n!==t})}},call:function(t){r.forEach(function(n){return n&&n(t)})}}}function ul(){return Math.random().toString(36).substr(2,8)}function Br(r){var e=r.pathname,t=e===void 0?"/":e,n=r.search,s=n===void 0?"":n,i=r.hash,o=i===void 0?"":i;return s&&s!=="?"&&(t+=s.charAt(0)==="?"?s:"?"+s),o&&o!=="#"&&(t+=o.charAt(0)==="#"?o:"#"+o),t}function ms(r){var e={};if(r){var t=r.indexOf("#");t>=0&&(e.hash=r.substr(t),r=r.substr(0,t));var n=r.indexOf("?");n>=0&&(e.search=r.substr(n),r=r.substr(0,n)),r&&(e.pathname=r)}return e}const dl="modulepreload",hl=function(r){return"/"+r},bs={},Gt=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(t.map(l=>{if(l=hl(l),l in bs)return;bs[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const c=document.createElement("link");if(c.rel=u?"stylesheet":dl,u||(c.as="script"),c.crossOrigin="",c.href=l,a&&c.setAttribute("nonce",a),document.head.appendChild(c),u)return new Promise((f,h)=>{c.addEventListener("load",f),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},fl=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Gt(async()=>{const{default:n}=await Promise.resolve().then(()=>mt);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};class Un extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class pl extends Un{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ws extends Un{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ss extends Un{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ln;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(ln||(ln={}));var _l=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};class vl{constructor(e,{headers:t={},customFetch:n,region:s=ln.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=fl(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n;return _l(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=t;let a={},{region:l}=t;l||(l=this.region);const u=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,u.searchParams.set("forceFunctionRegion",l));let d;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",d=o):typeof o=="string"?(a["Content-Type"]="text/plain",d=o):typeof FormData<"u"&&o instanceof FormData?d=o:(a["Content-Type"]="application/json",d=JSON.stringify(o)));const c=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:d}).catch(m=>{throw new pl(m)}),f=c.headers.get("x-relay-error");if(f&&f==="true")throw new ws(c);if(!c.ok)throw new Ss(c);let h=((n=c.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),v;return h==="application/json"?v=yield c.json():h==="application/octet-stream"?v=yield c.blob():h==="text/event-stream"?v=c:h==="multipart/form-data"?v=yield c.formData():v=yield c.text(),{data:v,error:null,response:c}}catch(s){return{data:null,error:s,response:s instanceof Ss||s instanceof ws?s.context:void 0}}})}}var be=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xi(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Nn(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var s=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:function(){return r[n]}})}),t}var de={},Ln={},Pr={},zt={},Ar={},Or={},gl=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},_t=gl();const yl=_t.fetch,Zi=_t.fetch.bind(_t),eo=_t.Headers,ml=_t.Request,bl=_t.Response,mt=Object.freeze(Object.defineProperty({__proto__:null,Headers:eo,Request:ml,Response:bl,default:Zi,fetch:yl},Symbol.toStringTag,{value:"Module"})),wl=Nn(mt);var jr={};Object.defineProperty(jr,"__esModule",{value:!0});let Sl=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};jr.default=Sl;var to=be&&be.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Or,"__esModule",{value:!0});const El=to(wl),$l=to(jr);let Tl=class{constructor(e){var t,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(n=e.isMaybeSingle)!==null&&n!==void 0?n:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=El.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,a,l,u;let d=null,c=null,f=null,h=i.status,v=i.statusText;if(i.ok){if(this.method!=="HEAD"){const y=await i.text();y===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?c=y:c=JSON.parse(y))}const _=(a=this.headers.get("Prefer"))===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),b=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");_&&b&&b.length>1&&(f=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(d={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,f=null,h=406,v="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const _=await i.text();try{d=JSON.parse(_),Array.isArray(d)&&i.status===404&&(c=[],d=null,h=200,v="OK")}catch{i.status===404&&_===""?(h=204,v="No Content"):d={message:_}}if(d&&this.isMaybeSingle&&(!((u=d==null?void 0:d.details)===null||u===void 0)&&u.includes("0 rows"))&&(d=null,h=200,v="OK"),d&&this.shouldThrowOnError)throw new $l.default(d)}return{error:d,data:c,count:f,status:h,statusText:v}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,a,l;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(a=i==null?void 0:i.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}};Or.default=Tl;var kl=be&&be.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ar,"__esModule",{value:!0});const Pl=kl(Or);let Al=class extends Pl.default{select(e){let t=!1;const n=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:n=t}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var a;const l=[e?"analyze":null,t?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${u}"; options=${l};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};Ar.default=Al;var Ol=be&&be.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(zt,"__esModule",{value:!0});const jl=Ol(Ar);let Rl=class extends jl.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const n=Array.from(new Set(t)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${i}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,n])=>{this.url.searchParams.append(t,`eq.${n}`)}),this}not(e,t,n){return this.url.searchParams.append(e,`not.${t}.${n}`),this}or(e,{foreignTable:t,referencedTable:n=t}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,n){return this.url.searchParams.append(e,`${t}.${n}`),this}};zt.default=Rl;var xl=be&&be.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Pr,"__esModule",{value:!0});const Et=xl(zt);let Il=class{constructor(e,{headers:t={},schema:n,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=n,this.fetch=s}select(e,{head:t=!1,count:n}={}){const s=t?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),n&&this.headers.append("Prefer",`count=${n}`),new Et.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:n=!0}={}){var s;const i="POST";if(t&&this.headers.append("Prefer",`count=${t}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){const a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new Et.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){var o;const a="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),s&&this.headers.append("Prefer",`count=${s}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(l.length>0){const u=[...new Set(l)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new Et.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:t}={}){var n;const s="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Et.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:e}={}){var t;const n="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Et.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}};Pr.default=Il;var ro=be&&be.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ln,"__esModule",{value:!0});const Cl=ro(Pr),Ul=ro(zt);let Nl=class no{constructor(e,{headers:t={},schema:n,fetch:s}={}){this.url=e,this.headers=new Headers(t),this.schemaName=n,this.fetch=s}from(e){const t=new URL(`${this.url}/${e}`);return new Cl.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new no(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:n=!1,get:s=!1,count:i}={}){var o;let a;const l=new URL(`${this.url}/rpc/${e}`);let u;n||s?(a=n?"HEAD":"GET",Object.entries(t).filter(([c,f])=>f!==void 0).map(([c,f])=>[c,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([c,f])=>{l.searchParams.append(c,f)})):(a="POST",u=t);const d=new Headers(this.headers);return i&&d.set("Prefer",`count=${i}`),new Ul.default({method:a,url:l,headers:d,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};Ln.default=Nl;var bt=be&&be.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(de,"__esModule",{value:!0});de.PostgrestError=de.PostgrestBuilder=de.PostgrestTransformBuilder=de.PostgrestFilterBuilder=de.PostgrestQueryBuilder=de.PostgrestClient=void 0;const so=bt(Ln);de.PostgrestClient=so.default;const io=bt(Pr);de.PostgrestQueryBuilder=io.default;const oo=bt(zt);de.PostgrestFilterBuilder=oo.default;const ao=bt(Ar);de.PostgrestTransformBuilder=ao.default;const lo=bt(Or);de.PostgrestBuilder=lo.default;const co=bt(jr);de.PostgrestError=co.default;var Ll=de.default={PostgrestClient:so.default,PostgrestQueryBuilder:io.default,PostgrestFilterBuilder:oo.default,PostgrestTransformBuilder:ao.default,PostgrestBuilder:lo.default,PostgrestError:co.default};const{PostgrestClient:Dl,PostgrestQueryBuilder:v_,PostgrestFilterBuilder:g_,PostgrestTransformBuilder:y_,PostgrestBuilder:m_,PostgrestError:b_}=Ll;function Ml(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Fl=Ml(),Bl="2.11.15",Hl=`realtime-js/${Bl}`,ql="1.0.0",uo=1e4,Wl=1e3;var Pt;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(Pt||(Pt={}));var ae;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(ae||(ae={}));var $e;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})($e||($e={}));var cn;(function(r){r.websocket="websocket"})(cn||(cn={}));var Ge;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(Ge||(Ge={}));class Gl{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const s=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=n.decode(e.slice(o,o+s));o=o+s;const l=n.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:u}}}class ho{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var K;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(K||(K={}));const Es=(r,e,t={})=>{var n;const s=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((i,o)=>(i[o]=zl(o,r,e,s),i),{})},zl=(r,e,t,n)=>{const s=e.find(a=>a.name===r),i=s==null?void 0:s.type,o=t[r];return i&&!n.includes(i)?fo(i,o):un(o)},fo=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return Yl(e,t)}switch(r){case K.bool:return Jl(e);case K.float4:case K.float8:case K.int2:case K.int4:case K.int8:case K.numeric:case K.oid:return Vl(e);case K.json:case K.jsonb:return Kl(e);case K.timestamp:return Ql(e);case K.abstime:case K.date:case K.daterange:case K.int4range:case K.int8range:case K.money:case K.reltime:case K.text:case K.time:case K.timestamptz:case K.timetz:case K.tsrange:case K.tstzrange:return un(e);default:return un(e)}},un=r=>r,Jl=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Vl=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},Kl=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},Yl=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,n=r[t];if(r[0]==="{"&&n==="}"){let i;const o=r.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>fo(e,a))}return r},Ql=r=>typeof r=="string"?r.replace(" ","T"):r,po=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Hr{constructor(e,t,n={},s=uo){this.channel=e,this.event=t,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var $s;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})($s||($s={}));class At{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=At.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=At.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=At.syncDiff(this.state,s,i,o),a())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,s){const i=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(i,(u,d)=>{o[u]||(l[u]=d)}),this.map(o,(u,d)=>{const c=i[u];if(c){const f=d.map(_=>_.presence_ref),h=c.map(_=>_.presence_ref),v=d.filter(_=>h.indexOf(_.presence_ref)<0),m=c.filter(_=>f.indexOf(_.presence_ref)<0);v.length>0&&(a[u]=v),m.length>0&&(l[u]=m)}else a[u]=d}),this.syncDiff(i,{joins:a,leaves:l},n,s)}static syncDiff(e,t,n,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{var u;const d=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(l),d.length>0){const c=e[a].map(h=>h.presence_ref),f=d.filter(h=>c.indexOf(h.presence_ref)<0);e[a].unshift(...f)}n(a,d,l)}),this.map(o,(a,l)=>{let u=e[a];if(!u)return;const d=l.map(c=>c.presence_ref);u=u.filter(c=>d.indexOf(c.presence_ref)<0),e[a]=u,s(a,u,l),u.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const s=e[n];return"metas"in s?t[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[n]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ts;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Ts||(Ts={}));var ks;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(ks||(ks={}));var je;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(je||(je={}));class Dn{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=ae.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Hr(this,$e.join,this.params,this.timeout),this.rejoinTimer=new ho(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ae.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ae.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ae.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ae.errored,this.rejoinTimer.scheduleTimeout())}),this._on($e.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new At(this),this.broadcastEndpointURL=po(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==ae.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(d=>e==null?void 0:e(je.CHANNEL_ERROR,d)),this._onClose(()=>e==null?void 0:e(je.CLOSED));const l={},u={broadcast:i,presence:o,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&s!==void 0?s:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:d})=>{var c;if(this.socket.setAuth(),d===void 0){e==null||e(je.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,h=(c=f==null?void 0:f.length)!==null&&c!==void 0?c:0,v=[];for(let m=0;m<h;m++){const _=f[m],{filter:{event:b,schema:y,table:w,filter:A}}=_,O=d&&d[m];if(O&&O.event===b&&O.schema===y&&O.table===w&&O.filter===A)v.push(Object.assign(Object.assign({},_),{id:O.id}));else{this.unsubscribe(),this.state=ae.errored,e==null||e(je.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(je.SUBSCRIBED);return}}).receive("error",d=>{this.state=ae.errored,e==null||e(je.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(je.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e,t={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ae.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger($e.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Hr(this,$e.leave,{},e),n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),o}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Hr(this,e,t,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var s,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:u,join:d}=$e;if(n&&[a,l,u,d].indexOf(o)>=0&&n!==this._joinRef())return;let f=this._onMessage(o,t,n);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(h=>{var v,m,_;return((v=h.filter)===null||v===void 0?void 0:v.event)==="*"||((_=(m=h.filter)===null||m===void 0?void 0:m.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===o}).map(h=>h.callback(f,n)):(i=this.bindings[o])===null||i===void 0||i.filter(h=>{var v,m,_,b,y,w;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in h){const A=h.id,O=(v=h.filter)===null||v===void 0?void 0:v.event;return A&&((m=t.ids)===null||m===void 0?void 0:m.includes(A))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((_=t.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const A=(y=(b=h==null?void 0:h.filter)===null||b===void 0?void 0:b.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return A==="*"||A===((w=t==null?void 0:t.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===o}).map(h=>{if(typeof f=="object"&&"ids"in f){const v=f.data,{schema:m,table:_,commit_timestamp:b,type:y,errors:w}=v;f=Object.assign(Object.assign({},{schema:m,table:_,commit_timestamp:b,eventType:y,new:{},old:{},errors:w}),this._getPayloadRecords(v))}h.callback(f,n)})}_isClosed(){return this.state===ae.closed}_isJoined(){return this.state===ae.joined}_isJoining(){return this.state===ae.joining}_isLeaving(){return this.state===ae.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Dn.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on($e.close,{},e)}_onError(e){this._on($e.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ae.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Es(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Es(e.columns,e.old_record)),t}}const Ps=()=>{},Xl=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Zl{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=uo,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ps,this.ref=0,this.logger=Ps,this.conn=null,this.sendBuffer=[],this.serializer=new Gl,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>Gt(async()=>{const{default:l}=await Promise.resolve().then(()=>mt);return{default:l}},void 0).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${cn.websocket}`,this.httpEndpoint=po(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(n=t==null?void 0:t.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,o)=>o(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ho(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Fl),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ql}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Pt.connecting:return Ge.Connecting;case Pt.open:return Ge.Open;case Pt.closing:return Ge.Closing;default:return Ge.Closed}}isConnected(){return this.connectionState()===Ge.Open}channel(e,t={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new Dn(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:n,payload:s,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${n} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const s={access_token:t,version:Hl};t&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push($e.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Wl,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:n,event:s,payload:i,ref:o}=t;n==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(a=>a._isMember(n)).forEach(a=>a._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger($e.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${n}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([Xl],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}}class Mn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function se(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class ec extends Mn{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class dn extends Mn{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var tc=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};const _o=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Gt(async()=>{const{default:n}=await Promise.resolve().then(()=>mt);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},rc=()=>tc(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Gt(()=>Promise.resolve().then(()=>mt),void 0)).Response:Response}),hn=r=>{if(Array.isArray(r))return r.map(t=>hn(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,n])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=hn(n)}),e};var Qe=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};const qr=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),nc=(r,e,t)=>Qe(void 0,void 0,void 0,function*(){const n=yield rc();r instanceof n&&!(t!=null&&t.noResolveJson)?r.json().then(s=>{e(new ec(qr(s),r.status||500))}).catch(s=>{e(new dn(qr(s),s))}):e(new dn(qr(r),r))}),sc=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),t))};function Jt(r,e,t,n,s,i){return Qe(this,void 0,void 0,function*(){return new Promise((o,a)=>{r(t,sc(e,n,s,i)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>nc(l,a,n))})})}function yr(r,e,t,n){return Qe(this,void 0,void 0,function*(){return Jt(r,"GET",e,t,n)})}function Ue(r,e,t,n,s){return Qe(this,void 0,void 0,function*(){return Jt(r,"POST",e,n,s,t)})}function ic(r,e,t,n,s){return Qe(this,void 0,void 0,function*(){return Jt(r,"PUT",e,n,s,t)})}function oc(r,e,t,n){return Qe(this,void 0,void 0,function*(){return Jt(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function vo(r,e,t,n,s){return Qe(this,void 0,void 0,function*(){return Jt(r,"DELETE",e,n,s,t)})}var ue=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};const ac={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},As={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class lc{constructor(e,t={},n,s){this.url=e,this.headers=t,this.bucketId=n,this.fetch=_o(s)}uploadOrUpdate(e,t,n,s){return ue(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},As),s);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(a=Object.assign(Object.assign({},a),s.headers));const u=this._removeEmptyFolders(t),d=this._getFinalPath(u),c=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:e,body:i,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),f=yield c.json();return c.ok?{data:{path:u,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(i){if(se(i))return{data:null,error:i};throw i}})}upload(e,t,n){return ue(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,s){return ue(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let l;const u=Object.assign({upsert:As.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const c=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:d}),f=yield c.json();return c.ok?{data:{path:i,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(se(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return ue(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const i=yield Ue(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new Mn("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}})}update(e,t,n){return ue(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return ue(this,void 0,void 0,function*(){try{return{data:yield Ue(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}})}copy(e,t,n){return ue(this,void 0,void 0,function*(){try{return{data:{path:(yield Ue(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,n){return ue(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield Ue(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,n){return ue(this,void 0,void 0,function*(){try{const s=yield Ue(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}})}download(e,t){return ue(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield yr(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(se(a))return{data:null,error:a};throw a}})}info(e){return ue(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield yr(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:hn(n),error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}})}exists(e){return ue(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield oc(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(se(n)&&n instanceof dn){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&s.push(l);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${u}`)}}}remove(e){return ue(this,void 0,void 0,function*(){try{return{data:yield vo(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(se(t))return{data:null,error:t};throw t}})}list(e,t,n){return ue(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},ac),t),{prefix:e||""});return{data:yield Ue(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const cc="2.7.1",uc={"X-Client-Info":`storage-js/${cc}`};var et=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};class dc{constructor(e,t={},n){this.url=e,this.headers=Object.assign(Object.assign({},uc),t),this.fetch=_o(n)}listBuckets(){return et(this,void 0,void 0,function*(){try{return{data:yield yr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(se(e))return{data:null,error:e};throw e}})}getBucket(e){return et(this,void 0,void 0,function*(){try{return{data:yield yr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(se(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return et(this,void 0,void 0,function*(){try{return{data:yield Ue(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}})}updateBucket(e,t){return et(this,void 0,void 0,function*(){try{return{data:yield ic(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}})}emptyBucket(e){return et(this,void 0,void 0,function*(){try{return{data:yield Ue(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(se(t))return{data:null,error:t};throw t}})}deleteBucket(e){return et(this,void 0,void 0,function*(){try{return{data:yield vo(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(se(t))return{data:null,error:t};throw t}})}}class hc extends dc{constructor(e,t={},n){super(e,t,n)}from(e){return new lc(this.url,this.headers,e,this.fetch)}}const fc="2.50.4";let Tt="";typeof Deno<"u"?Tt="deno":typeof document<"u"?Tt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Tt="react-native":Tt="node";const pc={"X-Client-Info":`supabase-js-${Tt}/${fc}`},_c={headers:pc},vc={schema:"public"},gc={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},yc={};var mc=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};const bc=r=>{let e;return r?e=r:typeof fetch>"u"?e=Zi:e=fetch,(...t)=>e(...t)},wc=()=>typeof Headers>"u"?eo:Headers,Sc=(r,e,t)=>{const n=bc(t),s=wc();return(i,o)=>mc(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:r;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",r),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},o),{headers:u}))})};var Ec=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};function $c(r){return r.endsWith("/")?r:r+"/"}function Tc(r,e){var t,n;const{db:s,auth:i,realtime:o,global:a}=r,{db:l,auth:u,realtime:d,global:c}=e,f={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},d),o),global:Object.assign(Object.assign(Object.assign({},c),a),{headers:Object.assign(Object.assign({},(t=c==null?void 0:c.headers)!==null&&t!==void 0?t:{}),(n=a==null?void 0:a.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>Ec(this,void 0,void 0,function*(){return""})};return r.accessToken?f.accessToken=r.accessToken:delete f.accessToken,f}const go="2.70.0",ot=30*1e3,fn=3,Wr=fn*ot,kc="http://localhost:9999",Pc="supabase.auth.token",Ac={"X-Client-Info":`gotrue-js/${go}`},pn="X-Supabase-Api-Version",yo={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Oc=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,jc=6e5;class Fn extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function I(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class Rc extends Fn{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function xc(r){return I(r)&&r.name==="AuthApiError"}class mo extends Fn{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class De extends Fn{constructor(e,t,n,s){super(e,n,s),this.name=t,this.status=n}}class Ce extends De{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ic(r){return I(r)&&r.name==="AuthSessionMissingError"}class ir extends De{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class or extends De{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ar extends De{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Cc(r){return I(r)&&r.name==="AuthImplicitGrantRedirectError"}class Os extends De{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class _n extends De{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Gr(r){return I(r)&&r.name==="AuthRetryableFetchError"}class js extends De{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class Ot extends De{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const mr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Rs=` 	
\r=`.split(""),Uc=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<Rs.length;e+=1)r[Rs[e].charCodeAt(0)]=-2;for(let e=0;e<mr.length;e+=1)r[mr[e].charCodeAt(0)]=e;return r})();function xs(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(mr[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(mr[n]),e.queuedBits-=6}}function bo(r,e,t){const n=Uc[r];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function Is(r){const e=[],t=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{Dc(o,n,t)};for(let o=0;o<r.length;o+=1)bo(r.charCodeAt(o),s,i);return e.join("")}function Nc(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function Lc(r,e){for(let t=0;t<r.length;t+=1){let n=r.charCodeAt(t);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(r.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}Nc(n,e)}}function Dc(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let n=1;n<6;n+=1)if(!(r>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Mc(r){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<r.length;s+=1)bo(r.charCodeAt(s),t,n);return new Uint8Array(e)}function Fc(r){const e=[];return Lc(r,t=>e.push(t)),new Uint8Array(e)}function Bc(r){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};return r.forEach(s=>xs(s,t,n)),xs(null,t,n),e.join("")}function Hc(r){return Math.round(Date.now()/1e3)+r}function qc(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const Ee=()=>typeof window<"u"&&typeof document<"u",He={tested:!1,writable:!1},jt=()=>{if(!Ee())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(He.tested)return He.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),He.tested=!0,He.writable=!0}catch{He.tested=!0,He.writable=!1}return He.writable};function Wc(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((n,s)=>{e[s]=n}),e}const wo=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Gt(async()=>{const{default:n}=await Promise.resolve().then(()=>mt);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},Gc=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",So=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},lr=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},cr=async(r,e)=>{await r.removeItem(e)};class Rr{constructor(){this.promise=new Rr.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Rr.promiseConstructor=Promise;function zr(r){const e=r.split(".");if(e.length!==3)throw new Ot("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!Oc.test(e[n]))throw new Ot("JWT not in base64url format");return{header:JSON.parse(Is(e[0])),payload:JSON.parse(Is(e[1])),signature:Mc(e[2]),raw:{header:e[0],payload:e[1]}}}async function zc(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Jc(r,e){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await r(i);if(!e(i,null,o)){n(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function Vc(r){return("0"+r.toString(16)).substr(-2)}function Kc(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,Vc).join("")}async function Yc(r){const t=new TextEncoder().encode(r),n=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function Qc(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Yc(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function tt(r,e,t=!1){const n=Kc();let s=n;t&&(s+="/PASSWORD_RECOVERY"),await So(r,`${e}-code-verifier`,s);const i=await Qc(n);return[i,n===i?"plain":"s256"]}const Xc=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Zc(r){const e=r.headers.get(pn);if(!e||!e.match(Xc))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function eu(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function tu(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ru=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function rt(r){if(!ru.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var nu=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t};const qe=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),su=[502,503,504];async function Cs(r){var e;if(!Gc(r))throw new _n(qe(r),0);if(su.includes(r.status))throw new _n(qe(r),r.status);let t;try{t=await r.json()}catch(i){throw new mo(qe(i),i)}let n;const s=Zc(r);if(s&&s.getTime()>=yo["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new js(qe(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Ce}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new js(qe(t),r.status,t.weak_password.reasons);throw new Rc(qe(t),r.status||500,n)}const iu=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),t))};async function M(r,e,t,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[pn]||(i[pn]=yo["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await ou(r,e,t+a,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function ou(r,e,t,n,s,i){const o=iu(e,n,s,i);let a;try{a=await r(t,Object.assign({},o))}catch(l){throw console.error(l),new _n(qe(l),0)}if(a.ok||await Cs(a),n!=null&&n.noResolveJson)return a;try{return await a.json()}catch(l){await Cs(l)}}function Oe(r){var e;let t=null;uu(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=Hc(r.expires_in)));const n=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:n},error:null}}function Us(r){const e=Oe(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=r.weak_password),e}function Ne(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function au(r){return{data:r,error:null}}function lu(r){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:i}=r,o=nu(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function cu(r){return r}function uu(r){return r.access_token&&r.refresh_token&&r.expires_in}const Jr=["global","local","others"];var du=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t};class hu{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=wo(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Jr[0]){if(Jr.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Jr.join(", ")}`);try{return await M(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(I(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await M(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Ne})}catch(n){if(I(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=du(e,["options"]),s=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await M(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:lu,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(I(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await M(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ne})}catch(t){if(I(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,s,i,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},d=await M(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:cu});if(d.error)throw d.error;const c=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(l=(a=d.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(v=>{const m=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(v.split(";")[1].split("=")[1]);u[`${_}Page`]=m}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},c),u),error:null}}catch(u){if(I(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){rt(e);try{return await M(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ne})}catch(t){if(I(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){rt(e);try{return await M(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Ne})}catch(n){if(I(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){rt(e);try{return await M(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Ne})}catch(n){if(I(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){rt(e.userId);try{const{data:t,error:n}=await M(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:n}}catch(t){if(I(t))return{data:null,error:t};throw t}}async _deleteFactor(e){rt(e.userId),rt(e.id);try{return{data:await M(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(I(t))return{data:null,error:t};throw t}}}const fu={getItem:r=>jt()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{jt()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{jt()&&globalThis.localStorage.removeItem(r)}};function Ns(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function pu(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const nt={debug:!!(globalThis&&jt()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Eo extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class _u extends Eo{}async function vu(r,e,t){nt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),nt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){nt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,s.name);try{return await t()}finally{nt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,s.name)}}else{if(e===0)throw nt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new _u(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(nt.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}pu();const gu={url:kc,storageKey:Pc,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ac,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ls(r,e,t){return await t()}class Ut{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ut.nextInstanceID,Ut.nextInstanceID+=1,this.instanceID>0&&Ee()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},gu),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new hu({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=wo(s.fetch),this.lock=s.lock||Ls,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Ee()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=vu:this.lock=Ls,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:jt()?this.storage=fu:(this.memoryStorage={},this.storage=Ns(this.memoryStorage)):(this.memoryStorage={},this.storage=Ns(this.memoryStorage)),Ee()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${go}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Wc(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),Ee()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Cc(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return I(t)?{error:t}:{error:new mo("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,s;try{const i=await M(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:Oe}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(I(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,n,s;try{let i;if("email"in e){const{email:d,password:c,options:f}=e;let h=null,v=null;this.flowType==="pkce"&&([h,v]=await tt(this.storage,this.storageKey)),i=await M(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:c,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:h,code_challenge_method:v},xform:Oe})}else if("phone"in e){const{phone:d,password:c,options:f}=e;i=await M(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:c,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Oe})}else throw new or("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(I(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:a}=e;t=await M(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Us})}else if("phone"in e){const{phone:i,password:o,options:a}=e;t=await M(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Us})}else throw new or("You must provide either an email or phone number and a password");const{data:n,error:s}=t;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new ir}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(t){if(I(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,n,s,i,o,a,l,u,d,c,f,h;let v,m;if("message"in e)v=e.message,m=e.signature;else{const{chain:_,wallet:b,statement:y,options:w}=e;let A;if(Ee())if(typeof b=="object")A=b;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))A=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");A=b}const O=new URL((t=w==null?void 0:w.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in A&&A.signIn){const E=await A.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),y?{statement:y}:null));let H;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")H=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)H=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in H&&"signature"in H&&(typeof H.signedMessage=="string"||H.signedMessage instanceof Uint8Array)&&H.signature instanceof Uint8Array)v=typeof H.signedMessage=="string"?H.signedMessage:new TextDecoder().decode(H.signedMessage),m=H.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in A)||typeof A.signMessage!="function"||!("publicKey"in A)||typeof A!="object"||!A.publicKey||!("toBase58"in A.publicKey)||typeof A.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${O.host} wants you to sign in with your Solana account:`,A.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(s=(n=w==null?void 0:w.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((u=w==null?void 0:w.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((c=(d=w==null?void 0:w.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||c===void 0)&&c.length?["Resources",...w.signInWithSolana.resources.map(H=>`- ${H}`)]:[]].join(`
`);const E=await A.signMessage(new TextEncoder().encode(v),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=E}}try{const{data:_,error:b}=await M(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Bc(m)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=e.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Oe});if(b)throw b;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new ir}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:b})}catch(_){if(I(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(e){const t=await lr(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(t??"").split("/");try{const{data:i,error:o}=await M(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Oe});if(await cr(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new ir}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(I(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:n,token:s,access_token:i,nonce:o}=e,a=await M(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Oe}),{data:l,error:u}=a;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new ir}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(t){if(I(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,s,i,o;try{if("email"in e){const{email:a,options:l}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await tt(this.storage,this.storageKey));const{error:c}=await M(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:c}}if("phone"in e){const{phone:a,options:l}=e,{data:u,error:d}=await M(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new or("You must provide either an email or phone number.")}catch(a){if(I(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,n;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:a}=await M(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Oe});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(I(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,n,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await tt(this.storage,this.storageKey)),await M(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:au})}catch(i){if(I(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Ce;const{error:s}=await M(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(I(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:i}=e,{error:o}=await M(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:s,options:i}=e,{data:o,error:a}=await M(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new or("You must provide either an email or phone number and a type")}catch(t){if(I(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await lr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Wr:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,d)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,d))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await M(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ne}):await this._useSession(async t=>{var n,s,i;const{data:o,error:a}=t;if(a)throw a;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ce}:await M(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Ne})})}catch(t){if(I(t))return Ic(t)&&(await this._removeSession(),await cr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Ce;const o=s.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await tt(this.storage,this.storageKey));const{data:u,error:d}=await M(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Ne});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(I(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ce;const t=Date.now()/1e3;let n=t,s=!0,i=null;const{payload:o}=zr(e.access_token);if(o.exp&&(n=o.exp,s=n<=t),s){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(I(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:o,error:a}=t;if(a)throw a;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Ce;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(I(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Ee())throw new ar("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ar(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Os("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ar("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Os("No code detected.");const{data:y,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const A=new URL(window.location.href);return A.searchParams.delete("code"),window.history.replaceState(window.history.state,"",A.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:u}=e;if(!i||!a||!o||!u)throw new ar("No session defined in URL");const d=Math.round(Date.now()/1e3),c=parseInt(a);let f=d+c;l&&(f=parseInt(l));const h=f-d;h*1e3<=ot&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${c}s`);const v=f-c;d-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,f,d):d-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,f,d);const{data:m,error:_}=await this._getUser(i);if(_)throw _;const b={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:c,expires_at:f,refresh_token:o,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(n){if(I(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await lr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:s,error:i}=t;if(i)return{error:i};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(xc(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await cr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=qc(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,s;try{const{data:{session:i},error:o}=t;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await tt(this.storage,this.storageKey,!0));try{return await M(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(I(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(I(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:s}=await this._useSession(async i=>{var o,a,l,u,d;const{data:c,error:f}=i;if(f)throw f;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await M(this.fetch,"GET",h,{headers:this.headers,jwt:(d=(u=c.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return Ee()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(I(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,s;const{data:i,error:o}=t;if(o)throw o;return await M(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(I(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await Jc(async s=>(s>0&&await zc(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await M(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Oe})),(s,i)=>{const o=200*Math.pow(2,s);return i&&Gr(i)&&Date.now()+o-n<ot})}catch(n){if(this._debug(t,"error",n),I(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),Ee()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await lr(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n)){this._debug(t,"session is not valid"),n!==null&&await this._removeSession();return}const s=((e=n.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<Wr;if(this._debug(t,`session has${s?"":" not"} expired with margin of ${Wr}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),Gr(i)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(t,"error",n),console.error(n);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Ce;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Rr;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Ce;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(s,"error",i),I(i)){const o={session:null,error:i};return Gr(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await So(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await cr(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ee()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ot);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/ot);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${ot}ms, refresh threshold is ${fn} ticks`),s<=fn&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Eo)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ee()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const s=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await tt(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;return i?{data:null,error:i}:await M(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(I(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,s;const{data:i,error:o}=t;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await M(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(I(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:a}=await M(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(t){if(I(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;return i?{data:null,error:i}:await M(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(I(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(e==null?void 0:e.factors)||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=zr(s.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((n=(t=s.user.factors)===null||t===void 0?void 0:t.filter(c=>c.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const d=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(o=>o.kid===e);if(n||(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+jc>Date.now()))return n;const{data:s,error:i}=await M(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new Ot("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(o=>o.kid===e),!n)throw new Ot("No matching signing key found in JWKS");return n}async getClaims(e,t={keys:[]}){try{let n=e;if(!n){const{data:h,error:v}=await this.getSession();if(v||!h.session)return{data:null,error:v};n=h.session.access_token}const{header:s,payload:i,signature:o,raw:{header:a,payload:l}}=zr(n);if(eu(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:i,header:s,signature:o},error:null}}const u=tu(s.alg),d=await this.fetchJwk(s.kid,t),c=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,c,o,Fc(`${a}.${l}`)))throw new Ot("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(n){if(I(n))return{data:null,error:n};throw n}}}Ut.nextInstanceID=0;const yu=Ut;class mu extends yu{constructor(e){super(e)}}var bu=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(d){try{u(n.next(d))}catch(c){o(c)}}function l(d){try{u(n.throw(d))}catch(c){o(c)}}function u(d){d.done?i(d.value):s(d.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};class wu{constructor(e,t,n){var s,i,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=$c(e),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:vc,realtime:yc,auth:Object.assign(Object.assign({},gc),{storageKey:u}),global:_c},c=Tc(n??{},d);this.storageKey=(s=c.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=c.global.headers)!==null&&i!==void 0?i:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=c.auth)!==null&&o!==void 0?o:{},this.headers,c.global.fetch),this.fetch=Sc(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new Dl(new URL("rest/v1",l).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),c.accessToken||this._listenForAuthEvents()}get functions(){return new vl(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new hc(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return bu(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,storageKey:i,flowType:o,lock:a,debug:l},u,d){const c={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new mu({url:this.authUrl.href,headers:Object.assign(Object.assign({},c),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,flowType:o,lock:a,debug:l,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Zl(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Su=(r,e,t)=>new wu(r,e,t),Eu="https://symlpvgdqnmccllwwejt.supabase.co",$u="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5bWxwdmdkcW5tY2NsbHd3ZWp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIxMzI4MjMsImV4cCI6MjA2NzcwODgyM30.O6gqcY6Mzl1XAtn9blKGx4m142p3vJynmr18kNDA9T8",oe=Su(Eu,$u),$o=Ht();function Tu({children:r}){const[e,t]=C(null),[n,s]=C(null),[i,o]=C(!0);re(()=>{(async()=>{const{data:{session:d}}=await oe.auth.getSession();t(d),s((d==null?void 0:d.user)??null),o(!1)})();const{data:u}=oe.auth.onAuthStateChange((d,c)=>{t(c),s((c==null?void 0:c.user)??null)});return()=>{u.subscription.unsubscribe()}},[]);const a={session:e,user:n,signOut:()=>oe.auth.signOut()};return p($o.Provider,{value:a,children:!i&&r})}function xr(){return kr($o)}function To(r,e){for(var t in e)r[t]=e[t];return r}function vn(r,e){for(var t in r)if(t!=="__source"&&!(t in e))return!0;for(var n in e)if(n!=="__source"&&r[n]!==e[n])return!0;return!1}function Bn(r,e){var t=e(),n=C({t:{__:t,u:e}}),s=n[0].t,i=n[1];return yt(function(){s.__=t,s.u=e,Vr(s)&&i({t:s})},[r,t,e]),re(function(){return Vr(s)&&i({t:s}),r(function(){Vr(s)&&i({t:s})})},[r]),t}function Vr(r){var e,t,n=r.u,s=r.__;try{var i=n();return!((e=s)===(t=i)&&(e!==0||1/e==1/t)||e!=e&&t!=t)}catch{return!0}}function Hn(r){r()}function qn(r){return r}function Wn(){return[!1,Hn]}var Gn=yt;function br(r,e){this.props=r,this.context=e}function zn(r,e){function t(s){var i=this.props.ref,o=i==s.ref;return!o&&i&&(i.call?i(null):i.current=null),e?!e(this.props,s)||!o:vn(this.props,s)}function n(s){return this.shouldComponentUpdate=t,J(r,s)}return n.displayName="Memo("+(r.displayName||r.name)+")",n.prototype.isReactComponent=!0,n.__f=!0,n}(br.prototype=new ve).isPureReactComponent=!0,br.prototype.shouldComponentUpdate=function(r,e){return vn(this.props,r)||vn(this.state,e)};var Ds=U.__b;U.__b=function(r){r.type&&r.type.__f&&r.ref&&(r.props.ref=r.ref,r.ref=null),Ds&&Ds(r)};var ku=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function ko(r){function e(t){var n=To({},t);return delete n.ref,r(n,t.ref||null)}return e.$$typeof=ku,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(r.displayName||r.name)+")",e}var Ms=function(r,e){return r==null?null:me(me(r).map(e))},Po={map:Ms,forEach:Ms,count:function(r){return r?me(r).length:0},only:function(r){var e=me(r);if(e.length!==1)throw"Children.only";return e[0]},toArray:me},Pu=U.__e;U.__e=function(r,e,t,n){if(r.then){for(var s,i=e;i=i.__;)if((s=i.__c)&&s.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),s.__c(r,e)}Pu(r,e,t,n)};var Fs=U.unmount;function Ao(r,e,t){return r&&(r.__c&&r.__c.__H&&(r.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),r.__c.__H=null),(r=To({},r)).__c!=null&&(r.__c.__P===t&&(r.__c.__P=e),r.__c.__e=!0,r.__c=null),r.__k=r.__k&&r.__k.map(function(n){return Ao(n,e,t)})),r}function Oo(r,e,t){return r&&t&&(r.__v=null,r.__k=r.__k&&r.__k.map(function(n){return Oo(n,e,t)}),r.__c&&r.__c.__P===e&&(r.__e&&t.appendChild(r.__e),r.__c.__e=!0,r.__c.__P=t)),r}function Rt(){this.__u=0,this.o=null,this.__b=null}function jo(r){var e=r.__.__c;return e&&e.__a&&e.__a(r)}function Ro(r){var e,t,n;function s(i){if(e||(e=r()).then(function(o){t=o.default||o},function(o){n=o}),n)throw n;if(!t)throw e;return J(t,i)}return s.displayName="Lazy",s.__f=!0,s}function ct(){this.i=null,this.l=null}U.unmount=function(r){var e=r.__c;e&&e.__R&&e.__R(),e&&32&r.__u&&(r.type=null),Fs&&Fs(r)},(Rt.prototype=new ve).__c=function(r,e){var t=e.__c,n=this;n.o==null&&(n.o=[]),n.o.push(t);var s=jo(n.__v),i=!1,o=function(){i||(i=!0,t.__R=null,s?s(a):a())};t.__R=o;var a=function(){if(!--n.__u){if(n.state.__a){var l=n.state.__a;n.__v.__k[0]=Oo(l,l.__c.__P,l.__c.__O)}var u;for(n.setState({__a:n.__b=null});u=n.o.pop();)u.forceUpdate()}};n.__u++||32&e.__u||n.setState({__a:n.__b=n.__v.__k[0]}),r.then(o,o)},Rt.prototype.componentWillUnmount=function(){this.o=[]},Rt.prototype.render=function(r,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=Ao(this.__b,t,n.__O=n.__P)}this.__b=null}var s=e.__a&&J(he,null,r.fallback);return s&&(s.__u&=-33),[J(he,null,e.__a?null:r.children),s]};var Bs=function(r,e,t){if(++t[1]===t[0]&&r.l.delete(e),r.props.revealOrder&&(r.props.revealOrder[0]!=="t"||!r.l.size))for(t=r.i;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;r.i=t=t[2]}};function Au(r){return this.getChildContext=function(){return r.context},r.children}function Ou(r){var e=this,t=r.h;if(e.componentWillUnmount=function(){Ke(null,e.v),e.v=null,e.h=null},e.h&&e.h!==t&&e.componentWillUnmount(),!e.v){for(var n=e.__v;n!==null&&!n.__m&&n.__!==null;)n=n.__;e.h=t,e.v={nodeType:1,parentNode:t,childNodes:[],__k:{__m:n.__m},contains:function(){return!0},insertBefore:function(s,i){this.childNodes.push(s),e.h.insertBefore(s,i)},removeChild:function(s){this.childNodes.splice(this.childNodes.indexOf(s)>>>1,1),e.h.removeChild(s)}}}Ke(J(Au,{context:e.context},r.__v),e.v)}function xo(r,e){var t=J(Ou,{__v:r,h:e});return t.containerInfo=e,t}(ct.prototype=new ve).__a=function(r){var e=this,t=jo(e.__v),n=e.l.get(r);return n[0]++,function(s){var i=function(){e.props.revealOrder?(n.push(s),Bs(e,r,n)):s()};t?t(i):i()}},ct.prototype.render=function(r){this.i=null,this.l=new Map;var e=me(r.children);r.revealOrder&&r.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.l.set(e[t],this.i=[1,0,this.i]);return r.children},ct.prototype.componentDidUpdate=ct.prototype.componentDidMount=function(){var r=this;this.l.forEach(function(e,t){Bs(r,t,e)})};var Io=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,ju=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Ru=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,xu=/[A-Z0-9]/g,Iu=typeof document<"u",Cu=function(r){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(r)};function Co(r,e,t){return e.__k==null&&(e.textContent=""),Ke(r,e),typeof t=="function"&&t(),r?r.__c:null}function Uo(r,e,t){return An(r,e),typeof t=="function"&&t(),r?r.__c:null}ve.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(r){Object.defineProperty(ve.prototype,r,{configurable:!0,get:function(){return this["UNSAFE_"+r]},set:function(e){Object.defineProperty(this,r,{configurable:!0,writable:!0,value:e})}})});var Hs=U.event;function Uu(){}function Nu(){return this.cancelBubble}function Lu(){return this.defaultPrevented}U.event=function(r){return Hs&&(r=Hs(r)),r.persist=Uu,r.isPropagationStopped=Nu,r.isDefaultPrevented=Lu,r.nativeEvent=r};var Jn,Du={enumerable:!1,configurable:!0,get:function(){return this.class}},qs=U.vnode;U.vnode=function(r){typeof r.type=="string"&&function(e){var t=e.props,n=e.type,s={},i=n.indexOf("-")===-1;for(var o in t){var a=t[o];if(!(o==="value"&&"defaultValue"in t&&a==null||Iu&&o==="children"&&n==="noscript"||o==="class"||o==="className")){var l=o.toLowerCase();o==="defaultValue"&&"value"in t&&t.value==null?o="value":o==="download"&&a===!0?a="":l==="translate"&&a==="no"?a=!1:l[0]==="o"&&l[1]==="n"?l==="ondoubleclick"?o="ondblclick":l!=="onchange"||n!=="input"&&n!=="textarea"||Cu(t.type)?l==="onfocus"?o="onfocusin":l==="onblur"?o="onfocusout":Ru.test(o)&&(o=l):l=o="oninput":i&&ju.test(o)?o=o.replace(xu,"-$&").toLowerCase():a===null&&(a=void 0),l==="oninput"&&s[o=l]&&(o="oninputCapture"),s[o]=a}}n=="select"&&s.multiple&&Array.isArray(s.value)&&(s.value=me(t.children).forEach(function(u){u.props.selected=s.value.indexOf(u.props.value)!=-1})),n=="select"&&s.defaultValue!=null&&(s.value=me(t.children).forEach(function(u){u.props.selected=s.multiple?s.defaultValue.indexOf(u.props.value)!=-1:s.defaultValue==u.props.value})),t.class&&!t.className?(s.class=t.class,Object.defineProperty(s,"className",Du)):(t.className&&!t.class||t.class&&t.className)&&(s.class=s.className=t.className),e.props=s}(r),r.$$typeof=Io,qs&&qs(r)};var Ws=U.__r;U.__r=function(r){Ws&&Ws(r),Jn=r.__c};var Gs=U.diffed;U.diffed=function(r){Gs&&Gs(r);var e=r.props,t=r.__e;t!=null&&r.type==="textarea"&&"value"in e&&e.value!==t.value&&(t.value=e.value==null?"":e.value),Jn=null};var No={ReactCurrentDispatcher:{current:{readContext:function(r){return Jn.__n[r.__c].props.value},useCallback:ft,useContext:kr,useDebugValue:Rn,useDeferredValue:qn,useEffect:re,useId:xn,useImperativeHandle:jn,useInsertionEffect:Gn,useLayoutEffect:yt,useMemo:Wt,useReducer:Tr,useRef:qt,useState:C,useSyncExternalStore:Bn,useTransition:Wn}}},Mu="18.3.1";function Lo(r){return J.bind(null,r)}function Vt(r){return!!r&&r.$$typeof===Io}function Do(r){return Vt(r)&&r.type===he}function Mo(r){return!!r&&!!r.displayName&&(typeof r.displayName=="string"||r.displayName instanceof String)&&r.displayName.startsWith("Memo(")}function Fo(r){return Vt(r)?On.apply(null,arguments):r}function Bo(r){return!!r.__k&&(Ke(null,r),!0)}function Ho(r){return r&&(r.base||r.nodeType===1&&r)||null}var qo=function(r,e){return r(e)},Wo=function(r,e){return r(e)},Go=he,zo=Vt,Jo={useState:C,useId:xn,useReducer:Tr,useEffect:re,useLayoutEffect:yt,useInsertionEffect:Gn,useTransition:Wn,useDeferredValue:qn,useSyncExternalStore:Bn,startTransition:Hn,useRef:qt,useImperativeHandle:jn,useMemo:Wt,useCallback:ft,useContext:kr,useDebugValue:Rn,version:"18.3.1",Children:Po,render:Co,hydrate:Uo,unmountComponentAtNode:Bo,createPortal:xo,createElement:J,createContext:Ht,createFactory:Lo,cloneElement:Fo,createRef:Tn,Fragment:he,isValidElement:Vt,isElement:zo,isFragment:Do,isMemo:Mo,findDOMNode:Ho,Component:ve,PureComponent:br,memo:zn,forwardRef:ko,flushSync:Wo,unstable_batchedUpdates:qo,StrictMode:Go,Suspense:Rt,SuspenseList:ct,lazy:Ro,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:No};const Fu=Object.freeze(Object.defineProperty({__proto__:null,Children:Po,Component:ve,Fragment:he,PureComponent:br,StrictMode:Go,Suspense:Rt,SuspenseList:ct,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:No,cloneElement:Fo,createContext:Ht,createElement:J,createFactory:Lo,createPortal:xo,createRef:Tn,default:Jo,findDOMNode:Ho,flushSync:Wo,forwardRef:ko,hydrate:Uo,isElement:zo,isFragment:Do,isMemo:Mo,isValidElement:Vt,lazy:Ro,memo:zn,render:Co,startTransition:Hn,unmountComponentAtNode:Bo,unstable_batchedUpdates:qo,useCallback:ft,useContext:kr,useDebugValue:Rn,useDeferredValue:qn,useEffect:re,useErrorBoundary:Ka,useId:xn,useImperativeHandle:jn,useInsertionEffect:Gn,useLayoutEffect:yt,useMemo:Wt,useReducer:Tr,useRef:qt,useState:C,useSyncExternalStore:Bn,useTransition:Wn,version:Mu},Symbol.toStringTag,{value:"Module"}));let Bu={data:""},Hu=r=>typeof window=="object"?((r?r.querySelector("#_goober"):window._goober)||Object.assign((r||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:r||Bu,qu=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Wu=/\/\*[^]*?\*\/|  +/g,zs=/\n+/g,Le=(r,e)=>{let t="",n="",s="";for(let i in r){let o=r[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":n+=i[1]=="f"?Le(o,i):i+"{"+Le(o,i[1]=="k"?"":e)+"}":typeof o=="object"?n+=Le(o,e?e.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,a):a?a+" "+l:l)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Le.p?Le.p(i,o):i+":"+o+";")}return t+(e&&s?e+"{"+s+"}":s)+n},Ae={},Vo=r=>{if(typeof r=="object"){let e="";for(let t in r)e+=t+Vo(r[t]);return e}return r},Gu=(r,e,t,n,s)=>{let i=Vo(r),o=Ae[i]||(Ae[i]=(l=>{let u=0,d=11;for(;u<l.length;)d=101*d+l.charCodeAt(u++)>>>0;return"go"+d})(i));if(!Ae[o]){let l=i!==r?r:(u=>{let d,c,f=[{}];for(;d=qu.exec(u.replace(Wu,""));)d[4]?f.shift():d[3]?(c=d[3].replace(zs," ").trim(),f.unshift(f[0][c]=f[0][c]||{})):f[0][d[1]]=d[2].replace(zs," ").trim();return f[0]})(r);Ae[o]=Le(s?{["@keyframes "+o]:l}:l,t?"":"."+o)}let a=t&&Ae.g?Ae.g:null;return t&&(Ae.g=Ae[o]),((l,u,d,c)=>{c?u.data=u.data.replace(c,l):u.data.indexOf(l)===-1&&(u.data=d?l+u.data:u.data+l)})(Ae[o],e,n,a),o},zu=(r,e,t)=>r.reduce((n,s,i)=>{let o=e[i];if(o&&o.call){let a=o(t),l=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=l?"."+l:a&&typeof a=="object"?a.props?"":Le(a,""):a===!1?"":a}return n+s+(o??"")},"");function Ir(r){let e=this||{},t=r.call?r(e.p):r;return Gu(t.unshift?t.raw?zu(t,[].slice.call(arguments,1),e.p):t.reduce((n,s)=>Object.assign(n,s&&s.call?s(e.p):s),{}):t,Hu(e.target),e.g,e.o,e.k)}let Ko,gn,yn;Ir.bind({g:1});let Ie=Ir.bind({k:1});function Ju(r,e,t,n){Le.p=e,Ko=r,gn=t,yn=n}function Me(r,e){let t=this||{};return function(){let n=arguments;function s(i,o){let a=Object.assign({},i),l=a.className||s.className;t.p=Object.assign({theme:gn&&gn()},a),t.o=/ *go\d+/.test(l),a.className=Ir.apply(t,n)+(l?" "+l:"");let u=r;return r[0]&&(u=a.as||r,delete a.as),yn&&u[0]&&yn(a),Ko(u,a)}return s}}var Vu=r=>typeof r=="function",wr=(r,e)=>Vu(r)?r(e):r,Ku=(()=>{let r=0;return()=>(++r).toString()})(),Yo=(()=>{let r;return()=>{if(r===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");r=!e||e.matches}return r}})(),Yu=20,Qo=(r,e)=>{switch(e.type){case 0:return{...r,toasts:[e.toast,...r.toasts].slice(0,Yu)};case 1:return{...r,toasts:r.toasts.map(i=>i.id===e.toast.id?{...i,...e.toast}:i)};case 2:let{toast:t}=e;return Qo(r,{type:r.toasts.find(i=>i.id===t.id)?1:0,toast:t});case 3:let{toastId:n}=e;return{...r,toasts:r.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return e.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(i=>i.id!==e.toastId)};case 5:return{...r,pausedAt:e.time};case 6:let s=e.time-(r.pausedAt||0);return{...r,pausedAt:void 0,toasts:r.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+s}))}}},hr=[],ze={toasts:[],pausedAt:void 0},Xe=r=>{ze=Qo(ze,r),hr.forEach(e=>{e(ze)})},Qu={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Xu=(r={})=>{let[e,t]=C(ze),n=qt(ze);re(()=>(n.current!==ze&&t(ze),hr.push(t),()=>{let i=hr.indexOf(t);i>-1&&hr.splice(i,1)}),[]);let s=e.toasts.map(i=>{var o,a,l;return{...r,...r[i.type],...i,removeDelay:i.removeDelay||((o=r[i.type])==null?void 0:o.removeDelay)||(r==null?void 0:r.removeDelay),duration:i.duration||((a=r[i.type])==null?void 0:a.duration)||(r==null?void 0:r.duration)||Qu[i.type],style:{...r.style,...(l=r[i.type])==null?void 0:l.style,...i.style}}});return{...e,toasts:s}},Zu=(r,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:r,pauseDuration:0,...t,id:(t==null?void 0:t.id)||Ku()}),Kt=r=>(e,t)=>{let n=Zu(e,r,t);return Xe({type:2,toast:n}),n.id},ce=(r,e)=>Kt("blank")(r,e);ce.error=Kt("error");ce.success=Kt("success");ce.loading=Kt("loading");ce.custom=Kt("custom");ce.dismiss=r=>{Xe({type:3,toastId:r})};ce.remove=r=>Xe({type:4,toastId:r});ce.promise=(r,e,t)=>{let n=ce.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof r=="function"&&(r=r()),r.then(s=>{let i=e.success?wr(e.success,s):void 0;return i?ce.success(i,{id:n,...t,...t==null?void 0:t.success}):ce.dismiss(n),s}).catch(s=>{let i=e.error?wr(e.error,s):void 0;i?ce.error(i,{id:n,...t,...t==null?void 0:t.error}):ce.dismiss(n)}),r};var ed=(r,e)=>{Xe({type:1,toast:{id:r,height:e}})},td=()=>{Xe({type:5,time:Date.now()})},xt=new Map,rd=1e3,nd=(r,e=rd)=>{if(xt.has(r))return;let t=setTimeout(()=>{xt.delete(r),Xe({type:4,toastId:r})},e);xt.set(r,t)},sd=r=>{let{toasts:e,pausedAt:t}=Xu(r);re(()=>{if(t)return;let i=Date.now(),o=e.map(a=>{if(a.duration===1/0)return;let l=(a.duration||0)+a.pauseDuration-(i-a.createdAt);if(l<0){a.visible&&ce.dismiss(a.id);return}return setTimeout(()=>ce.dismiss(a.id),l)});return()=>{o.forEach(a=>a&&clearTimeout(a))}},[e,t]);let n=ft(()=>{t&&Xe({type:6,time:Date.now()})},[t]),s=ft((i,o)=>{let{reverseOrder:a=!1,gutter:l=8,defaultPosition:u}=o||{},d=e.filter(h=>(h.position||u)===(i.position||u)&&h.height),c=d.findIndex(h=>h.id===i.id),f=d.filter((h,v)=>v<c&&h.visible).length;return d.filter(h=>h.visible).slice(...a?[f+1]:[0,f]).reduce((h,v)=>h+(v.height||0)+l,0)},[e]);return re(()=>{e.forEach(i=>{if(i.dismissed)nd(i.id,i.removeDelay);else{let o=xt.get(i.id);o&&(clearTimeout(o),xt.delete(i.id))}})},[e]),{toasts:e,handlers:{updateHeight:ed,startPause:td,endPause:n,calculateOffset:s}}},id=Ie`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,od=Ie`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,ad=Ie`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,ld=Me("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${id} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${od} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${r=>r.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${ad} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,cd=Ie`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,ud=Me("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${r=>r.secondary||"#e0e0e0"};
  border-right-color: ${r=>r.primary||"#616161"};
  animation: ${cd} 1s linear infinite;
`,dd=Ie`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,hd=Ie`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,fd=Me("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${dd} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${hd} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${r=>r.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,pd=Me("div")`
  position: absolute;
`,_d=Me("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,vd=Ie`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,gd=Me("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${vd} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,yd=({toast:r})=>{let{icon:e,type:t,iconTheme:n}=r;return e!==void 0?typeof e=="string"?J(gd,null,e):e:t==="blank"?null:J(_d,null,J(ud,{...n}),t!=="loading"&&J(pd,null,t==="error"?J(ld,{...n}):J(fd,{...n})))},md=r=>`
0% {transform: translate3d(0,${r*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,bd=r=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${r*-150}%,-1px) scale(.6); opacity:0;}
`,wd="0%{opacity:0;} 100%{opacity:1;}",Sd="0%{opacity:1;} 100%{opacity:0;}",Ed=Me("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,$d=Me("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Td=(r,e)=>{let t=r.includes("top")?1:-1,[n,s]=Yo()?[wd,Sd]:[md(t),bd(t)];return{animation:e?`${Ie(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ie(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},kd=zn(({toast:r,position:e,style:t,children:n})=>{let s=r.height?Td(r.position||e||"top-center",r.visible):{opacity:0},i=J(yd,{toast:r}),o=J($d,{...r.ariaProps},wr(r.message,r));return J(Ed,{className:r.className,style:{...s,...t,...r.style}},typeof n=="function"?n({icon:i,message:o}):J(he,null,i,o))});Ju(J);var Pd=({id:r,className:e,style:t,onHeightUpdate:n,children:s})=>{let i=ft(o=>{if(o){let a=()=>{let l=o.getBoundingClientRect().height;n(r,l)};a(),new MutationObserver(a).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[r,n]);return J("div",{ref:i,className:e,style:t},s)},Ad=(r,e)=>{let t=r.includes("top"),n=t?{top:0}:{bottom:0},s=r.includes("center")?{justifyContent:"center"}:r.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Yo()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...n,...s}},Od=Ir`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,ur=16,jd=({reverseOrder:r,position:e="top-center",toastOptions:t,gutter:n,children:s,containerStyle:i,containerClassName:o})=>{let{toasts:a,handlers:l}=sd(t);return J("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:ur,left:ur,right:ur,bottom:ur,pointerEvents:"none",...i},className:o,onMouseEnter:l.startPause,onMouseLeave:l.endPause},a.map(u=>{let d=u.position||e,c=l.calculateOffset(u,{reverseOrder:r,gutter:n,defaultPosition:e}),f=Ad(d,c);return J(Pd,{id:u.id,key:u.id,onHeightUpdate:l.updateHeight,className:u.visible?Od:"",style:f},u.type==="custom"?wr(u.message,u):s?s(u):J(kd,{toast:u,position:d}))}))},Sr=ce;const Rd=()=>{const[r,e]=C(""),[t,n]=C(!1),{user:s,signOut:i}=xr(),o=u=>{u.preventDefault(),r.trim()&&(pt(`/search?q=${encodeURIComponent(r.trim())}`),e(""))},a=async()=>{await i(),pt("/")},l=()=>{n(!t)};return p("header",{children:p("div",{class:"container",children:[p("div",{class:"header-left",children:[p(Be,{href:"/",class:"logo",children:"FreeStream"}),p("nav",{class:t?"active":"",children:p("ul",{onClick:()=>n(!1),children:[p("li",{children:p(Be,{activeClassName:"active",href:"/?type=movie",children:"Movies"})}),p("li",{children:p(Be,{activeClassName:"active",href:"/?type=tv",children:"TV Shows"})}),p("li",{children:p(Be,{activeClassName:"active",href:"/favorites",children:"Favorites"})}),p("li",{children:p(Be,{activeClassName:"active",href:"/history",children:"History"})})]})})]}),p("div",{class:"header-right",children:[p("form",{class:"search-container",onSubmit:o,children:p("input",{type:"text",placeholder:"Search...",value:r,onInput:u=>e(u.target.value)})}),p("div",{class:"auth-links",children:s?p(he,{children:[p("span",{class:"user-email",children:s.email}),p("button",{onClick:a,class:"auth-button",children:"Logout"})]}):p(he,{children:[p(Be,{href:"/login",class:"auth-link",children:"Login"}),p(Be,{href:"/signup",class:"auth-link",children:"Sign Up"})]})})]}),p("button",{class:"hamburger",onClick:l,"aria-label":"Toggle menu",children:[p("span",{class:"bar"}),p("span",{class:"bar"}),p("span",{class:"bar"})]})]})})},xd={},Js=r=>{let e;const t=new Set,n=(d,c)=>{const f=typeof d=="function"?d(e):d;if(!Object.is(f,e)){const h=e;e=c??(typeof f!="object"||f===null)?f:Object.assign({},e,f),t.forEach(v=>v(e,h))}},s=()=>e,l={setState:n,getState:s,getInitialState:()=>u,subscribe:d=>(t.add(d),()=>t.delete(d)),destroy:()=>{(xd?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},u=e=r(n,s,l);return l},Id=r=>r?Js(r):Js;var Xo={exports:{}},Zo={};const ea=Nn(Fu);var ta={exports:{}},ra={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vt=ea;function Cd(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var Ud=typeof Object.is=="function"?Object.is:Cd,Nd=vt.useState,Ld=vt.useEffect,Dd=vt.useLayoutEffect,Md=vt.useDebugValue;function Fd(r,e){var t=e(),n=Nd({inst:{value:t,getSnapshot:e}}),s=n[0].inst,i=n[1];return Dd(function(){s.value=t,s.getSnapshot=e,Kr(s)&&i({inst:s})},[r,t,e]),Ld(function(){return Kr(s)&&i({inst:s}),r(function(){Kr(s)&&i({inst:s})})},[r]),Md(t),t}function Kr(r){var e=r.getSnapshot;r=r.value;try{var t=e();return!Ud(r,t)}catch{return!0}}function Bd(r,e){return e()}var Hd=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Bd:Fd;ra.useSyncExternalStore=vt.useSyncExternalStore!==void 0?vt.useSyncExternalStore:Hd;ta.exports=ra;var qd=ta.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cr=ea,Wd=qd;function Gd(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var zd=typeof Object.is=="function"?Object.is:Gd,Jd=Wd.useSyncExternalStore,Vd=Cr.useRef,Kd=Cr.useEffect,Yd=Cr.useMemo,Qd=Cr.useDebugValue;Zo.useSyncExternalStoreWithSelector=function(r,e,t,n,s){var i=Vd(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=Yd(function(){function l(h){if(!u){if(u=!0,d=h,h=n(h),s!==void 0&&o.hasValue){var v=o.value;if(s(v,h))return c=v}return c=h}if(v=c,zd(d,h))return v;var m=n(h);return s!==void 0&&s(v,m)?(d=h,v):(d=h,c=m)}var u=!1,d,c,f=t===void 0?null:t;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,t,n,s]);var a=Jd(r,i[0],i[1]);return Kd(function(){o.hasValue=!0,o.value=a},[a]),Qd(a),a};Xo.exports=Zo;var Xd=Xo.exports;const Zd=Xi(Xd),na={},{useDebugValue:eh}=Jo,{useSyncExternalStoreWithSelector:th}=Zd;let Vs=!1;const rh=r=>r;function nh(r,e=rh,t){(na?"production":void 0)!=="production"&&t&&!Vs&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Vs=!0);const n=th(r.subscribe,r.getState,r.getServerState||r.getInitialState,e,t);return eh(n),n}const Ks=r=>{(na?"production":void 0)!=="production"&&typeof r!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof r=="function"?Id(r):r,t=(n,s)=>nh(e,n,s);return Object.assign(t,e),t},sh=r=>r?Ks(r):Ks,ih={};function oh(r,e){let t;try{t=r()}catch{return}return{getItem:s=>{var i;const o=l=>l===null?null:JSON.parse(l,void 0),a=(i=t.getItem(s))!=null?i:null;return a instanceof Promise?a.then(o):o(a)},setItem:(s,i)=>t.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>t.removeItem(s)}}const Nt=r=>e=>{try{const t=r(e);return t instanceof Promise?t:{then(n){return Nt(n)(t)},catch(n){return this}}}catch(t){return{then(n){return this},catch(n){return Nt(n)(t)}}}},ah=(r,e)=>(t,n,s)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:_=>_,version:0,merge:(_,b)=>({...b,..._}),...e},o=!1;const a=new Set,l=new Set;let u;try{u=i.getStorage()}catch{}if(!u)return r((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(..._)},n,s);const d=Nt(i.serialize),c=()=>{const _=i.partialize({...n()});let b;const y=d({state:_,version:i.version}).then(w=>u.setItem(i.name,w)).catch(w=>{b=w});if(b)throw b;return y},f=s.setState;s.setState=(_,b)=>{f(_,b),c()};const h=r((..._)=>{t(..._),c()},n,s);let v;const m=()=>{var _;if(!u)return;o=!1,a.forEach(y=>y(n()));const b=((_=i.onRehydrateStorage)==null?void 0:_.call(i,n()))||void 0;return Nt(u.getItem.bind(u))(i.name).then(y=>{if(y)return i.deserialize(y)}).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==i.version){if(i.migrate)return i.migrate(y.state,y.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return y.state}).then(y=>{var w;return v=i.merge(y,(w=n())!=null?w:h),t(v,!0),c()}).then(()=>{b==null||b(v,void 0),o=!0,l.forEach(y=>y(v))}).catch(y=>{b==null||b(void 0,y)})};return s.persist={setOptions:_=>{i={...i,..._},_.getStorage&&(u=_.getStorage())},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>m(),hasHydrated:()=>o,onHydrate:_=>(a.add(_),()=>{a.delete(_)}),onFinishHydration:_=>(l.add(_),()=>{l.delete(_)})},m(),v||h},lh=(r,e)=>(t,n,s)=>{let i={storage:oh(()=>localStorage),partialize:m=>m,version:0,merge:(m,_)=>({..._,...m}),...e},o=!1;const a=new Set,l=new Set;let u=i.storage;if(!u)return r((...m)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...m)},n,s);const d=()=>{const m=i.partialize({...n()});return u.setItem(i.name,{state:m,version:i.version})},c=s.setState;s.setState=(m,_)=>{c(m,_),d()};const f=r((...m)=>{t(...m),d()},n,s);s.getInitialState=()=>f;let h;const v=()=>{var m,_;if(!u)return;o=!1,a.forEach(y=>{var w;return y((w=n())!=null?w:f)});const b=((_=i.onRehydrateStorage)==null?void 0:_.call(i,(m=n())!=null?m:f))||void 0;return Nt(u.getItem.bind(u))(i.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==i.version){if(i.migrate)return[!0,i.migrate(y.state,y.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var w;const[A,O]=y;if(h=i.merge(O,(w=n())!=null?w:f),t(h,!0),A)return d()}).then(()=>{b==null||b(h,void 0),h=n(),o=!0,l.forEach(y=>y(h))}).catch(y=>{b==null||b(void 0,y)})};return s.persist={setOptions:m=>{i={...i,...m},m.storage&&(u=m.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:m=>(a.add(m),()=>{a.delete(m)}),onFinishHydration:m=>(l.add(m),()=>{l.delete(m)})},i.skipHydration||v(),h||f},ch=(r,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((ih?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),ah(r,e)):lh(r,e),uh=ch,Lt=sh(uh((r,e)=>({trending:[],popularMovies:[],popularTv:[],topRatedMovies:[],topRatedTv:[],favorites:[],favoritesFetched:!1,currentMediaItem:null,setCurrentMediaItem:t=>r({currentMediaItem:t}),fetchTrending:async()=>{if(!(e().trending.length>0))try{const t=await fetch("/api/tmdb/trending/all/week");if(t.ok){const n=await t.json();r({trending:n.results||[]})}}catch(t){console.error("Error fetching trending:",t)}},fetchPopularMovies:async()=>{if(!(e().popularMovies.length>0))try{const t=await fetch("/api/tmdb/movie/popular");if(t.ok){const n=await t.json();r({popularMovies:n.results||[]})}}catch(t){console.error("Error fetching popular movies:",t)}},fetchPopularTv:async()=>{if(!(e().popularTv.length>0))try{const t=await fetch("/api/tmdb/tv/popular");if(t.ok){const n=await t.json();r({popularTv:n.results||[]})}}catch(t){console.error("Error fetching popular TV:",t)}},fetchTopRatedMovies:async()=>{if(!(e().topRatedMovies.length>0))try{const t=await fetch("/api/tmdb/movie/top_rated");if(t.ok){const n=await t.json();r({topRatedMovies:n.results||[]})}}catch(t){console.error("Error fetching top rated movies:",t)}},fetchTopRatedTv:async()=>{if(!(e().topRatedTv.length>0))try{const t=await fetch("/api/tmdb/tv/top_rated");if(t.ok){const n=await t.json();r({topRatedTv:n.results||[]})}}catch(t){console.error("Error fetching top rated TV:",t)}},fetchFavorites:async()=>{const{data:{user:t}}=await oe.auth.getUser();if(!t){r({favorites:[],favoritesFetched:!0});return}const{data:n,error:s}=await oe.from("favorites").select("media_id, media_type").eq("user_id",t.id);if(s){console.error("Error fetching favorites:",s),r({favoritesFetched:!0});return}const i=await Promise.all(n.map(async o=>{const a=await fetch(`/api/tmdb/${o.media_type}/${o.media_id}`);return a.ok?{...await a.json(),type:o.media_type}:null}));r({favorites:i.filter(Boolean),favoritesFetched:!0})},addFavorite:async t=>{const{data:{user:n}}=await oe.auth.getUser();if(!n)return;r(i=>({favorites:[t,...i.favorites]}));const{error:s}=await oe.from("favorites").insert({user_id:n.id,media_id:t.id,media_type:t.type});s&&(console.error("Error adding favorite:",s),r(i=>({favorites:i.favorites.filter(o=>o.id!==t.id)})))},removeFavorite:async t=>{const{data:{user:n}}=await oe.auth.getUser();if(!n)return;const s=e().favorites;r(o=>({favorites:o.favorites.filter(a=>a.id!==t)}));const{error:i}=await oe.from("favorites").delete().match({user_id:n.id,media_id:t});i&&(console.error("Error removing favorite:",i),r({favorites:s}))},isFavorited:t=>{const{favorites:n,favoritesFetched:s}=e();return s?n.some(i=>i.id===t):!1}}),{name:"freestream-storage",getStorage:()=>localStorage,partialize:r=>({favorites:r.favorites,trending:r.trending,popularMovies:r.popularMovies,popularTv:r.popularTv,topRatedMovies:r.topRatedMovies,topRatedTv:r.topRatedTv})})),dh="https://image.tmdb.org/t/p/w500",Yt=({item:r,type:e,progress:t})=>{const n=r.poster_path&&r.poster_path!=="undefined"?`${dh}${r.poster_path}`:"https://via.placeholder.com/200x300.png?text=No+Image",s=r.title||r.name,i=r.vote_average?r.vote_average.toFixed(1):"N/A",o=`/watch?id=${r.id}&type=${e}`,{addFavorite:a,removeFavorite:l,isFavorited:u}=Lt(),d=u(r.id),c=h=>{h.preventDefault(),h.stopPropagation(),d?l(r.id):a({...r,type:e})};let f=0;return t&&t.progress_seconds&&t.duration_seconds&&(f=t.progress_seconds/t.duration_seconds*100),p("div",{class:"movie-card-container",children:[p("a",{href:o,class:"movie-card",children:[p("div",{class:"poster-wrapper",children:[p("img",{src:n,alt:s,loading:"lazy"}),f>1&&f<95&&p("div",{class:"progress-bar-container",children:p("div",{class:"progress-bar",style:{width:`${f}%`}})})]}),p("div",{class:"movie-info",children:[p("h3",{children:s}),p("span",{class:"rating",children:[" ",i]})]})]}),p("button",{class:`favorite-btn ${d?"favorited":""}`,onClick:c,children:d?"":""})]})},Ur=async()=>{const{data:{user:r}}=await oe.auth.getUser();return r==null?void 0:r.id},sa=async()=>{const r=await Ur();if(!r)return[];const{data:e,error:t}=await oe.from("watch_history").select("*").eq("user_id",r).order("watched_at",{ascending:!1});return t?(console.error("Error fetching watch history:",t),[]):e},hh=async(r,e,t,n)=>{const s=await Ur();if(!s)return null;let i=oe.from("watch_progress").select("progress_seconds, duration_seconds").eq("user_id",s).eq("media_id",r).eq("media_type",e);e!=="movie"&&(i=i.eq("season_number",t).eq("episode_number",n));const{data:o,error:a}=await i.single();return a&&a.code!=="PGRST116"&&console.error("Error fetching watch progress:",a),o},fh=async(r,e,t)=>{if(!r||typeof e>"u"||e<5)return;const n={p_media_id:r.id,p_media_type:r.type,p_season_number:r.season,p_episode_number:r.episode,p_progress_seconds:Math.round(e)};t&&(n.p_duration_seconds=t*60);const{error:s}=await oe.rpc("save_watch_progress",n);s&&console.error("Error saving watch progress:",s)},ph=async r=>{const e=await Ur();if(!e)return{};const{data:t,error:n}=await oe.from("watch_progress").select("*").eq("user_id",e).eq("media_id",r);if(n)return console.error("Error fetching series history:",n),{};const s={};return t.forEach(i=>{const o=`tv-${i.media_id}-s${i.season_number}-e${i.episode_number}`;s[o]={id:i.media_id,type:i.media_type,season:i.season_number,episode:i.episode_number,progress:i.progress_seconds,duration:i.duration_seconds}}),s},_h=async r=>{const e=await Ur();if(!e)return null;const{data:t,error:n}=await oe.from("watch_history").select("season_number, episode_number").eq("user_id",e).eq("media_id",r).order("watched_at",{ascending:!1}).limit(1).single();return n&&n.code!=="PGRST116"?(console.error("Error fetching last watched episode:",n),null):t?{season:t.season_number,episode:t.episode_number}:null},Re="/api",vh=()=>{const{trending:r,popularMovies:e,popularTv:t,topRatedMovies:n,topRatedTv:s,fetchTrending:i,fetchPopularMovies:o,fetchPopularTv:a,fetchTopRatedMovies:l,fetchTopRatedTv:u}=Lt(),[d,c]=C({}),[f,h]=C([]),[v,m]=C(!0);re(()=>{i(),o(),a(),l(),u()},[i,o,a,l,u]),re(()=>{(async()=>{m(!0);const y=await sa();if(!y){m(!1);return}const w=y.reduce((O,E)=>{const H=`${E.media_type}-${E.media_id}${E.media_type!=="movie"?"-s"+E.season_number+"-e"+E.episode_number:""}`;if(O[H]=E,E.media_type==="tv"||E.media_type==="anime"){const T=`${E.media_type}-${E.id}`;(!O[T]||new Date(E.watched_at)>new Date(O[T].watched_at))&&(O[T]=E)}return O},{});c(w);const A=y.filter(O=>O.duration_seconds>0?O.progress_seconds/O.duration_seconds<.95:!0).sort((O,E)=>new Date(E.watched_at)-new Date(O.watched_at));if(A.length>0){const O=await Promise.all(A.map(async E=>{try{const H=await fetch(`${Re}/tmdb/${E.media_type}/${E.media_id}`);return H.ok?{...await H.json(),...E,type:E.media_type}:null}catch{return null}}));h(O.filter(Boolean))}else h([]);m(!1)})()},[]);const _=(b,y,w,A)=>A?p("section",{class:"home-section",children:[p("h2",{children:b}),p("div",{class:"movie-list-placeholder",children:[...Array(5)].map((O,E)=>p("div",{class:"movie-card-placeholder"},E))})]}):(!y||y.length===0)&&b!=="Continue Watching"?null:p("section",{class:"home-section",children:[p("h2",{children:b}),p("div",{class:"movie-list",children:y.map(O=>{const E=O.media_type||w;return p(Yt,{item:{...O,type:E},type:E,progress:d[`${E}-${O.id}`]||O},O.id)})})]});return p("div",{class:"container home-page",children:[p("h1",{class:"main-title",children:"Discover"}),_("Continue Watching",f,"movie",v),_("Trending This Week",r,"movie"),_("Popular Movies",e,"movie"),_("Top Rated Movies",n,"movie"),_("Popular TV Shows",t,"tv"),_("Top Rated TV Shows",s,"tv")]})};var mn={exports:{}};const ia=Nn(Ja);var Ys=ia;function gh(r,e){var t={};for(var n in r)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);return t}function yh(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function mh(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function bh(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var wh=function(e,t,n){if(typeof e!="function")throw new Error("Expected reducePropsToState to be a function.");if(typeof t!="function")throw new Error("Expected handleStateChangeOnClient to be a function.");if(typeof n<"u"&&typeof n!="function")throw new Error("Expected mapStateOnServer to either be undefined or a function.");function s(o){return o.displayName||o.name||"Component"}return function(a){if(typeof a!="function")throw new Error("Expected WrappedComponent to be a React component.");var l=[],u=void 0;function d(){u=e(l.map(function(f){return f.props})),c.canUseDOM?t(u):n&&(u=n(u))}var c=function(f){bh(h,f);function h(){return yh(this,h),mh(this,f.apply(this,arguments))}return h.peek=function(){return u},h.rewind=function(){if(h.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var m=u;return u=void 0,l=[],m},h.prototype.shouldComponentUpdate=function(m){var _=m.children,b=gh(m,["children"]);return _&&_.length&&(b.children=_),i(b,this.props)},h.prototype.componentWillMount=function(){l.push(this),d()},h.prototype.componentDidUpdate=function(){d()},h.prototype.componentWillUnmount=function(){var m=l.indexOf(this);l.splice(m,1),d()},h.prototype.render=function(){return(0,Ys.h)(a,this.props)},h}(Ys.Component);return c.displayName="SideEffect("+s(a)+")",c.canUseDOM=!!(typeof window<"u"&&window.document&&window.document.createElement),c};function i(o,a){for(var l in o)if(!(l in a))return!0;for(var u in a)if(o[u]!==a[u])return!0;return!1}},Qs=Object.prototype.toString,oa=function(e){var t=Qs.call(e),n=t==="[object Arguments]";return n||(n=t!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&Qs.call(e.callee)==="[object Function]"),n},Yr,Xs;function Sh(){if(Xs)return Yr;Xs=1;var r;if(!Object.keys){var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,n=oa,s=Object.prototype.propertyIsEnumerable,i=!s.call({toString:null},"toString"),o=s.call(function(){},"prototype"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(f){var h=f.constructor;return h&&h.prototype===f},u={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if(typeof window>"u")return!1;for(var f in window)try{if(!u["$"+f]&&e.call(window,f)&&window[f]!==null&&typeof window[f]=="object")try{l(window[f])}catch{return!0}}catch{return!0}return!1}(),c=function(f){if(typeof window>"u"||!d)return l(f);try{return l(f)}catch{return!1}};r=function(h){var v=h!==null&&typeof h=="object",m=t.call(h)==="[object Function]",_=n(h),b=v&&t.call(h)==="[object String]",y=[];if(!v&&!m&&!_)throw new TypeError("Object.keys called on a non-object");var w=o&&m;if(b&&h.length>0&&!e.call(h,0))for(var A=0;A<h.length;++A)y.push(String(A));if(_&&h.length>0)for(var O=0;O<h.length;++O)y.push(String(O));else for(var E in h)!(w&&E==="prototype")&&e.call(h,E)&&y.push(String(E));if(i)for(var H=c(h),T=0;T<a.length;++T)!(H&&a[T]==="constructor")&&e.call(h,a[T])&&y.push(a[T]);return y}}return Yr=r,Yr}var Eh=Array.prototype.slice,$h=oa,Zs=Object.keys,fr=Zs?function(e){return Zs(e)}:Sh(),ei=Object.keys;fr.shim=function(){if(Object.keys){var e=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);e||(Object.keys=function(n){return $h(n)?ei(Eh.call(n)):ei(n)})}else Object.keys=fr;return Object.keys||fr};var aa=fr,la=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),n=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var s=42;e[t]=s;for(var i in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,t);if(a.value!==s||a.enumerable!==!0)return!1}return!0},Th=la,Vn=function(){return Th()&&!!Symbol.toStringTag},ca=Object,ua=Error,kh=EvalError,Ph=RangeError,Ah=ReferenceError,da=SyntaxError,wt=TypeError,Oh=URIError,jh=Math.abs,Rh=Math.floor,xh=Math.max,Ih=Math.min,Ch=Math.pow,Uh=Math.round,Nh=Number.isNaN||function(e){return e!==e},Lh=Nh,Dh=function(e){return Lh(e)||e===0?e:e<0?-1:1},Mh=Object.getOwnPropertyDescriptor,pr=Mh;if(pr)try{pr([],"length")}catch{pr=null}var St=pr,_r=Object.defineProperty||!1;if(_r)try{_r({},"a",{value:1})}catch{_r=!1}var Nr=_r,Qr,ti;function Fh(){if(ti)return Qr;ti=1;var r=typeof Symbol<"u"&&Symbol,e=la;return Qr=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},Qr}var ha=typeof Reflect<"u"&&Reflect.getPrototypeOf||null,Bh=ca,fa=Bh.getPrototypeOf||null,Hh="Function.prototype.bind called on incompatible ",qh=Object.prototype.toString,Wh=Math.max,Gh="[object Function]",ri=function(e,t){for(var n=[],s=0;s<e.length;s+=1)n[s]=e[s];for(var i=0;i<t.length;i+=1)n[i+e.length]=t[i];return n},zh=function(e,t){for(var n=[],s=t,i=0;s<e.length;s+=1,i+=1)n[i]=e[s];return n},Jh=function(r,e){for(var t="",n=0;n<r.length;n+=1)t+=r[n],n+1<r.length&&(t+=e);return t},Vh=function(e){var t=this;if(typeof t!="function"||qh.apply(t)!==Gh)throw new TypeError(Hh+t);for(var n=zh(arguments,1),s,i=function(){if(this instanceof s){var d=t.apply(this,ri(n,arguments));return Object(d)===d?d:this}return t.apply(e,ri(n,arguments))},o=Wh(0,t.length-n.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(s=Function("binder","return function ("+Jh(a,",")+"){ return binder.apply(this,arguments); }")(i),t.prototype){var u=function(){};u.prototype=t.prototype,s.prototype=new u,u.prototype=null}return s},Kh=Vh,Qt=Function.prototype.bind||Kh,Kn=Function.prototype.call,Yn=Function.prototype.apply,Yh=typeof Reflect<"u"&&Reflect&&Reflect.apply,Qh=Qt,Xh=Yn,Zh=Kn,ef=Yh,pa=ef||Qh.call(Zh,Xh),tf=Qt,rf=wt,nf=Kn,sf=pa,Qn=function(e){if(e.length<1||typeof e[0]!="function")throw new rf("a function is required");return sf(tf,nf,e)},of=Qn,ni=St,_a;try{_a=[].__proto__===Array.prototype}catch(r){if(!r||typeof r!="object"||!("code"in r)||r.code!=="ERR_PROTO_ACCESS")throw r}var Xr=!!_a&&ni&&ni(Object.prototype,"__proto__"),va=Object,si=va.getPrototypeOf,af=Xr&&typeof Xr.get=="function"?of([Xr.get]):typeof si=="function"?function(e){return si(e==null?e:va(e))}:!1,ii=ha,oi=fa,ai=af,ga=ii?function(e){return ii(e)}:oi?function(e){if(!e||typeof e!="object"&&typeof e!="function")throw new TypeError("getProto: not an object");return oi(e)}:ai?function(e){return ai(e)}:null,lf=Function.prototype.call,cf=Object.prototype.hasOwnProperty,uf=Qt,ya=uf.call(lf,cf),D,df=ca,hf=ua,ff=kh,pf=Ph,_f=Ah,gt=da,ut=wt,vf=Oh,gf=jh,yf=Rh,mf=xh,bf=Ih,wf=Ch,Sf=Uh,Ef=Dh,ma=Function,Zr=function(r){try{return ma('"use strict"; return ('+r+").constructor;")()}catch{}},Dt=St,$f=Nr,en=function(){throw new ut},Tf=Dt?function(){try{return arguments.callee,en}catch{try{return Dt(arguments,"callee").get}catch{return en}}}():en,st=Fh()(),ie=ga,kf=fa,Pf=ha,ba=Yn,Xt=Kn,at={},Af=typeof Uint8Array>"u"||!ie?D:ie(Uint8Array),Ve={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?D:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?D:ArrayBuffer,"%ArrayIteratorPrototype%":st&&ie?ie([][Symbol.iterator]()):D,"%AsyncFromSyncIteratorPrototype%":D,"%AsyncFunction%":at,"%AsyncGenerator%":at,"%AsyncGeneratorFunction%":at,"%AsyncIteratorPrototype%":at,"%Atomics%":typeof Atomics>"u"?D:Atomics,"%BigInt%":typeof BigInt>"u"?D:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?D:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?D:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?D:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":hf,"%eval%":eval,"%EvalError%":ff,"%Float16Array%":typeof Float16Array>"u"?D:Float16Array,"%Float32Array%":typeof Float32Array>"u"?D:Float32Array,"%Float64Array%":typeof Float64Array>"u"?D:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?D:FinalizationRegistry,"%Function%":ma,"%GeneratorFunction%":at,"%Int8Array%":typeof Int8Array>"u"?D:Int8Array,"%Int16Array%":typeof Int16Array>"u"?D:Int16Array,"%Int32Array%":typeof Int32Array>"u"?D:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":st&&ie?ie(ie([][Symbol.iterator]())):D,"%JSON%":typeof JSON=="object"?JSON:D,"%Map%":typeof Map>"u"?D:Map,"%MapIteratorPrototype%":typeof Map>"u"||!st||!ie?D:ie(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":df,"%Object.getOwnPropertyDescriptor%":Dt,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?D:Promise,"%Proxy%":typeof Proxy>"u"?D:Proxy,"%RangeError%":pf,"%ReferenceError%":_f,"%Reflect%":typeof Reflect>"u"?D:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?D:Set,"%SetIteratorPrototype%":typeof Set>"u"||!st||!ie?D:ie(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?D:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":st&&ie?ie(""[Symbol.iterator]()):D,"%Symbol%":st?Symbol:D,"%SyntaxError%":gt,"%ThrowTypeError%":Tf,"%TypedArray%":Af,"%TypeError%":ut,"%Uint8Array%":typeof Uint8Array>"u"?D:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?D:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?D:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?D:Uint32Array,"%URIError%":vf,"%WeakMap%":typeof WeakMap>"u"?D:WeakMap,"%WeakRef%":typeof WeakRef>"u"?D:WeakRef,"%WeakSet%":typeof WeakSet>"u"?D:WeakSet,"%Function.prototype.call%":Xt,"%Function.prototype.apply%":ba,"%Object.defineProperty%":$f,"%Object.getPrototypeOf%":kf,"%Math.abs%":gf,"%Math.floor%":yf,"%Math.max%":mf,"%Math.min%":bf,"%Math.pow%":wf,"%Math.round%":Sf,"%Math.sign%":Ef,"%Reflect.getPrototypeOf%":Pf};if(ie)try{null.error}catch(r){var Of=ie(ie(r));Ve["%Error.prototype%"]=Of}var jf=function r(e){var t;if(e==="%AsyncFunction%")t=Zr("async function () {}");else if(e==="%GeneratorFunction%")t=Zr("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=Zr("async function* () {}");else if(e==="%AsyncGenerator%"){var n=r("%AsyncGeneratorFunction%");n&&(t=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var s=r("%AsyncGenerator%");s&&ie&&(t=ie(s.prototype))}return Ve[e]=t,t},li={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Zt=Qt,Er=ya,Rf=Zt.call(Xt,Array.prototype.concat),xf=Zt.call(ba,Array.prototype.splice),ci=Zt.call(Xt,String.prototype.replace),$r=Zt.call(Xt,String.prototype.slice),If=Zt.call(Xt,RegExp.prototype.exec),Cf=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Uf=/\\(\\)?/g,Nf=function(e){var t=$r(e,0,1),n=$r(e,-1);if(t==="%"&&n!=="%")throw new gt("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&t!=="%")throw new gt("invalid intrinsic syntax, expected opening `%`");var s=[];return ci(e,Cf,function(i,o,a,l){s[s.length]=a?ci(l,Uf,"$1"):o||i}),s},Lf=function(e,t){var n=e,s;if(Er(li,n)&&(s=li[n],n="%"+s[0]+"%"),Er(Ve,n)){var i=Ve[n];if(i===at&&(i=jf(n)),typeof i>"u"&&!t)throw new ut("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:s,name:n,value:i}}throw new gt("intrinsic "+e+" does not exist!")},wa=function(e,t){if(typeof e!="string"||e.length===0)throw new ut("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new ut('"allowMissing" argument must be a boolean');if(If(/^%?[^%]*%?$/,e)===null)throw new gt("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=Nf(e),s=n.length>0?n[0]:"",i=Lf("%"+s+"%",t),o=i.name,a=i.value,l=!1,u=i.alias;u&&(s=u[0],xf(n,Rf([0,1],u)));for(var d=1,c=!0;d<n.length;d+=1){var f=n[d],h=$r(f,0,1),v=$r(f,-1);if((h==='"'||h==="'"||h==="`"||v==='"'||v==="'"||v==="`")&&h!==v)throw new gt("property names with quotes must have matching quotes");if((f==="constructor"||!c)&&(l=!0),s+="."+f,o="%"+s+"%",Er(Ve,o))a=Ve[o];else if(a!=null){if(!(f in a)){if(!t)throw new ut("base intrinsic for "+e+" exists, but the property is not available.");return}if(Dt&&d+1>=n.length){var m=Dt(a,f);c=!!m,c&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[f]}else c=Er(a,f),a=a[f];c&&!l&&(Ve[o]=a)}}return a},Sa=wa,Ea=Qn,Df=Ea([Sa("%String.prototype.indexOf%")]),Xn=function(e,t){var n=Sa(e,!!t);return typeof n=="function"&&Df(e,".prototype.")>-1?Ea([n]):n},Mf=Vn(),Ff=Xn,bn=Ff("Object.prototype.toString"),Lr=function(e){return Mf&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:bn(e)==="[object Arguments]"},$a=function(e){return Lr(e)?!0:e!==null&&typeof e=="object"&&"length"in e&&typeof e.length=="number"&&e.length>=0&&bn(e)!=="[object Array]"&&"callee"in e&&bn(e.callee)==="[object Function]"},Bf=function(){return Lr(arguments)}();Lr.isLegacyArguments=$a;var Hf=Bf?Lr:$a,ui=Nr,qf=da,it=wt,di=St,Zn=function(e,t,n){if(!e||typeof e!="object"&&typeof e!="function")throw new it("`obj` must be an object or a function`");if(typeof t!="string"&&typeof t!="symbol")throw new it("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new it("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new it("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new it("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new it("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,i=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,l=!!di&&di(e,t);if(ui)ui(e,t,{configurable:o===null&&l?l.configurable:!o,enumerable:s===null&&l?l.enumerable:!s,value:n,writable:i===null&&l?l.writable:!i});else if(a||!s&&!i&&!o)e[t]=n;else throw new qf("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},wn=Nr,Ta=function(){return!!wn};Ta.hasArrayLengthDefineBug=function(){if(!wn)return null;try{return wn([],"length",{value:1}).length!==1}catch{return!0}};var es=Ta,Wf=aa,Gf=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",zf=Object.prototype.toString,Jf=Array.prototype.concat,hi=Zn,Vf=function(r){return typeof r=="function"&&zf.call(r)==="[object Function]"},ka=es(),Kf=function(r,e,t,n){if(e in r){if(n===!0){if(r[e]===t)return}else if(!Vf(n)||!n())return}ka?hi(r,e,t,!0):hi(r,e,t)},Pa=function(r,e){var t=arguments.length>2?arguments[2]:{},n=Wf(e);Gf&&(n=Jf.call(n,Object.getOwnPropertySymbols(e)));for(var s=0;s<n.length;s+=1)Kf(r,n[s],e[n[s]],t[n[s]])};Pa.supportsDescriptors=!!ka;var er=Pa,Aa={exports:{}},Yf=wa,fi=Zn,Qf=es(),pi=St,_i=wt,Xf=Yf("%Math.floor%"),Zf=function(e,t){if(typeof e!="function")throw new _i("`fn` is not a function");if(typeof t!="number"||t<0||t>4294967295||Xf(t)!==t)throw new _i("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],s=!0,i=!0;if("length"in e&&pi){var o=pi(e,"length");o&&!o.configurable&&(s=!1),o&&!o.writable&&(i=!1)}return(s||i||!n)&&(Qf?fi(e,"length",t,!0,!0):fi(e,"length",t)),e},ep=Qt,tp=Yn,rp=pa,np=function(){return rp(ep,tp,arguments)};(function(r){var e=Zf,t=Nr,n=Qn,s=np;r.exports=function(o){var a=n(arguments),l=o.length-(arguments.length-1);return e(a,1+(l>0?l:0),!0)},t?t(r.exports,"apply",{value:s}):r.exports.apply=s})(Aa);var Oa=Aa.exports,vi=function(r){return r!==r},ja=function(e,t){return e===0&&t===0?1/e===1/t:!!(e===t||vi(e)&&vi(t))},sp=ja,Ra=function(){return typeof Object.is=="function"?Object.is:sp},ip=Ra,op=er,ap=function(){var e=ip();return op(Object,{is:e},{is:function(){return Object.is!==e}}),e},lp=er,cp=Oa,up=ja,xa=Ra,dp=ap,Ia=cp(xa(),Object);lp(Ia,{getPolyfill:xa,implementation:up,shim:dp});var hp=Ia,gi=Xn,fp=Vn(),pp=ya,_p=St,Sn;if(fp){var vp=gi("RegExp.prototype.exec"),yi={},tn=function(){throw yi},mi={toString:tn,valueOf:tn};typeof Symbol.toPrimitive=="symbol"&&(mi[Symbol.toPrimitive]=tn),Sn=function(e){if(!e||typeof e!="object")return!1;var t=_p(e,"lastIndex"),n=t&&pp(t,"value");if(!n)return!1;try{vp(e,mi)}catch(s){return s===yi}}}else{var gp=gi("Object.prototype.toString"),yp="[object RegExp]";Sn=function(e){return!e||typeof e!="object"&&typeof e!="function"?!1:gp(e)===yp}}var mp=Sn,Mt=function(){return typeof(function(){}).name=="string"},It=Object.getOwnPropertyDescriptor;if(It)try{It([],"length")}catch{It=null}Mt.functionsHaveConfigurableNames=function(){if(!Mt()||!It)return!1;var e=It(function(){},"name");return!!e&&!!e.configurable};var bp=Function.prototype.bind;Mt.boundFunctionsHaveNames=function(){return Mt()&&typeof bp=="function"&&(function(){}).bind().name!==""};var wp=Mt,bi=Zn,Sp=es(),Ep=wp.functionsHaveConfigurableNames(),$p=wt,Tp=function(e,t){if(typeof e!="function")throw new $p("`fn` is not a function");var n=arguments.length>2&&!!arguments[2];return(!n||Ep)&&(Sp?bi(e,"name",t,!0,!0):bi(e,"name",t)),e},kp=Tp,Pp=wt,Ap=Object,Ca=kp(function(){if(this==null||this!==Ap(this))throw new Pp("RegExp.prototype.flags getter called on non-object");var e="";return this.hasIndices&&(e+="d"),this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.unicodeSets&&(e+="v"),this.sticky&&(e+="y"),e},"get flags",!0),Op=Ca,jp=er.supportsDescriptors,Rp=Object.getOwnPropertyDescriptor,Ua=function(){if(jp&&/a/mig.flags==="gim"){var e=Rp(RegExp.prototype,"flags");if(e&&typeof e.get=="function"&&"dotAll"in RegExp.prototype&&"hasIndices"in RegExp.prototype){var t="",n={};if(Object.defineProperty(n,"hasIndices",{get:function(){t+="d"}}),Object.defineProperty(n,"sticky",{get:function(){t+="y"}}),e.get.call(n),t==="dy")return e.get}}return Op},xp=er.supportsDescriptors,Ip=Ua,Cp=St,Up=Object.defineProperty,Np=ua,wi=ga,Lp=/a/,Dp=function(){if(!xp||!wi)throw new Np("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=Ip(),t=wi(Lp),n=Cp(t,"flags");return(!n||n.get!==e)&&Up(t,"flags",{configurable:!0,enumerable:!1,get:e}),e},Mp=er,Fp=Oa,Bp=Ca,Na=Ua,Hp=Dp,La=Fp(Na());Mp(La,{getPolyfill:Na,implementation:Bp,shim:Hp});var qp=La,Da=Xn,Wp=Da("Date.prototype.getDay"),Gp=function(e){try{return Wp(e),!0}catch{return!1}},zp=Da("Object.prototype.toString"),Jp="[object Date]",Vp=Vn(),Kp=function(e){return typeof e!="object"||e===null?!1:Vp?Gp(e):zp(e)===Jp},Si=aa,Ei=Hf,$i=hp,Ti=mp,ki=qp,Pi=Kp,Ai=Date.prototype.getTime;function Ma(r,e,t){var n=t||{};return(n.strict?$i(r,e):r===e)?!0:!r||!e||typeof r!="object"&&typeof e!="object"?n.strict?$i(r,e):r==e:Yp(r,e,n)}function Oi(r){return r==null}function ji(r){return!(!r||typeof r!="object"||typeof r.length!="number"||typeof r.copy!="function"||typeof r.slice!="function"||r.length>0&&typeof r[0]!="number")}function Yp(r,e,t){var n,s;if(typeof r!=typeof e||Oi(r)||Oi(e)||r.prototype!==e.prototype||Ei(r)!==Ei(e))return!1;var i=Ti(r),o=Ti(e);if(i!==o)return!1;if(i||o)return r.source===e.source&&ki(r)===ki(e);if(Pi(r)&&Pi(e))return Ai.call(r)===Ai.call(e);var a=ji(r),l=ji(e);if(a!==l)return!1;if(a||l){if(r.length!==e.length)return!1;for(n=0;n<r.length;n++)if(r[n]!==e[n])return!1;return!0}if(typeof r!=typeof e)return!1;try{var u=Si(r),d=Si(e)}catch{return!1}if(u.length!==d.length)return!1;for(u.sort(),d.sort(),n=u.length-1;n>=0;n--)if(u[n]!=d[n])return!1;for(n=u.length-1;n>=0;n--)if(s=u[n],!Ma(r[s],e[s],t))return!1;return!0}var Qp=Ma;/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Ri=Object.getOwnPropertySymbols,Xp=Object.prototype.hasOwnProperty,Zp=Object.prototype.propertyIsEnumerable;function e_(r){if(r==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(r)}function t_(){try{if(!Object.assign)return!1;var r=new String("abc");if(r[5]="de",Object.getOwnPropertyNames(r)[0]==="5")return!1;for(var e={},t=0;t<10;t++)e["_"+String.fromCharCode(t)]=t;var n=Object.getOwnPropertyNames(e).map(function(i){return e[i]});if(n.join("")!=="0123456789")return!1;var s={};return"abcdefghijklmnopqrst".split("").forEach(function(i){s[i]=i}),Object.keys(Object.assign({},s)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var r_=t_()?Object.assign:function(r,e){for(var t,n=e_(r),s,i=1;i<arguments.length;i++){t=Object(arguments[i]);for(var o in t)Xp.call(t,o)&&(n[o]=t[o]);if(Ri){s=Ri(t);for(var a=0;a<s.length;a++)Zp.call(t,s[a])&&(n[s[a]]=t[s[a]])}}return n},tr={};tr.__esModule=!0;tr.TAG_NAMES={HTML:"htmlAttributes",TITLE:"title",BASE:"base",META:"meta",LINK:"link",SCRIPT:"script",NOSCRIPT:"noscript",STYLE:"style"};tr.TAG_PROPERTIES={NAME:"name",CHARSET:"charset",HTTPEQUIV:"http-equiv",REL:"rel",HREF:"href",PROPERTY:"property",SRC:"src",INNER_HTML:"innerHTML",CSS_TEXT:"cssText",ITEM_PROP:"itemprop"};tr.PREACT_TAG_MAP={charset:"charSet","http-equiv":"httpEquiv",itemprop:"itemProp",class:"className"};(function(r,e){e.__esModule=!0;var t=function(){function j(g,$){for(var S=0;S<$.length;S++){var P=$[S];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(g,P.key,P)}}return function(g,$,S){return $&&j(g.prototype,$),S&&j(g,S),g}}(),n=Object.assign||function(j){for(var g=1;g<arguments.length;g++){var $=arguments[g];for(var S in $)Object.prototype.hasOwnProperty.call($,S)&&(j[S]=$[S])}return j},s=ia,i=wh,o=f(i),a=Qp,l=f(a),u=r_,d=f(u),c=tr;function f(j){return j&&j.__esModule?j:{default:j}}function h(j,g){if(!(j instanceof g))throw new TypeError("Cannot call a class as a function")}function v(j,g){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:j}function m(j,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);j.prototype=Object.create(g&&g.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(j,g):j.__proto__=g)}function _(j,g,$){return g in j?Object.defineProperty(j,g,{value:$,enumerable:!0,configurable:!0,writable:!0}):j[g]=$,j}var b="data-preact-helmet",y=function(g){return String(g).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},w=function(g,$){for(var S=g.length-1;S>=0;S--){var P=g[S];if(P[$])return P[$]}return null},A=function(g){var $=w(g,"title"),S=w(g,"titleTemplate");if(S&&$)return S.replace(/%s/g,function(){return $});var P=w(g,"defaultTitle");return $||P||""},O=function(g){return w(g,"onChangeClientState")||function(){}},E=function(g,$){return $.filter(function(S){return typeof S[g]<"u"}).map(function(S){return S[g]}).reduce(function(S,P){return n({},S,P)},{})},H=function(g,$){return $.filter(function(S){return typeof S[c.TAG_NAMES.BASE]<"u"}).map(function(S){return S[c.TAG_NAMES.BASE]}).reverse().reduce(function(S,P){if(!S.length)for(var N=Object.keys(P),W=0;W<N.length;W++){var B=N[W],x=B.toLowerCase();if(g.indexOf(x)!==-1&&P[x])return S.concat(P)}return S},[])},T=function(g,$,S){var P={};return S.filter(function(N){return typeof N[g]<"u"}).map(function(N){return N[g]}).reverse().reduce(function(N,W){var B={};W.filter(function(te){for(var Z=void 0,Fe=Object.keys(te),Te=0;Te<Fe.length;Te++){var ye=Fe[Te],k=ye.toLowerCase();$.indexOf(k)!==-1&&!(Z===c.TAG_PROPERTIES.REL&&te[Z].toLowerCase()==="canonical")&&!(k===c.TAG_PROPERTIES.REL&&te[k].toLowerCase()==="stylesheet")&&(Z=k),$.indexOf(ye)!==-1&&(ye===c.TAG_PROPERTIES.INNER_HTML||ye===c.TAG_PROPERTIES.CSS_TEXT||ye===c.TAG_PROPERTIES.ITEM_PROP)&&(Z=ye)}if(!Z||!te[Z])return!1;var z=te[Z].toLowerCase();return P[Z]||(P[Z]={}),B[Z]||(B[Z]={}),P[Z][z]?!1:(B[Z][z]=!0,!0)}).reverse().forEach(function(te){return N.push(te)});for(var x=Object.keys(B),G=0;G<x.length;G++){var X=x[G],Se=(0,d.default)({},P[X],B[X]);P[X]=Se}return N},[]).reverse()},R=function(g,$){document.title=g||document.title,q(c.TAG_NAMES.TITLE,$)},q=function(g,$){for(var S=document.getElementsByTagName(g)[0],P=S.getAttribute(b),N=P?P.split(","):[],W=[].concat(N),B=Object.keys($),x=0;x<B.length;x++){var G=B[x],X=$[G]||"";S.setAttribute(G,X),N.indexOf(G)===-1&&N.push(G);var Se=W.indexOf(G);Se!==-1&&W.splice(Se,1)}for(var te=W.length-1;te>=0;te--)S.removeAttribute(W[te]);N.length===W.length?S.removeAttribute(b):S.setAttribute(b,N.join(","))},L=function(g,$){var S=document.head||document.querySelector("head"),P=S.querySelectorAll(g+"["+b+"]"),N=Array.prototype.slice.call(P),W=[],B=void 0;return $&&$.length&&$.forEach(function(x){var G=document.createElement(g);for(var X in x)if(x.hasOwnProperty(X))if(X==="innerHTML")G.innerHTML=x.innerHTML;else if(X==="cssText")G.styleSheet?G.styleSheet.cssText=x.cssText:G.appendChild(document.createTextNode(x.cssText));else{var Se=typeof x[X]>"u"?"":x[X];G.setAttribute(X,Se)}G.setAttribute(b,"true"),N.some(function(te,Z){return B=Z,G.isEqualNode(te)})?N.splice(B,1):W.push(G)}),N.forEach(function(x){return x.parentNode.removeChild(x)}),W.forEach(function(x){return S.appendChild(x)}),{oldTags:N,newTags:W}},Y=function(g){return Object.keys(g).reduce(function($,S){var P=typeof g[S]<"u"?S+'="'+g[S]+'"':""+S;return $?$+" "+P:P},"")},le=function(g,$,S){var P=Y(S);return P?"<"+g+" "+b+" "+P+">"+y($)+"</"+g+">":"<"+g+" "+b+">"+y($)+"</"+g+">"},ge=function(g,$){return $.reduce(function(S,P){var N=Object.keys(P).filter(function(x){return!(x==="innerHTML"||x==="cssText")}).reduce(function(x,G){var X=typeof P[G]>"u"?G:G+'="'+y(P[G])+'"';return x?x+" "+X:X},""),W=P.innerHTML||P.cssText||"",B=[c.TAG_NAMES.NOSCRIPT,c.TAG_NAMES.SCRIPT,c.TAG_NAMES.STYLE].indexOf(g)===-1;return S+"<"+g+" "+b+" "+N+(B?">":">"+W+"</"+g+">")},"")},fe=function(g,$,S){var P=_({key:$},b,!0),N=Object.keys(S).reduce(function(W,B){return W[B]=S[B],W},P);return[(0,s.h)(c.TAG_NAMES.TITLE,N,$)]},Ze=function(g,$){return $.map(function(S,P){var N=_({key:P},b,!0);return Object.keys(S).forEach(function(W){var B=W;if(B==="innerHTML"||B==="cssText"){var x=S.innerHTML||S.cssText;N.dangerouslySetInnerHTML={__html:x}}else N[B]=S[W]}),(0,s.h)(g,N)})},we=function(g,$){switch(g){case c.TAG_NAMES.TITLE:return{toComponent:function(){return fe(g,$.title,$.titleAttributes)},toString:function(){return le(g,$.title,$.titleAttributes)}};case c.TAG_NAMES.HTML:return{toComponent:function(){return $},toString:function(){return Y($)}};default:return{toComponent:function(){return Ze(g,$)},toString:function(){return ge(g,$)}}}},rr=function(g){var $=g.htmlAttributes,S=g.title,P=g.titleAttributes,N=g.baseTag,W=g.metaTags,B=g.linkTags,x=g.scriptTags,G=g.noscriptTags,X=g.styleTags;return{htmlAttributes:we(c.TAG_NAMES.HTML,$),title:we(c.TAG_NAMES.TITLE,{title:S,titleAttributes:P}),base:we(c.TAG_NAMES.BASE,N),meta:we(c.TAG_NAMES.META,W),link:we(c.TAG_NAMES.LINK,B),script:we(c.TAG_NAMES.SCRIPT,x),noscript:we(c.TAG_NAMES.NOSCRIPT,G),style:we(c.TAG_NAMES.STYLE,X)}},nr=function(g){var $,S;return S=$=function(P){m(N,P);function N(){return h(this,N),v(this,(N.__proto__||Object.getPrototypeOf(N)).apply(this,arguments))}return t(N,[{key:"shouldComponentUpdate",value:function(B){var x=n({},B);return(!x.children||!x.children.length)&&delete x.children,!(0,l.default)(this.props,x)}},{key:"render",value:function(){return(0,s.h)(g,this.props)}}],[{key:"canUseDOM",set:function(B){g.canUseDOM=B}}]),N}(s.Component),$.peek=g.peek,$.rewind=function(){var P=g.rewind();return P||(P=rr({htmlAttributes:{},title:"",titleAttributes:{},baseTag:[],metaTags:[],linkTags:[],scriptTags:[],noscriptTags:[],styleTags:[]})),P},S},ne=function(g){return{htmlAttributes:E(c.TAG_NAMES.HTML,g),title:A(g),titleAttributes:E("titleAttributes",g),baseTag:H([c.TAG_PROPERTIES.HREF],g),metaTags:T(c.TAG_NAMES.META,[c.TAG_PROPERTIES.NAME,c.TAG_PROPERTIES.CHARSET,c.TAG_PROPERTIES.HTTPEQUIV,c.TAG_PROPERTIES.PROPERTY,c.TAG_PROPERTIES.ITEM_PROP],g),linkTags:T(c.TAG_NAMES.LINK,[c.TAG_PROPERTIES.REL,c.TAG_PROPERTIES.HREF],g),scriptTags:T(c.TAG_NAMES.SCRIPT,[c.TAG_PROPERTIES.SRC,c.TAG_PROPERTIES.INNER_HTML],g),noscriptTags:T(c.TAG_NAMES.NOSCRIPT,[c.TAG_PROPERTIES.INNER_HTML],g),styleTags:T(c.TAG_NAMES.STYLE,[c.TAG_PROPERTIES.CSS_TEXT],g),onChangeClientState:O(g)}},F=function(g){var $=g.htmlAttributes,S=g.title,P=g.titleAttributes,N=g.baseTag,W=g.metaTags,B=g.linkTags,x=g.scriptTags,G=g.noscriptTags,X=g.styleTags,Se=g.onChangeClientState;q("html",$),R(S,P);var te={baseTag:L(c.TAG_NAMES.BASE,N),metaTags:L(c.TAG_NAMES.META,W),linkTags:L(c.TAG_NAMES.LINK,B),scriptTags:L(c.TAG_NAMES.SCRIPT,x),noscriptTags:L(c.TAG_NAMES.NOSCRIPT,G),styleTags:L(c.TAG_NAMES.STYLE,X)},Z={},Fe={};Object.keys(te).forEach(function(Te){var ye=te[Te],k=ye.newTags,z=ye.oldTags;k.length&&(Z[Te]=k),z.length&&(Fe[Te]=te[Te].oldTags)}),Se(g,Z,Fe)},Dr=function(){return null},Mr=(0,o.default)(ne,F,rr)(Dr);e.default=nr(Mr),r.exports=e.default})(mn,mn.exports);var n_=mn.exports;const ts=Xi(n_),s_=()=>{const{user:r}=xr(),e=Lt(n=>n.favorites),t=Lt(n=>n.fetchFavorites);return re(()=>{document.title="My Favorites - FreeStream",r&&t()},[r,t]),p("div",{class:"container",children:[p(ts,{children:p("title",{children:"My Favorites - FreeStream"})}),p("h1",{children:"My Favorites"}),e.length>0?p("div",{class:"movie-grid",children:e.map(n=>p(Yt,{item:n,mediaType:n.type}))}):p("p",{children:"You haven't added any favorites yet."})]})},i_=()=>{const{user:r}=xr(),[e,t]=C([]),[n,s]=C(!0);return re(()=>{(async()=>{if(!r){s(!1);return}s(!0);const o=await sa(),a=await Promise.all(o.map(async l=>{const u=await fetch(`/api/tmdb/${l.media_type}/${l.media_id}`);return u.ok?{...await u.json(),type:l.media_type}:null}));t(a.filter(Boolean)),s(!1)})()},[r]),n?p("div",{class:"container",children:p("p",{children:"Loading history..."})}):p("div",{class:"container",children:[p(ts,{children:p("title",{children:"Watch History - FreeStream"})}),p("h1",{children:"Watch History"}),e.length>0?p("div",{class:"movie-grid",children:e.map(i=>p(Yt,{item:i,mediaType:i.type},i.id))}):p("p",{children:"Your watch history is empty."})]})},o_=r=>{var ye;const[e,t]=C(null),[n,s]=C([]),[i,o]=C([]),[a,l]=C(""),[u,d]=C(!0),[c,f]=C(1),[h,v]=C(1),[m,_]=C(r.matches.type==="anime"?"consumet":"videasy"),[b,y]=C([]),[w,A]=C(null),[O,E]=C(!1),[H,T]=C(!1),[R,q]=C(!1),[L,Y]=C(null),[le,ge]=C(!1),[fe,Ze]=C([]),we=qt(null),[rr,nr]=C({}),{id:ne,type:F}=r.matches,{addFavorite:Dr,removeFavorite:Mr,isFavorited:j,setCurrentMediaItem:g}=Lt();re(()=>(e&&g({...e,type:F}),()=>{g(null)}),[e,F,g]),re(()=>{if(!ne||!F){pt("/");return}l(""),ge(!1),Ze([]),t(null),d(!0),q(!1),Y(null),nr({}),(async()=>{d(!0);try{const[z,ee,ke]=await Promise.all([fetch(`${Re}/tmdb/${F}/${ne}`).then(pe=>pe.json()),fetch(`${Re}/tmdb/${F}/${ne}/videos`).then(pe=>pe.json()),fetch(`${Re}/tmdb/${F}/${ne}/recommendations`).then(pe=>pe.json())]);if(t(z),s(ee.results||[]),o(ke.results||[]),(F==="tv"||F==="anime")&&z.seasons&&z.seasons.length>0){const pe=await _h(ne);if(pe&&pe.season&&pe.episode)f(pe.season),v(pe.episode);else{const Fa=z.seasons.find(Ba=>Ba.season_number>0)||z.seasons[0];f(Fa.season_number),v(1)}}if(F==="tv"||F==="anime"){const pe=await ph(ne);nr(pe)}}catch(z){console.error("Error fetching media details:",z)}finally{d(!1)}})()},[ne,F]),re(()=>{(async()=>{if(!(F!=="tv"&&F!=="anime"||!ne||!c)){E(!0);try{const z=await fetch(`${Re}/tmdb/${F}/${ne}/season/${c}`);if(z.ok){const ee=await z.json();A(ee)}else A(null)}catch(z){console.error("Error fetching season details:",z),A(null)}finally{E(!1)}}})()},[ne,F,c]),re(()=>{(async()=>{if(!ne||!F)return;q(!1),Y(null);let z=`${Re}/stream-url?type=${F}&id=${ne}&source=${m}`;(F==="tv"||F==="anime")&&(z+=`&season=${c}&episode=${h}`,F==="anime"&&(z+=`&dub=${H}`));try{const ee=await fetch(z).then(ke=>ke.json());ee.isDirectSource?(l(ee.url),Ze(ee.qualities||[]),ge(!0)):(l(ee.url),ge(!1),Ze([])),ee.currentSource&&_(ee.currentSource),ee.availableSources&&y(ee.availableSources)}catch(ee){console.error("Error fetching stream URL:",ee),l(""),ge(!1)}})()},[ne,F,c,h,m,H]);const $=()=>{if(!w||!w.episodes)return;const k=w.episodes.findIndex(z=>z.episode_number===h);if(k!==-1&&k<w.episodes.length-1){const z=w.episodes[k+1];v(z.episode_number)}else console.log("End of season");q(!1),Y(null)};if(re(()=>{if(R&&L===null&&Y(15),L>0){const k=setTimeout(()=>{Y(L-1)},1e3);return()=>clearTimeout(k)}else L===0&&$()},[R,L]),re(()=>{const k=we.current;if(!k||!le)return;const z=async()=>{const ke=await hh(ne,F,c,h);ke&&ke.progress_seconds&&(k.currentTime=ke.progress_seconds)},ee=()=>{e&&fh({...e,type:F,season:c,episode:h},k.currentTime,e.runtime),k.duration>0&&k.currentTime/k.duration>=.95&&!R&&(F==="tv"||F==="anime")&&q(!0)};return k.addEventListener("loadedmetadata",z),k.addEventListener("timeupdate",ee),()=>{k.removeEventListener("loadedmetadata",z),k.removeEventListener("timeupdate",ee)}},[a,le,ne,F,c,h,e,R]),u)return p("div",{class:"loading-spinner"});if(!e)return p("div",{class:"container",children:p("p",{children:"Could not load media details."})});const{title:S,name:P,overview:N,vote_average:W,release_date:B,first_air_date:x,runtime:G,number_of_seasons:X,genres:Se,poster_path:te}=e,Z=j(e.id),Fe=B||x?new Date(B||x).getFullYear():"",Te=()=>{Z?Mr(e.id):Dr({...e,type:F})};return p("div",{children:[p(ts,{children:p("title",{children:[S||P," - FreeStream"]})}),p("div",{class:"player-container",children:[!a&&p("div",{class:"stream-error-message",children:[p("p",{children:"Could not load the video stream."}),p("p",{children:"If this issue persists, please try selecting a different source from the list below."})]}),le?p("video",{ref:we,src:a,controls:!0,autoPlay:!0,width:"100%"}):a&&p("iframe",{src:a,allowfullscreen:!0}),R&&p("div",{class:"next-episode-prompt",children:p("div",{class:"next-episode-content",children:[p("h3",{children:"Up Next"}),p("p",{children:["Playing next episode in ",L,"s..."]}),p("div",{class:"next-episode-buttons",children:[p("button",{onClick:$,class:"btn btn-primary",children:"Play Next"}),p("button",{onClick:()=>{q(!1),Y(null)},class:"btn",children:"Cancel"})]})]})})]}),p("div",{class:"container",children:[p("div",{class:"media-details-layout",children:[p("div",{class:"poster",children:p("img",{src:te?`${Re}/image/t/p/w500${te}`:"https://via.placeholder.com/500x750.png?text=No+Image",alt:S||P})}),p("div",{class:"details",children:[p("div",{class:"title-container",children:[p("h1",{children:S||P}),p("button",{onClick:Te,class:`favorite-btn ${Z?"favorited":""}`,children:Z?" Favorited":" Add to Favorites"})]}),p("div",{class:"meta",children:[p("span",{class:"rating",children:[" ",e.vote_average?e.vote_average.toFixed(1):"N/A"]}),p("span",{children:Fe}),G&&p("span",{children:[G," min"]}),X&&p("span",{children:[X," Seasons"]})]}),p("div",{class:"genres",children:Se&&Se.map(k=>p("span",{class:"genre-tag",children:k.name}))}),p("p",{class:"overview",children:N}),fe.length>0&&p("div",{class:"quality-selector",children:[p("label",{children:"Quality:"}),fe.map(k=>p("button",{class:`quality-btn ${a===k.url?"active":""}`,onClick:()=>l(k.url),children:[k.quality,"p"]}))]})]})]}),F==="anime"&&p("div",{class:"select-container",children:[p("label",{for:"dub-select",children:"Audio:"}),p("select",{id:"dub-select",value:H,onChange:k=>T(k.target.value==="true"),children:[p("option",{value:"false",children:"Subbed"}),p("option",{value:"true",children:"Dubbed"})]})]}),p("div",{class:"selectors-container",children:[(F==="tv"||F==="anime")&&e&&e.seasons&&p("div",{class:"select-container",children:[p("label",{children:"Season:"}),p("div",{class:"selector-buttons",children:e.seasons.filter(k=>k.season_number>0).map(k=>p("button",{class:`selector-btn ${c===k.season_number?"active":""}`,onClick:()=>{f(k.season_number),v(1)},children:k.name},k.id))})]}),b.length>1&&p("div",{class:"select-container",children:[p("label",{children:"Source:"}),p("div",{class:"selector-buttons",children:b.map(k=>p("button",{class:`selector-btn ${m===k?"active":""}`,onClick:()=>_(k),children:k},k))})]})]}),(F==="tv"||F==="anime")&&p("div",{class:"episodes-container",children:[p("h3",{children:"Episodes"}),O?p("div",{class:"loading-spinner"}):p("div",{class:"episode-list",children:(ye=w==null?void 0:w.episodes)==null?void 0:ye.map(k=>{const z=`${ne}-${F}-${c}-${k.episode_number}`,ee=rr[z],ke=ee?ee.progress_seconds/ee.duration_seconds*100:0;return p("div",{class:`episode-card ${k.episode_number===h?"active":""}`,onClick:()=>v(k.episode_number),children:[p("div",{class:"episode-card-image",children:[p("img",{src:k.still_path?`${Re}/image/t/p/w300${k.still_path}`:`https://via.placeholder.com/300x169.png?text=${encodeURIComponent(k.name)}`,alt:k.name}),p("div",{class:"episode-number-badge",children:k.episode_number}),ke>0&&p("div",{class:"episode-progress-bar",children:p("div",{class:"episode-progress",style:{width:`${ke}%`}})})]}),p("div",{class:"episode-card-content",children:[p("h4",{children:k.name}),p("p",{class:"episode-overview",children:k.overview})]})]},k.id)})})]}),i.length>0&&p("div",{class:"recommendations",children:[p("h2",{children:"More Like This"}),p("div",{class:"movie-grid",children:i.map(k=>p(Yt,{item:k,mediaType:F}))})]})]})]})},a_=r=>{const[e,t]=C([]),[n,s]=C(!1),[i,o]=C("");re(()=>{var d;const u=new URLSearchParams(((d=r.url)==null?void 0:d.split("?")[1])||"").get("q");o(u||""),u?a(u):t([])},[r.url]);const a=async l=>{s(!0);try{const d=await(await fetch(`${Re}/tmdb/search/multi?query=${encodeURIComponent(l)}`)).json();if(d&&d.results){const c=d.results.filter(f=>(f.media_type==="movie"||f.media_type==="tv")&&f.poster_path);t(c)}}catch(u){console.error("Error performing search:",u),t([])}finally{s(!1)}};return p("div",{class:"container",children:[p("div",{class:"page-header",children:p("h1",{children:['Search Results for "',i,'"']})}),n?p("div",{class:"loading-spinner"}):e.length>0?p("div",{class:"movie-grid",children:e.map(l=>p(Yt,{item:l,mediaType:l.media_type}))}):p("p",{children:['No results found for "',i,'". Please try another search.']})]})};function l_(){const[r,e]=C(!1),[t,n]=C(""),[s,i]=C("");return p("div",{className:"auth-container",children:p("div",{className:"auth-form",children:[p("h1",{className:"header",children:"Login"}),p("p",{className:"description",children:"Sign in to your account."}),p("form",{onSubmit:async a=>{a.preventDefault();try{e(!0);const{error:l}=await oe.auth.signInWithPassword({email:t,password:s});if(l)throw l;Sr.success("Logged in successfully!"),pt("/",!0)}catch(l){Sr.error(l.error_description||l.message)}finally{e(!1)}},children:[p("div",{className:"input-group",children:[p("label",{htmlFor:"email",children:"Email"}),p("input",{id:"email",className:"input-field",type:"email",placeholder:"Your email",value:t,onChange:a=>n(a.target.value)})]}),p("div",{className:"input-group",children:[p("label",{htmlFor:"password",children:"Password"}),p("input",{id:"password",className:"input-field",type:"password",placeholder:"Your password",value:s,onChange:a=>i(a.target.value)})]}),p("div",{children:p("button",{className:"button",disabled:r,children:r?p("span",{children:"Loading..."}):p("span",{children:"Login"})})})]})]})})}function c_(){const[r,e]=C(!1),[t,n]=C(""),[s,i]=C("");return p("div",{className:"auth-container",children:p("div",{className:"auth-form",children:[p("h1",{className:"header",children:"Create an account"}),p("p",{className:"description",children:"Sign up for a new account."}),p("form",{onSubmit:async a=>{a.preventDefault();try{e(!0);const{error:l}=await oe.auth.signUp({email:t,password:s});if(l)throw l;Sr.success("Check your email for the confirmation link!")}catch(l){Sr.error(l.error_description||l.message)}finally{e(!1)}},children:[p("div",{className:"input-group",children:[p("label",{htmlFor:"email",children:"Email"}),p("input",{id:"email",className:"input-field",type:"email",placeholder:"Your email",value:t,onChange:a=>n(a.target.value)})]}),p("div",{className:"input-group",children:[p("label",{htmlFor:"password",children:"Password"}),p("input",{id:"password",className:"input-field",type:"password",placeholder:"Your password",value:s,onChange:a=>i(a.target.value)})]}),p("div",{children:p("button",{className:"button",disabled:r,children:r?p("span",{children:"Loading..."}):p("span",{children:"Sign Up"})})})]})]})})}const xi=({component:r,...e})=>{const{user:t}=xr();return t?p(r,{...e}):(pt("/login",!0),null)},u_=()=>p(Tu,{children:p("div",{class:"app",children:[p(jd,{position:"top-center",reverseOrder:!1,gutter:8,containerClassName:"",containerStyle:{},toastOptions:{className:"",duration:5e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,theme:{primary:"green",secondary:"black"}}}}),p(Rd,{}),p("main",{children:p(Qi,{history:cl(),children:[p(vh,{path:"/"}),p(xi,{component:s_,path:"/favorites"}),p(xi,{component:i_,path:"/history"}),p(o_,{path:"/watch"}),p(a_,{path:"/search"}),p(l_,{path:"/login"}),p(c_,{path:"/signup"})]})}),p("footer",{children:p("p",{children:" 2024 FreeStream. All Rights Reserved."})})]})});Ke(p(u_,{}),document.getElementById("app"));
